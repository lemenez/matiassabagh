(()=>{"use strict";var e,t={5569:(e,t,n)=>{n(7941),n(2526),n(7327),n(1539),n(5003),n(9554),n(4747),n(9337),n(3321),n(9070);var r=n(9713),i=n.n(r),a=n(7294),o=n.n(a),s=n(3935),c=n.n(s),l=n(6458),u=n(3419),d=n(6083),p=(n(2419),n(4575)),_=n.n(p),f=n(3913),h=n.n(f),v=n(1506),y=n.n(v),g=n(2205),m=n.n(g),E=n(8585),b=n.n(E),S=n(9754),R=n.n(S),k=(n(2222),n(3012)),P=999999,T="@media (max-width: ".concat(999998,"px)"),A="@media (min-width: ".concat(P,"px)"),C=.6,w="drop-shadow(0 0 2px rgba(0, 0, 0, 0.4))",I="spotify-circular, spotify-circular-cyrillic, spotify-circular-arabic, spotify-circular-hebrew, sans-serif",L="600",O=(n(2772),n(5827),n(1249),n(9600),n(7042),n(4916),n(3123),"embed_v2"),D=n(9518),N=n.n(D);n(9714),n(6992),n(8783),n(3948),n(285),n(1637),n(4765);function M(e,t){try{var n=document.getElementById(e);return n?JSON.parse(n.innerHTML):t}catch(r){return t}}var U=function(e,t,n){return n&&e.searchParams.set("t",n.toString()),t&&(e.searchParams.has("utm_source")||e.searchParams.set("utm_source",t)),e.searchParams.has("utm_medium")||e.searchParams.set("utm_medium",function(){var e;if(void 0!==window.orientation)switch(window.orientation){case 0:case 180:e=window.screen.width;break;default:e=window.screen.height}else{var t=window.screen.orientation&&window.screen.orientation.type||window.screen.msOrientation||"";if(0===t.indexOf("portrait"))e=window.screen.width;else{if(0!==t.indexOf("landscape"))return!1;e=window.screen.height}}return e<=432}()?"mobile":"desktop"),e};function x(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new URL("undefined"!=typeof location&&location.href?location.href:"https://open.spotify.com"),r=null;e?(r=new URL(e.toOpenURL()),t&&n.searchParams.forEach((function(e,t){r.searchParams.set(t,e)}))):(r=n,t||(r.search="")),r.searchParams.delete("nd"),r.searchParams.delete("fallback"),r.searchParams.set("go","1");var i=M("config",{});return"string"==typeof(null==i?void 0:i.correlationId)&&r.searchParams.append("sp_cid",i.correlationId),r}var F=function(e,t){return e.entities[t]},j=function(e){return"https://open.spotify.com/".concat(e.split(":").slice(1).join("/"))},B=function(e){var t=F(e,e.resource).uri,n=N().from(t);return U(x(n,!1),"embed_player_m",void 0)},Y=function(e){var t,n=F(e,e.resource).uri,r=N().from(n);return U(((t=x(r,!1)).searchParams.set("fallback","getapp"),t),"embed_player_m",void 0)},V=n(573);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){return F(e,e.resource)},q=function(e){return G(e).type},W=(0,V.P1)([function(e){return G(e)},function(e){return e}],(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(e.type){case"album":var t=H({},e);return delete t.tracks,e.tracks.items.map((function(e){return H(H({},e),{},{album:t})}));case"artist":return e.tracks.map((function(e){return e}));case"playlist":var n=e.tracks.items.filter((function(e){return!!e.track}));return n.map((function(e,t){return H(H({},e.track),{},{track_number:t+1})}));case"track":case"episode":return[H({preview_url:e.audio_preview_url,is_playable:!!e.audio_preview_url},e)];case"show":return e.episodes.items.map((function(e){return H(H({},e),{},{preview_url:e.audio_preview_url,is_playable:!!e.audio_preview_url})}));default:return[]}})),z=function(e){var t=G(e)||{};switch(t.type){case"album":case"artist":case"playlist":case"show":return t.images[0]&&t.images[0].url;case"track":return t.album.images[0].url;case"episode":return t.show.images[0].url;default:return}};var Q,$=function(e){return e.viewport.width<P},X=function(e){return function(e){return-1===["track","episode"].indexOf(G(e).type)}(e)?e.viewport.height>150:e.viewport.height>230},Z=function(e){return"".concat($(e)?"legacy":"modern","-").concat(X(e)?"extended":"basic")},J=function(e){return"legacy-extended"===Z(e)&&-1!==["track","episode"].indexOf(G(e).type)},ee=n(7154),te=n.n(ee);n(561),n(9601);!function(e){e.CAPPING_USER_IS_CAPPED="CAPPING_USER_IS_CAPPED",e.EME_API_NOT_SUPPORTED="EME_API_NOT_SUPPORTED",e.EME_MEDIA_KEYS_NOT_SUPPORTED="EME_MEDIA_KEYS_NOT_SUPPORTED",e.EME_MEDIA_KEY_SESSION_NOT_SUPPORTED="EME_MEDIA_KEY_SESSION_NOT_SUPPORTED",e.EME_NO_SUPPORTED_KEYSYSTEM="EME_NO_SUPPORTED_KEYSYSTEM",e.EME_PLAYER_MEDIA_KEYS_SETTING_FAILED="EME_PLAYER_MEDIA_KEYS_SETTING_FAILED",e.EME_ERROR_UNKNOWN="EME_ERROR_UNKNOWN",e.EME_LICENSE_REQUEST_EMPTY_RESPONSE="EME_LICENSE_REQUEST_EMPTY_RESPONSE",e.EME_LICENSE_REQUEST_FAILED_WITH_STATUS="EME_LICENSE_REQUEST_FAILED_WITH_STATUS",e.EME_LICENSE_REQUEST_WIDEVINE_ERROR="EME_LICENSE_REQUEST_WIDEVINE_ERROR",e.EME_LICENSE_UPDATE_FAILED="EME_LICENSE_UPDATE_FAILED",e.EME_HEADER_KEY_VALUE_MISMATCH="EME_HEADER_KEY_VALUE_MISMATCH",e.EME_HEADER_MISSING_CHALLENGE="EME_HEADER_MISSING_CHALLENGE",e.EME_INIT_DATA_MALFORMED="EME_INIT_DATA_MALFORMED",e.EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM="EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM",e.EME_MEDIA_KEY_SESSION_V0_1B_ERROR="EME_MEDIA_KEY_SESSION_V0_1B_ERROR",e.EME_MEDIA_KEY_SESSION_SAFARI_ERROR="EME_MEDIA_KEY_SESSION_SAFARI_ERROR",e.EME_NO_SUPPORTED_CONFIGURATION="EME_NO_SUPPORTED_CONFIGURATION",e.EME_NOT_SUPPORTED_ERROR="EME_NOT_SUPPORTED_ERROR",e.EME_INVALID_STATE_ERROR="EME_INVALID_STATE_ERROR",e.EME_UNKNOWN_ERROR="EME_UNKNOWN_ERROR",e.DISALLOW_PROTECTED_TRACK_ERROR="DISALLOW_PROTECTED_TRACK_ERROR",e.FILE_FORMAT_NOT_SUPPORTED="FILE_FORMAT_NOT_SUPPORTED",e.FILE_MALFORMED_SEEKTABLE="FILE_MALFORMED_SEEKTABLE",e.FILE_MALFORMED_PSSH="FILE_MALFORMED_PSSH",e.FILE_NOT_RESOLVED="FILE_NOT_RESOLVED",e.FRAGMENT_ONLINE_REQUEST_FAILED_WITH_ZERO="FRAGMENT_ONLINE_REQUEST_FAILED_WITH_ZERO",e.FRAGMENT_OFFLINE_REQUEST_FAILED_WITH_ZERO="FRAGMENT_OFFLINE_REQUEST_FAILED_WITH_ZERO",e.FRAGMENT_REQUEST_FAILED_WITH_ZERO="FRAGMENT_REQUEST_FAILED_WITH_ZERO",e.FRAGMENT_REQUEST_FAILED_WITH_STATUS="FRAGMENT_REQUEST_FAILED_WITH_STATUS",e.FRAGMENT_REQUEST_EMPTY_RESPONSE="FRAGMENT_REQUEST_EMPTY_RESPONSE",e.FRAGMENT_REQUEST_UNEXPECTED_LENGTH="FRAGMENT_REQUEST_UNEXPECTED_LENGTH",e.PLAYER_ATTEMPTED_VOLUME_OUT_OF_RANGE="PLAYER_ATTEMPTED_VOLUME_OUT_OF_RANGE",e.PLAYER_BUFFER_QUOTA_EXCEEDED="PLAYER_BUFFER_QUOTA_EXCEEDED",e.PLAYER_CANNOT_FIND_PLAYABLE_URI="PLAYER_CANNOT_FIND_PLAYABLE_URI",e.PLAYER_INVALID_INTERNAL_STATE="PLAYER_INVALID_INTERNAL_STATE",e.PLAYER_MEDIA_ERROR="PLAYER_MEDIA_ERROR",e.PLAYER_PLAYBACK_ERROR="PLAYER_PLAYBACK_ERROR",e.MEDIA_ABORTED="MEDIA_ABORTED",e.MEDIA_DECODING_ERROR="MEDIA_DECODING_ERROR",e.MEDIA_NETWORK_ERROR="MEDIA_NETWORK_ERROR",e.MEDIA_NOT_SUPPORTED="MEDIA_NOT_SUPPORTED",e.LICENSE_RESOLVE_INVALID_RESPONSE="LICENSE_RESOLVE_INVALID_RESPONSE",e.LICENSE_RESOLVER_CANT_RESOLVE_URL="LICENSE_RESOLVER_CANT_RESOLVE_URL",e.LICENSE_RESOLVER_DEPRECATED_VERSION="LICENSE_RESOLVER_DEPRECATED_VERSION",e.LIST_PLAYER_NO_TRACK_PLAYER="LIST_PLAYER_NO_TRACK_PLAYER",e.LIST_PLAYER_NO_LIST="LIST_PLAYER_NO_LIST",e.LIST_PLAYER_INVALID_ARGUMENT="LIST_PLAYER_INVALID_ARGUMENT",e.LIST_PLAYER_FORBIDDEN="LIST_PLAYER_FORBIDDEN",e.STORAGE_ERROR="STORAGE_ERROR",e.STORAGE_FAILED_WITH_STATUS="STORAGE_FAILED_WITH_STATUS",e.STORAGE_RETURNED_NO_TRACKS="STORAGE_RETURNED_NO_TRACKS",e.STORAGE_TRACK_MANIFEST_FAILED="STORAGE_TRACK_MANIFEST_FAILED",e.STORAGE_TRACK_MANIFEST_EMPTY="STORAGE_TRACK_MANIFEST_EMPTY",e.STORAGE_VIDEO_MANIFEST_FAILED="STORAGE_VIDEO_MANIFEST_FAILED",e.TRACK_DATA_ALREADY_FINALIZED="TRACK_DATA_ALREADY_FINALIZED",e.TSV_SENDING_FAILED="TSV_SENDING_FAILED",e.PLAYBACK_STATS_SENDING_FAILED="PLAYBACK_STATS_SENDING_FAILED",e.PLAYBACK_START_SENDING_FAILED="PLAYBACK_START_SENDING_FAILED",e.UNKNOWN="UNKNOWN"}(Q||(Q={}));var ne,re=n(4638);!function(e){e.USER_INFO_REQUEST_EMPTY_RESPONSE="USER_INFO_REQUEST_EMPTY_RESPONSE",e.USER_INFO_REQUEST_FAILED_WITH_STATUS="USER_INFO_REQUEST_FAILED_WITH_STATUS",e.HARMONY_NO_TRACKS_LOADED="HARMONY_NO_TRACKS_LOADED",e.HARMONY_OPERATION_FORBIDDEN="HARMONY_OPERATION_FORBIDDEN",e.HARMONY_LOCAL_PLAYER_DISABLED="HARMONY_LOCAL_PLAYER_DISABLED",e.HARMONY_INVALID_DESCRIPTOR_ID="HARMONY_INVALID_DESCRIPTOR_ID",e.CONNECTAPI_CLIENT_INVALID_ARGUMENTS="CONNECTAPI_CLIENT_INVALID_ARGUMENTS",e.CONNECTAPI_CLIENT_MISSING_DEVICE_ID="CONNECTAPI_CLIENT_MISSING_DEVICE_ID",e.CONNECTAPI_CLIENT_NO_CONNECTION_ID="CONNECT_API_CLIENT_NO_CONNECTION_ID",e.CONNECTAPI_CLIENT_NO_DEVICE="CONNECTAPI_CLIENT_NO_DEVICE",e.CONNECTAPI_CLIENT_NO_SESSION_ID="CONNECTAPI_CLIENT_NO_SESSION_ID",e.CONNECTAPI_CLIENT_NO_STATE="CONNECTAPI_CLIENT_NO_STATE",e.CONNECTAPI_CLIENT_INVALID_POSITION="CONNECT_API_CLIENT_INVALID_POSITION",e.CONNECTAPI_CLIENT_INVALID_VOLUME="CONNECT_API_CLIENT_INVALID_VOLUME",e.CONNECTAPI_MAX_SUBSCRIPTIONS_REACHED="CONNECTAPI_MAX_SUBSCRIPTIONS_REACHED",e.CONNECTAPI_REGISTRATION_FAILED_WITH_STATUS="CONNECTAPI_REGISTRATION_FAILED_WITH_STATUS",e.CP_NO_DEVICE_DESCRIPTOR="CP_NO_DEVICE_DESCRIPTOR",e.CP_NO_CONNECTION_ID="CP_NO_CONNECTION_ID",e.CP_REGISTRATION_FAILED_WITH_STATUS="CP_REGISTRATION_FAILED_WITH_STATUS",e.CP_REQUEST_FAILED_WITH_STATUS="CP_REQUEST_FAILED_WITH_STATUS",e.CP_NO_DEVICE_ID="CP_NO_DEVICE_ID",e.CP_NO_COMMAND_ID="CP_NO_COMMAND_ID",e.CP_NO_RESPONSE_BODY="CP_NO_RESPONSE_BODY",e.CP_NO_TRACKING_DATA="CP_NO_TRACKING_DATA",e.CP_INVALID_STATE="CP_INVALID_STATE",e.QUEUE_MANAGER_NO_STATE="QUEUE_MANAGER_NO_STATE",e.QUEUE_OPERATION_STALE_REVISION="QUEUE_OPERATION_STALE_REVISION",e.TP_NO_RESPONSE_BODY="TP_NO_RESPONSE_BODY",e.TP_REGISTRATION_FAILED_NON_PREMIUM="TP_REGISTRATION_FAILED_NON_PREMIUM",e.TP_REGISTRATION_FAILED_WITH_STATUS="TP_REGISTRATION_FAILED_WITH_STATUS",e.TP_MAX_SUBSCRIPTIONS_REACHED="TP_MAX_SUBSCRIPTIONS_REACHED",e.TP_UPDATE_REQUEST_EMPTY_RESPONSE="TP_UPDATE_REQUEST_EMPTY_RESPONSE",e.TP_PARSE_STATE_UPDATE_FAILED_WITH_STATUS="TP_PARSE_STATE_UPDATE_FAILED_WITH_STATUS",e.TP_UNKNOWN_COMMAND="TP_UNKNOWN_COMMAND",e.TP_CANNOT_CREATE_STATE_REF="TP_CANNOT_CREATE_STATE_REF",e.TP_MISSING_INITIAL_STATE="TP_MISSING_INITIAL_STATE",e.TP_INVALID_STATE_REFERENCE="TP_INVALID_STATE_REFERENCE",e.TP_CONFLICT_REQUEST_FAILED_WITH_STATUS="TP_CONFLICT_REQUEST_FAILED_WITH_STATUS"}(ne||(ne={}));n(8674),n(7105);var ie=n(8578);var ae,oe=n(3038),se=n.n(oe),ce=(n(8309),n(3178));!function(e){e.APPLOAD="appload",e.BACK_BUTTON="backbtn",e.CLICK_ROW="clickrow",e.CLICK_SIDE="clickside",e.END_PLAY="endplay",e.FORWARD_BUTTON="fwdbtn",e.LOGOUT="logout",e.PLAY_BUTTON="playbtn",e.POPUP="popup",e.REMOTE="remote",e.TRACK_DONE="trackdone",e.TRACK_ERROR="trackerror",e.UNKNOWN="unknown",e.URI_OPEN="uriopen",e.CAPPED="capped",e.SEEK="seek"}(ae||(ae={}));var le,ue,de,pe=n(5406),_e="@local",fe=65535;!function(e){e.AUTHENTICATED="authenticated",e.AUTHENTICATION_ERROR="authentication_error",e.AUTOPLAY_FAILED="autoplay_failed",e.BEFORE_DISCONNECT="before_disconnect",e.BEFORE_VOLUME_CHANGE="before_volume_change",e.BUFFER_STALLED="stalled",e.BUFFERING_END="buffering_end",e.BUFFERING_START="buffering_start",e.CONNECTED="connected",e.CONNECTION_ERROR="connection_error",e.DEVICES_CHANGED="devices_changed",e.DEVICE_DEACTIVATED="device_deactivated",e.DEVICE_DESCRIPTOR_CHANGED="descriptor_changed",e.DISCONNECTED="disconnected",e.DURATION_CHANGED="duration_changed",e.ERROR="error",e.LAST_ACTIVE_DEVICE_INFO_CHANGED="last_active_device_info_changed",e.LOCAL_CONTEXT_ENDED="local_context_ended",e.LOCAL_PLAYER_DISABLED="local_player_disabled",e.LOCAL_PLAYER_ENABLED="local_player_enabled",e.LOCAL_PLAYER_LOGGED_OUT="local_player_logged_out",e.LOGGED_OUT="logged_out",e.MAX_LIST_ERRORS_REACHED="max_list_errors_reached",e.MAX_SUBSCRIPTIONS_REACHED="max_subscriptions_reached",e.PLAYBACK_CAPPED="playback_capped",e.PLAYER_INITIALIZATION_DONE="player_initialization_done",e.PLAYER_INITIALIZATION_FAILED="player_initialization_failed",e.PRODUCT_STATE_CHANGED="product_state_changed",e.PROGRESS="progress",e.PLAYER_QUEUE_CHANGED="player_queue_changed",e.RECONNECTED="reconnected",e.RECONNECTING="reconnecting",e.REMOTE_OBSERVER_DISABLED="remote_observer_disabled",e.REMOTE_OBSERVER_ENABLED="remote_observer_enabled",e.SERVICE_REGISTRATION_ERROR="service_registration_error",e.STATE_CHANGED="state_changed",e.STOPPED_ON_BACKGROUND="stopped_on_background",e.TRACK_ENDED="track_ended",e.UNRECOVERABLE_FAILURE="unrecoverable_failure",e.VIDEO_ELEMENT_APPENDED="video_element_appended",e.VIDEO_ELEMENT_REMOVED="video_element_removed",e.VOLUME_CHANGED="volume_changed",e.DISPLAYED_CUES_CHANGED="displayed_cues_changed",e.SUBTITLE_LANGUAGES_LOADED="subtitle_languages_loaded",e.SPEED_CHANGED="speed_changed"}(le||(le={})),function(e){e.CLOUD_PLAYBACK="cloud-playback",e.CONNECT_API="connect-api",e.HARMONY="harmony",e.PLAYBACK="playback",e.TRACK_PLAYBACK="track-playback",e.TRANSPORT="transport"}(ue||(ue={})),function(e){e[e.OFF=0]="OFF",e[e.CONTEXT=1]="CONTEXT",e[e.TRACK=2]="TRACK"}(de||(de={}));var he=n(5957),ve=n.n(he);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var ge=function(e){m()(n,e);var t=ye(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).status=-1,i.unrecoverable=!1,i.debug={},i.code=e,i.name="HarmonyError",i}return h()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(ve()(Error));function me(e,t){return!e&&!t||!(!e||!t)&&(e.id===t.id&&e.is_active===t.is_active&&e.is_controllable===t.is_controllable&&e.is_observable===t.is_observable&&e.local===t.local&&e.name===t.name&&e.type===t.type&&e.version===t.version&&e.volume===t.volume)}n(1817),n(2165);var Ee=n(319),be=n.n(Ee);n(1038);function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Re=function(e){m()(n,e);var t=Se(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).unrecoverable=!1,i.code=e,i.name="PlayerQueueError",i}return h()(n)}(ve()(Error));function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function Pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ae=":::";function Ce(e){var t,n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ignoreMetaForTrack:!1},o=[],s=[],c=!1,l=!1;if(!(null==e?void 0:e.length))return{items:o,tracks:s,hasQueuedTracks:c};var u,d=Pe(e);try{for(d.s();!(u=d.n()).done;){var p=u.value,_="spotify:delimiter"===p.uri||/^spotify:meta:/.test(p.uri)?"meta":"track",f="".concat(p.uid).concat(Ae).concat(null===(t=p.metadata)||void 0===t?void 0:t.iteration),h={type:_,uri:p.uri,uid:p.uid,qid:f,metadata:p.metadata||{},hidden:"true"===(null===(n=p.metadata)||void 0===n?void 0:n.hidden),queued:"true"===(null===(r=p.metadata)||void 0===r?void 0:r.is_queued),provider:p.provider,removed_reasons:p.removed,$blck_rs:p.blocked};h.queued&&(c=!0),o.push(h),"meta"===h.type?l=!0:!a.ignoreMetaForTrack&&l||"track"!==h.type||h.hidden||(null===(i=h.removed_reasons)||void 0===i?void 0:i.length)||s.push(h)}}catch(v){d.e(v)}finally{d.f()}return{items:o,tracks:s,hasQueuedTracks:c}}function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Array.isArray(e))throw new TypeError("Items is not an array.");if(!e.length)return[];var n,r=[],i=Pe(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a){"string"==typeof a&&(a={type:"track",uri:a});var o={uri:a.uri,uid:a.uid,metadata:a.metadata||{},removed:a.removed_reasons,blocked:a.$blck_rs,provider:a.provider};(a.queued||t.queued)&&(o.metadata.is_queued="true",o.provider="queue"),(a.hidden||"meta"===a.type)&&(o.metadata.hidden="true"),r.push(o)}}}catch(s){i.e(s)}finally{i.f()}return r}function Ie(e){var t=e.split(Ae),n=se()(t,2),r=n[0],i=n[1],a={type:"track",uid:r};return i&&(a.metadata={iteration:i}),a}var Le=function(e){m()(n,e);var t=ke(n);function n(e){var r;return _()(this,n),(r=t.call(this))._hasInitialState=!1,r._reportInactiveQueues=!1,r._onlyLocalQueue=!1,r._currentPlayerState=null,r._currentInternalQueue=null,r._currentQueue=null,r._hasQueuedTracks=!1,r._connectClient=e.connectClient,r._runner=e.runner||function(e){return e()},r._parsePlayerState=r._parsePlayerState.bind(y()(r)),r._onlyLocalQueue=!!e.onlyLocalQueue,r._reportInactiveQueues=!!e.reportInactiveQueues,r._connectClient.on("player_state_changed",r._onPlayerStateChanged.bind(y()(r))),e.initialContextPlayerState&&r._parsePlayerState(e.initialContextPlayerState),r}return h()(n,[{key:"_onPlayerStateChanged",value:function(e){var t=e.data,n=t.playerState,r=t.orphaned,i=t.isLocal;this._parsePlayerState(n,r,i)}},{key:"_parsePlayerState",value:function(e,t,n){var r,i,a;if(this._hasInitialState=!0,this._onlyLocalQueue&&!n||!this._reportInactiveQueues&&t)this._currentPlayerState=null,this._currentInternalQueue=null,this._currentQueue=null;else if(this._currentPlayerState=null!=e?e:null,e){if(e.queue_revision===(null===(r=this._currentInternalQueue)||void 0===r?void 0:r.revision))return null;this._hasQueuedTracks=!1;var o={ignoreMetaForTrack:null===(i=e.options)||void 0===i?void 0:i.repeating_context},s=e.queue_revision,c=Ce([e.track]).items[0],l=Ce(e.next_tracks,o),u=Ce(e.prev_tracks,o);this._hasQueuedTracks=l.hasQueuedTracks;var d={uri:e.context_uri,metadata:null!==(a=e.context_metadata)&&void 0!==a?a:void 0};this._currentInternalQueue={revision:s,context:d,current_track:c,next_items:l.items,previous_items:u.items},this._currentQueue={revision:s,context:d,current_track:c,next_tracks:l.tracks,previous_tracks:u.tracks}}else this._hasQueuedTracks=!1,this._currentInternalQueue=null,this._currentQueue=null;return this.emit(le.PLAYER_QUEUE_CHANGED,{internalPlayerQueue:this._currentInternalQueue,playerQueue:this._currentQueue}),this._currentInternalQueue}},{key:"_setQueueNext",value:function(e,t){var n=this,r=this._currentPlayerState;if(!r)return Promise.reject(new Re(ne.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));var i={next_tracks:e,prev_tracks:r.prev_tracks,queue_revision:r.queue_revision};return this._runner((function(){return n._connectClient.setQueue(i,t)}),t)}},{key:"_appendQueued",value:function(e,t){var n,r,i=this._currentPlayerState;if(!i)return Promise.reject(new Re(ne.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));var a=Array.from(null!==(n=i.next_tracks)&&void 0!==n?n:[]);if(this._hasQueuedTracks){for(var o=!1,s=0,c=a.length;s<c;s++){var l=a[s];if("true"!==(null===(r=null==l?void 0:l.metadata)||void 0===r?void 0:r.is_queued)){a.splice.apply(a,[s,0].concat(be()(e))),o=!0;break}}o||a.push.apply(a,be()(e))}else a.unshift.apply(a,be()(e));return this._setQueueNext(a,t)}},{key:"getInternalPlayerQueue",value:function(){var e=this;return this._hasInitialState?Promise.resolve(this._currentInternalQueue):new Promise((function(t){e.on(le.PLAYER_QUEUE_CHANGED,(function(e){t(e.data.internalPlayerQueue)}))}))}},{key:"getPlayerQueue",value:function(){var e=this;return this._hasInitialState?Promise.resolve(this._currentQueue):new Promise((function(t){e.on(le.PLAYER_QUEUE_CHANGED,(function(e){t(e.data.playerQueue)}))}))}},{key:"setInternalPlayerQueue",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{ignoreRevision:!1};if(!this._currentPlayerState)return Promise.reject(new Re(ne.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));if(e.revision!==this._currentPlayerState.queue_revision&&!r.ignoreRevision)return Promise.reject(new Re(ne.QUEUE_OPERATION_STALE_REVISION,"Cannot perform operation; revision is stale."));var i={next_tracks:we(e.next_items),prev_tracks:we(e.previous_items),queue_revision:r.ignoreRevision?void 0:this._currentPlayerState.queue_revision};return this._runner((function(){return n._connectClient.setQueue(i,t)}),t)}},{key:"addToQueue",value:function(e,t){var n=this;if(!Array.isArray(e))return Promise.reject(new TypeError("Argument `items` must be an array."));var r=we(e,{queued:!0});return r.length?1===r.length?this._runner((function(){return n._connectClient.addToQueue(r[0],t)}),t):this._appendQueued(r,t):Promise.resolve(!1)}},{key:"removeNext",value:function(e,t){var n,r,i,a,o=this._currentPlayerState;if(!o)return Promise.reject(new Re(ne.QUEUE_MANAGER_NO_STATE,"Cannot perform operation; no current state."));a="string"==typeof e?Ie(e):e;for(var s=Array.from(null!==(n=o.next_tracks)&&void 0!==n?n:[]),c=s.length,l=0;l<c;l++){var u=s[l];if((null==u?void 0:u.uid)===a.uid&&(null===(r=null==u?void 0:u.metadata)||void 0===r?void 0:r.iteration)===(null===(i=a.metadata)||void 0===i?void 0:i.iteration)){s.splice(l,1);break}}return s.length===c?Promise.resolve(!1):this._setQueueNext(s,t)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp);function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var De,Ne,Me=15e3,Ue=function(e){m()(n,e);var t=Oe(n);function n(e){var r;return _()(this,n),(r=t.call(this))._hasFakeState=!1,r._localPlayerEnabled=!1,r._localPlayback=!1,r._lastDeviceList=[],r._deferredStreamer=(0,pe.$)(),r._client=e.client,r._streamer=e.streamer,r._controller=e.controller,r._hidden=!!e.hidden,r._onlyLocalState=!!e.onlyLocalState,r._preferController=!r._onlyLocalState&&!!e.preferControllerState,r._claimInactivePlayerStates=!!e.claimInactivePlayerStates,r._enableControllerWithoutStreamer=!!e.enableControllerWithoutStreamer,r._autoActivateElement=!!e.autoActivateElement,r._deactivateOnStop=!!e.experimentalDeactivateOnStop,r._init(),r}return h()(n,[{key:"_init",value:function(){var e,t=this;this._createStreamerDeferred();var n=this._client;n.on("error",this._onError.bind(this)),this.proxyEmit(n,"authenticated",le.AUTHENTICATED),this.proxyEmit(n,"authentication_error",le.AUTHENTICATION_ERROR),this.proxyEmit(n,"before_disconnect",le.BEFORE_DISCONNECT),this.proxyEmit(n,"connected",le.CONNECTED),this.proxyEmit(n,"connection_error",le.CONNECTION_ERROR),this.proxyEmit(n,"descriptor_changed",le.DEVICE_DESCRIPTOR_CHANGED),this.proxyEmit(n,"product_state_changed",le.PRODUCT_STATE_CHANGED),this.proxyEmit(n,"reconnected",le.RECONNECTED),this.proxyEmit(n,"reconnecting",le.RECONNECTING),this.proxyEmit(n,"unrecoverable_failure",le.UNRECOVERABLE_FAILURE),this.proxyEmit(n,"logged_out",le.LOGGED_OUT);var r=this._controller;r.on("device_info_changed",(function(e){t._onDeviceStateChanged(e.data)})),r.on("devices_changed",this._onDevicesChanged.bind(this)),r.on("state_changed",this._onPlayerStateChanged.bind(this)),r.on("progress",this._onControllerProgress.bind(this)),this.proxyEmitAll(r,(e={},i()(e,"max_subscriptions_reached",le.MAX_SUBSCRIPTIONS_REACHED),i()(e,"device_deactivated",le.DEVICE_DEACTIVATED),e)),r.on("registered",this.emit.bind(this,le.REMOTE_OBSERVER_ENABLED,null)),r.on("deregistered",this.emit.bind(this,le.REMOTE_OBSERVER_DISABLED,null));var a=this._streamer;a?(a.on("deregistered",this._onStreamerDeregistered.bind(this)),a.on("registered",this._onStreamerRegistered.bind(this)),a.on("registration_aborted",this._onStreamerRegistrationAborted.bind(this)),a.on("state_changed",this._onStreamerStateChanged.bind(this)),a.on("stopped_on_background",this._onStreamerStoppedOnBackground.bind(this)),a.on("streamer_seek_handled",this._onSeekHandled.bind(this)),this.proxyEmitSync(a,"before_volume_change",le.BEFORE_VOLUME_CHANGE),this.proxyEmit(a,"autoplay_failed",le.AUTOPLAY_FAILED),this.proxyEmit(a,"stalled",le.BUFFER_STALLED),this.proxyEmit(a,"buffering_end",le.BUFFERING_END),this.proxyEmit(a,"buffering_start",le.BUFFERING_START),this.proxyEmit(a,"duration_changed",le.DURATION_CHANGED),this.proxyEmit(a,"max_list_errors_reached",le.MAX_LIST_ERRORS_REACHED),this.proxyEmit(a,"max_subscriptions_reached",le.MAX_SUBSCRIPTIONS_REACHED),this.proxyEmit(a,"playback_capped",le.PLAYBACK_CAPPED),this.proxyEmit(a,"player_initialization_done",le.PLAYER_INITIALIZATION_DONE),this.proxyEmit(a,"player_initialization_failed",le.PLAYER_INITIALIZATION_FAILED),this.proxyEmit(a,"progress",le.PROGRESS),this.proxyEmit(a,"registration_error",le.SERVICE_REGISTRATION_ERROR),this.proxyEmit(a,"track_ended",le.TRACK_ENDED),this.proxyEmit(a,"video_element_appended",le.VIDEO_ELEMENT_APPENDED),this.proxyEmit(a,"video_element_removed",le.VIDEO_ELEMENT_REMOVED),this.proxyEmit(a,"volume_changed",le.VOLUME_CHANGED),this.proxyEmit(a,"displayed_cues_changed",le.DISPLAYED_CUES_CHANGED),this.proxyEmit(a,"subtitle_languages_loaded",le.SUBTITLE_LANGUAGES_LOADED),this.proxyEmitSync(a,"internal_endcontent","internal_endcontent"),a.on("context_ended",this.emit.bind(this,le.LOCAL_CONTEXT_ENDED,null)),a.on("logged_out",this.emit.bind(this,le.LOCAL_PLAYER_LOGGED_OUT,null))):(this._disableLocalTarget(),this.on(le.AUTHENTICATED,(function(){t.emit(le.LOCAL_PLAYER_DISABLED,null)})))}},{key:"_createStreamerDeferred",value:function(){this._deferredStreamer=(0,pe.$)(),this._deferredStreamer.promise.catch((function(){}))}},{key:"_isTargetIdLocal",value:function(e){return e?e===_e?Promise.resolve(!0):this._client.getDeviceDescriptor().then((function(t){return e===t.getId()})):Promise.resolve(!!this._localPlayback)}},{key:"_onStreamerRegistered",value:function(e){this._deferredStreamer.resolve(e.data),this._createStreamerDeferred(),this._deferredStreamer.resolve(e.data),this._localPlayerEnabled=!0,this._controller.register(),this.emit(le.LOCAL_PLAYER_ENABLED,null)}},{key:"_onStreamerDeregistered",value:function(){this._disableLocalTarget(),this.emit(le.LOCAL_PLAYER_DISABLED,null)}},{key:"_onStreamerRegistrationAborted",value:function(){this._disableLocalTarget(),this._enableControllerWithoutStreamer&&this._controller.register(),this.emit(le.LOCAL_PLAYER_DISABLED,null)}},{key:"_disableLocalTarget",value:function(){this._localPlayerEnabled=!1;var e=new ge(ne.HARMONY_LOCAL_PLAYER_DISABLED,"Cannot perform command; local player is disabled.");this._deferredStreamer.reject(e),this._createStreamerDeferred(),this._deferredStreamer.reject(e)}},{key:"_onStreamerConnect",value:function(){return this._deferredStreamer.promise}},{key:"_onDeviceStateChanged",value:function(e){var t=this,n=!!this._localPlayback,r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t._generateLocalDeviceInfo(e).then((function(e){t.emit(le.LAST_ACTIVE_DEVICE_INFO_CHANGED,{deviceInfo:e,hasOrphanedState:!1})}))};if(this._localPlayerEnabled&&e.hasOrphanedState&&this._claimInactivePlayerStates)return this._hasFakeState=!0,void r(!0);if(this._hasFakeState=!1,this._localPlayback=!(!e.deviceInfo||!e.deviceInfo.local),this._localPlayback){if(!this._streamer)throw new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.");this._streamer.getVolume().then((function(n){e.deviceInfo&&(e.deviceInfo.volume=n),t.emit(le.LAST_ACTIVE_DEVICE_INFO_CHANGED,e)})).catch((function(){}))}else this._onlyLocalState?(this._localPlayback||n)&&r():this.emit(le.LAST_ACTIVE_DEVICE_INFO_CHANGED,e)}},{key:"_onDevicesChanged",value:function(e){var t=this,n=this._lastDeviceList;this._parseDeviceList(e.data).then((function(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Invalid devices list.");if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(!me(e[n],t[n]))return!1;return!0})(n,e)||t.emit(le.DEVICES_CHANGED,{devices:e,localDevice:null})}))}},{key:"_onError",value:function(e){var t=e.data.error;e.data.source===ue.PLAYBACK&&t&&t.unrecoverable&&(this._disableLocalTarget(),this._streamer&&this._streamer.deregister()),this.emit(le.ERROR,e.data)}},{key:"_onPlayerStateChanged",value:function(e){var t;this._onlyLocalState||(!this._preferController&&this._localPlayback||(t=this._localPlayerEnabled&&this._claimInactivePlayerStates?e.data.state:e.data.orphaned?null:e.data.state,this.emit(le.STATE_CHANGED,{state:t})))}},{key:"_onControllerProgress",value:function(e){this._onlyLocalState||this._localPlayback||this.emit(le.PROGRESS,e.data)}},{key:"_onStreamerStateChanged",value:function(e){this._preferController||(this._onlyLocalState?this._triggerLocalStateChanges(e.data):this._hidden?this._handleHidden(e.data):this._localPlayback&&this.emit(le.STATE_CHANGED,e.data))}},{key:"_onStreamerStoppedOnBackground",value:function(){this._deactivateOnStop&&(this._localPlayback=!1),this.emit(le.STOPPED_ON_BACKGROUND,null)}},{key:"_handleHidden",value:function(e){e.state?(this._controller.suppressEvents(),this._triggerLocalStateChanges(e)):this._controller.unsuppressEvents()}},{key:"_parseDeviceList",value:function(e){var t=this,n=e.devices.slice(0).map((function(e){return Promise.resolve(e)}));return n.length&&e.localDevice?this._hasFakeState&&e.localDevice&&(e.localDevice.is_active=!0):n.push(this._generateLocalDeviceInfo(this._hasFakeState)),Promise.all(n).then((function(e){return t._lastDeviceList=e,e}))}},{key:"_triggerLocalStateChanges",value:function(e){var t=this;this._generateLocalDeviceInfo().then((function(e){t._onDeviceStateChanged({deviceInfo:e,hasOrphanedState:!1})})),this.emit(le.STATE_CHANGED,e)}},{key:"_canStartNewContext",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer?Promise.resolve(!0):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided."))}),(function(){return Promise.resolve(!0)}),!0)}},{key:"_activateElement",value:function(){this._autoActivateElement=!1,this._streamer&&this._streamer.activateElement().catch((function(){}))}},{key:"_runOnDevice",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this._hasFakeState&&!i?(this._autoActivateElement&&this._activateElement(),this._claimStateAndRun(r)):this._isTargetIdLocal(t).then((function(t){return t?e._onStreamerConnect().then(n):r()}))}},{key:"_claimStateAndRun",value:function(e){var t=this;return this._onStreamerConnect().then((function(){return t._hasFakeState=!1,Promise.all([t._controller.transfer(_e,{paused:!0}),new Promise((function(e,n){t._streamer?t._streamer.once("track_loaded",e):n(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided."))}))])})).then((function(){return e()}))}},{key:"_generateLocalDeviceInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this._client,r=this._streamer,i=Promise.resolve(!1),a=Promise.resolve(-1);return this._localPlayerEnabled&&(t?i=Promise.resolve(!0):r&&(i=r.getCurrentState().then((function(e){return!!e}))),r&&(a=r.getVolume())),Promise.all([n.getClientDescriptor(),n.getSDKId(),i,a]).then((function(t){var n,r=se()(t,4),i=r[0],a=r[1],o=r[2],s=r[3],c={hifi_status:{fully_supported:void 0,user_eligible:void 0,device_supported:null===(n=i.capabilities)||void 0===n?void 0:n.lossless_playback}};return{hidden:e._hidden,id:i.id,is_active:o,is_group:!1,is_being_activated:!1,is_controllable:e._localPlayerEnabled,is_observable:!!e._localPlayerEnabled&&!e._hidden,local:!0,metadata:i.metadata||{},name:i.name,type:i.type,version:a,volume:s,capabilities:{supports_lossless_audio:!1},playback_features:c,has_inactive_player_state:e._hasFakeState}}))}},{key:"_movePosition",value:function(e,t){var n=this;return this.getCurrentState().then((function(r){if(!r||isNaN(r.position))return Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Seeking not allowed with invalid track."));var i=e,a=Math.min(r.duration,Math.max(0,r.position+i));return n.seek(a,t)}))}},{key:"_prepareSkipTrack",value:function(e){return"string"==typeof e?Ie(e):e}},{key:"_cycleRepeatMode",value:function(e){var t=this;return this.getCurrentState().then((function(n){if(!n)return Promise.reject(new ge(ne.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"));var r=null,i=n.disallows;switch(n.repeat_mode){case de.OFF:if(i.toggling_repeat_context){if(i.toggling_repeat_track)return Promise.resolve(!1);r=de.TRACK}else r=de.CONTEXT;break;case de.CONTEXT:r=i.toggling_repeat_track?de.OFF:de.TRACK;break;case de.TRACK:default:r=de.OFF}return t.setRepeatMode(r,e)}))}},{key:"_onSeekHandled",value:function(e){this._controller.seek(e.data.position)}},{key:"getClientDescriptor",value:function(){return this._client.getClientDescriptor()}},{key:"getProductState",value:function(){return this._client.getProductState()}},{key:"getPublicTransport",value:function(){return this._client.getPublicTransport()}},{key:"getUserInfo",value:function(){return this._client.getUserInfo()}},{key:"getVersionDescriptor",value:function(){return this._client.getVersionDescriptor()}},{key:"logAppMetrics",value:function(e,t){return this._client.logAppMetrics(e,t)}},{key:"setName",value:function(e){return this._client.setName(e)}},{key:"setNameTemplate",value:function(e){return this._client.setNameTemplate(e)}},{key:"getContextPlayerState",value:function(){return this._controller.getContextPlayerState()}},{key:"updateCurrentContext",value:function(e,t){return this._controller.updateCurrentContext(e,t)}},{key:"getLastActiveDevice",value:function(){var e=this;return this._onlyLocalState||this._hasFakeState?this._generateLocalDeviceInfo(this._hasFakeState):this._controller.getActiveDevice().then((function(t){return(null==t?void 0:t.local)&&e._streamer?(t.hidden=e._hidden,e._streamer.getVolume().then((function(e){return t.volume=e,t}))):t}))}},{key:"getCurrentState",value:function(){var e=this;if(!this._onlyLocalState&&(this._preferController||!this._localPlayback)){var t=!this._localPlayerEnabled||!this._claimInactivePlayerStates;return this._controller.getCurrentState(t).then((function(t){return!e._preferController&&e._localPlayback?e.getCurrentState():t}))}return this._onStreamerConnect().then(this._streamer.getCurrentState.bind(this._streamer))}},{key:"togglePlay",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer.togglePlay()}),this._controller.togglePlay.bind(this._controller,e))}},{key:"pause",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer.pause()}),this._controller.pause.bind(this._controller,e))}},{key:"resume",value:function(e){var t=this;return this._runOnDevice(e,(function(){return t._streamer.resume()}),this._controller.resume.bind(this._controller,e))}},{key:"playURI",value:function(e,t,n){var r=this;return this._canStartNewContext(t).then((function(){return r._autoActivateElement&&r._activateElement(),r._controller.playURI(e,t,n)}))}},{key:"playPages",value:function(e,t,n){var r=this;return this._canStartNewContext(t).then((function(){return r._autoActivateElement&&r._activateElement(),r._controller.playPages(e,t,n)}))}},{key:"playTracks",value:function(e,t,n){var r=this;return this._canStartNewContext(t).then((function(){return r._autoActivateElement&&r._activateElement(),r._controller.playTracks(e,t,n)}))}},{key:"nextTrack",value:function(e,t){var n=this,r={},i=function(){return n._streamer.nextTrack(ae.FORWARD_BUTTON)},a=this._controller.nextTrack.bind(this._controller,e,r);return(null==t?void 0:t.track)&&(i=a,r.track=this._prepareSkipTrack(t.track)),this._runOnDevice(e,i,a)}},{key:"smartPreviousTrack",value:function(e){var t=this;return this.getCurrentState().then((function(n){return n?(n.disallows||{}).seeking||n.position<3e3&&n.track_window&&n.track_window.previous_tracks&&n.track_window.previous_tracks.length>0?t.previousTrack(e):t.seek(0,e):Promise.reject(new ge(ne.HARMONY_NO_TRACKS_LOADED,"No current state."))}))}},{key:"previousTrack",value:function(e,t){var n=this,r={},i=function(){return n._streamer.previousTrack(ae.FORWARD_BUTTON)},a=this._controller.previousTrack.bind(this._controller,e,r);return(null==t?void 0:t.track)&&(i=a,r.track=this._prepareSkipTrack(t.track)),this._runOnDevice(e,i,a)}},{key:"seek",value:function(e,t){var n=this;return this._runOnDevice(t,(function(){return n._streamer.seek(e)}),this._controller.seek.bind(this._controller,e,t))}},{key:"seekForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0;return this._movePosition(e,t)}},{key:"seekBackward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0;return this._movePosition(-1*e,t)}},{key:"getVolume",value:function(){return this._streamer?this._streamer.getVolume():Promise.resolve(-1)}},{key:"setVolume",value:function(e,t){var n=this;return this._runOnDevice(t,(function(){return n._streamer.setVolume(e)}),this._controller.setVolume.bind(this._controller,e),!0)}},{key:"getVideoProfiles",value:function(){if(!this._streamer)throw new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.");return this._streamer.getVideoVariants()}},{key:"setPreferredBitrate",value:function(e){if(!this._streamer)throw new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.");return this._streamer.setPreferredBitrate(e)}},{key:"getDevices",value:function(){return this._controller.getDevices().then(this._parseDeviceList.bind(this))}},{key:"setQueue",value:function(e,t,n){var r=this._controller.setQueue.bind(this._controller,e,t,n);return this._runOnDevice(n,r,r)}},{key:"addToQueue",value:function(e,t){var n=e.map((function(e){return"string"==typeof e?e:e.uri}));return this._controller.getQueueManager().addToQueue(n,t)}},{key:"setShuffle",value:function(e,t){var n=this._controller.setShuffle.bind(this._controller,e,t);return this._runOnDevice(t,n,n)}},{key:"toggleShuffle",value:function(e){var t=this._controller.toggleShuffle.bind(this._controller,e);return this._runOnDevice(e,t,t)}},{key:"setRepeatMode",value:function(e,t){var n=this._controller.setRepeatMode.bind(this._controller,e,t);return this._runOnDevice(t,n,n)}},{key:"cycleRepeatMode",value:function(e){var t=this._cycleRepeatMode.bind(this,e);return this._runOnDevice(e,t,t)}},{key:"transfer",value:function(e,t){var n=e||_e,r=this._controller.transfer.bind(this._controller,n,t);return this._autoActivateElement&&this._activateElement(),this._runOnDevice(n,r,r,!0)}},{key:"logout",value:function(e){return this._controller.logout(e||_e)}},{key:"activateElement",value:function(){return this._streamer?this._streamer.activateElement():Promise.reject(new ge(ne.HARMONY_LOCAL_PLAYER_DISABLED,"Cannot activate element; local player is disabled."))}},{key:"getQueueManager",value:function(){var e=this;return this._controller.getQueueManager((function(t,n){return e._runOnDevice(n,t,t)}),{reportInactiveQueues:this._claimInactivePlayerStates,onlyLocalQueue:this._onlyLocalState,reportInitial:this._hasFakeState||this._localPlayback})}},{key:"hideSubtitles",value:function(){return this._localPlayback?this._streamer?this._streamer.hideSubtitles():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot hide subtitles on remote player."))}},{key:"showSubtitles",value:function(){return this._localPlayback?this._streamer?this._streamer.showSubtitles():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot show subtitles on remote player."))}},{key:"areSubtitlesShown",value:function(){return this._localPlayback?this._streamer?this._streamer.areSubtitlesShown():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot show subtitles on remote player."))}},{key:"getSubtitleLanguages",value:function(){return this._localPlayback?this._streamer?this._streamer.getSubtitleLanguages():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot get subtitle languages on remote player."))}},{key:"getActiveSubtitleLanguage",value:function(){return this._localPlayback?this._streamer?this._streamer.getActiveSubtitleLanguage():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot get subtitle language on remote player."))}},{key:"setSubtitleLanguage",value:function(e){return this._localPlayback?this._streamer?this._streamer.setSubtitleLanguage(e):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot set subtitle languages on remote player."))}},{key:"deactivateSubtitleEvents",value:function(){return this._localPlayback?this._streamer?this._streamer.activateSubtitleEvents():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot deactivate subtitle events on remote player."))}},{key:"activateSubtitleEvents",value:function(){return this._localPlayback?this._streamer?this._streamer.activateSubtitleEvents():Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot activate subtitle events on remote player."))}},{key:"setBackgrounded",value:function(e){return this._localPlayback?this._streamer?this._streamer.setBackgrounded(e):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot set background mode on remote player."))}},{key:"setVideoResolution",value:function(e){return this._localPlayback?this._streamer?this._streamer.setVideoResolution(e):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"No streamer provided.")):Promise.reject(new ge(ne.HARMONY_OPERATION_FORBIDDEN,"Cannot set preferred video resolution on remote player."))}},{key:"getMediaConfig",value:function(){return this._streamer?this._streamer.getMediaConfig():Promise.reject(new ge(ne.HARMONY_LOCAL_PLAYER_DISABLED,"Cannot activate element; local player is disabled."))}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp),xe=(n(5735),n(3753),n(8667)),Fe=n(9522),je=n(1612);!function(e){e.FILE_URLS_MP3="file_urls_mp3",e.FILE_URLS_EXTERNAL="file_urls_external",e.FILE_IDS_MP3="file_ids_mp3",e.FILE_IDS_MP4="file_ids_mp4",e.FILE_IDS_MP4_DUAL="file_ids_mp4_dual",e.FILE_IDS_CBCS="file_ids_mp4_cbcs",e.FILE_IDS_MP4FLAC="file_ids_mp4flac",e.MANIFEST_IDS_VIDEO="manifest_ids_video"}(De||(De={})),function(e){e.UNKNOWN="unknown",e.COMPUTER="computer",e.TABLET="tablet",e.SMARTPHONE="smartphone",e.SPEAKER="speaker",e.TV="tv",e.AVR="avr",e.STB="stb",e.AUDIO_DONGLE="audio_dongle",e.GAME_CONSOLE="game_console",e.CAST_VIDEO="cast_video",e.CAST_AUDIO="cast_audio",e.AUTOMOBILE="automobile",e.SMARTWATCH="smartwatch",e.CHROMEBOOK="chromebook"}(Ne||(Ne={}));n(9575),n(2472),n(2990),n(8927),n(3105),n(5035),n(4345),n(7174),n(2846),n(4731),n(7209),n(6319),n(8867),n(7789),n(3739),n(9368),n(4483),n(2056),n(3462),n(678),n(7462),n(3824),n(5021),n(2974),n(5016);var Be=n(3683);function Ye(){var e=new Uint8Array(16);return crypto.getRandomValues(e),Be.Base62.toHex(e.join(""),40).slice(0,40)}function Ve(){for(var e=new Array(27),t=e.length;t--;)e[t]=Math.floor(8*Math.random());return Be.Base62.toHex(e.join(""),40)}var Ke="undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues?Ye:Ve,He="_spharmony_device_id";var Ge={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&"string"==typeof e)return e;if(t)return Ke();var n=localStorage.getItem(He);return n||(n=Ke(),localStorage.setItem(He,n)),n},generate:Ke,generateWithCrypto:Ye,generateWithRandom:Ve};n(5306);function qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var We=function(e){m()(n,e);var t=qe(n);function n(e){var r,i;if(_()(this,n),(r=t.call(this))._platformVersion="",r._metadata={},r._manifestPrependOffset=0,!e)throw new TypeError("Invalid argument `options`.");if(!e.id)throw new TypeError("Argument `options.id` is required.");if(!e.name||!e.model||!e.type)throw new TypeError("Incomplete `options` value.");return r._id=e.id,r._type=e.type,r._brand=e.brand,r._model=e.model,r._isGroup=!!e.is_group,r._name=e.name,r._platformName=e.platform_name,r._platformIdentifier=e.platform_identifier,r._platformVersion=e.platform_version||"",r._metadata=e.metadata||{},r._capabilities=e.capabilities||{manifest_formats:[]},r._manifestPrependOffset=(null===(i=r._capabilities.manifest_formats)||void 0===i?void 0:i.length)||0,r}return h()(n,[{key:"getId",value:function(){return this._id}},{key:"setCapability",value:function(e,t){if("manifest_formats"===e)throw new TypeError('Cannot change capability "manifest_formats"');return this._capabilities[e]=t,this.emit("descriptor_changed",{descriptor:this.toJSON()}),!0}},{key:"getCapability",value:function(e){if("manifest_formats"===e)throw new TypeError("Use `descriptor.getManifestFormats()`.");return this._capabilities[e]}},{key:"setName",value:function(e){return this._name=e,this.emit("descriptor_changed",{descriptor:this.toJSON()}),!0}},{key:"getName",value:function(){return this._name}},{key:"getType",value:function(){return this._type}},{key:"getBrand",value:function(){return this._brand}},{key:"getModel",value:function(){return this._model}},{key:"getPlatformIdentifier",value:function(){return this._platformIdentifier||"Partner ".concat(this._brand," ").concat(this._model)}},{key:"getPlatformName",value:function(){return this._platformName||this.getPlatformIdentifier()}},{key:"getPlatformVersion",value:function(){return this._platformVersion}},{key:"getManifestFormats",value:function(){return this._capabilities.manifest_formats||[]}},{key:"appendManifestFormat",value:function(){var e=this._capabilities.manifest_formats;Array.isArray(e)&&e.push.apply(e,arguments)}},{key:"prependManifestFormat",value:function(){var e=this._capabilities.manifest_formats;if(Array.isArray(e)){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e.splice.apply(e,[this._manifestPrependOffset,0].concat(n))}}},{key:"toJSON",value:function(){return{brand:this._brand,capabilities:Object.assign({},this._capabilities),id:this._id,metadata:Object.assign({},this._metadata),model:this._model,name:this._name,platform_name:this._platformName,platform_identifier:this._platformIdentifier,platform_version:this._platformVersion,type:this._type}}},{key:"toTrackPlaybackDeviceInfo",value:function(){return{brand:this._brand,capabilities:Object.assign({},this._capabilities),device_id:this._id,device_type:this._type,metadata:Object.assign({},this._metadata),model:this._model,name:this._name,platform_name:this._platformName,platform_identifier:this._platformIdentifier,is_group:this._isGroup}}}],[{key:"create",value:function(e){return new n({id:Ge.get(e.id,e.randomizeId),model:e.model||(0,je._p)("harmony-{{name}}.{{version}}-{{platform}}").toLowerCase(),name:e.nameTemplate?(0,je._p)(e.nameTemplate):e.name||(t=(0,je._p)("Spotify ({{name}}/{{platform}})"),t.replace(/\b[a-z]/g,(function(e){return e.toUpperCase()}))),type:e.type||Ne.COMPUTER,brand:e.brand||"SpotifyHarmonyGeneric",platform_name:e.platform_name,platform_identifier:e.platform_identifier,platform_version:e.platform_version,metadata:e.metadata||{},capabilities:e.capabilities||{},is_group:!!e.is_group});var t}}]),n}(ce.vp);const ze={tagged:"4.24.0-ed6fca3",version:"4.24.0",revision:"ed6fca3"};function Qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $e(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xe=function(){function e(t){_()(this,e),this._melodyLogger=new je.Hx(t)}return h()(e,[{key:"logClientEvent",value:function(e,t){return e?this._melodyLogger.sendLog("/v1/msg/batch",{type:"client_event",message:{source:e.source||je.eV.UNKNOWN,context:e.context||je.eV.UNKNOWN,event:e.event||je.eV.UNKNOWN,event_version:e.event_version||je.eV.EMPTY,test_version:e.test_version||je.eV.EMPTY,source_version:e.source_version||je.eV.UNKNOWN,source_vendor:e.source_vendor||je.eV.UNKNOWN,json_data:"json"===t?e.json_data||"{}":JSON.stringify(e.json_data||{})}},{batch:!0}):Promise.reject(new TypeError("Logger.logClientEvent `data` cannot be null."))}},{key:"logMetrics",value:function(e,t){if(!e&&!t)return Promise.resolve(!0);var n=e||[],r=t||[];if(!n.length&&!r.length)return Promise.resolve(!0);if(!Array.isArray(n)||!Array.isArray(r))return Promise.reject(new TypeError("Logger.logMetrics `meters` and `timers` must be null or an array."));var i,a=Qe(n);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(!("what"in o)||!("result"in o)||!("reason"in o))return Promise.reject(new TypeError("Logger.logMetrics: Invalid meter format in `meters` array."))}}catch(u){a.e(u)}finally{a.f()}var s,c=Qe(r);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(!("what"in l)||!("duration"in l))return Promise.reject(new TypeError("Logger.logMetrics: Invalid timer format in `timers` array."))}}catch(u){c.e(u)}finally{c.f()}return this._melodyLogger.sendLog("/v1/metric",{sdk_id:void 0,platform:void 0,client_version:void 0,meters:n,timers:r})}},{key:"logJSSDKError",value:function(e,t){return this._melodyLogger.sendLog("/v1/msg/batch",{type:"jssdk_error",message:{source:e.source||je.eV.UNKNOWN,source_version:e.source_version||je.eV.UNKNOWN,type:e.type||je.eV.UNKNOWN,message:e.message||je.eV.EMPTY,stack:JSON.stringify(e.stack||je.eV.EMPTY),json_data:"json"===t?e.json_data||"{}":JSON.stringify(e.json_data||{}),json_data_version:e.json_data_version||je.eV.EMPTY_VERSION}},{batch:!0})}},{key:"logJSSDKContentRequest",value:function(e){var t;return this._melodyLogger.sendLog("/v1/msg/jssdk_content_request",{source:e.source||je.eV.UNKNOWN,type:e.type||je.eV.UNKNOWN,http_status:null!==(t=e.http_status)&&void 0!==t?t:void 0,ms_request_duration:e.ms_request_duration||je.eV.EMPTY,n_retries:e.n_retries||je.eV.ZERO,playback_id:e.playback_id||je.eV.EMPTY})}}]),e}();function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Je=xe.P.forTag("harmonyclient"),et=/^[a-zA-Z0-9_%:-]{1,40}$/,tt=function(e){m()(n,e);var t=Ze(n);function n(e){var r;if(_()(this,n),(r=t.call(this))._platformIdentifier=(0,pe.$)(),r._platformVersion=(0,pe.$)(),!e)throw new TypeError("Argument `options` is not defined.");if(!e.transport)throw new TypeError("No Transport instance provided");if(!e.transport.hasPlugin("dealer"))throw new TypeError("Transport has no Dealer plugin.");return r._transport=e.transport,r._deviceDescriptor=r._initDeviceDescriptor(e),r._logger=new Xe({transport:r._transport.toPublic(),sdkId:r.getSDKId(),platform:r._platformIdentifier.promise,clientVersion:r._platformVersion.promise}),r._productStateObserver=Fe.A.create({transport:r._transport}),r._onConnected=r._onConnected.bind(y()(r)),r._onAuthenticated=r._onAuthenticated.bind(y()(r)),r._onConnectionError=r._onConnectionError.bind(y()(r)),r._onAuthenticationError=r._onAuthenticationError.bind(y()(r)),r._onShortSessionDisconnect=r._onShortSessionDisconnect.bind(y()(r)),r._attachListeners(),r}return h()(n,[{key:"_createDeviceDescriptor",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((null==r?void 0:r.id)&&!et.test(r.id))throw ge.fatal(ne.HARMONY_INVALID_DESCRIPTOR_ID,"Invalid device id.");var i=r.capabilities||{},a={change_volume:null===(t=i.change_volume)||void 0===t||t,endsong_snooping:i.endsong_snooping,enable_play_token:!0,supports_file_media_type:!0,play_token_lost_behavior:e.playTokenLostBehavior||"pause",disable_connect:!!e.hidden,audio_podcasts:null===(n=i.audio_podcasts)||void 0===n||n,video_playback:i.video_playback,lossless_playback:i.lossless_playback,volume_steps:void 0!==i.volume_steps&&i.volume_steps>=0&&i.volume_steps<fe?i.volume_steps:void 0,manifest_formats:[De.FILE_IDS_MP3,De.FILE_URLS_MP3]},o=We.create(Object.assign(Object.assign({},r),{capabilities:a}));return this._platformIdentifier.resolve(o.getPlatformIdentifier()),this._platformVersion.resolve(o.getPlatformVersion()),this.proxyEmit(o,"descriptor_changed","descriptor_changed"),o}},{key:"_initDeviceDescriptor",value:function(e){var t=this;return Promise.resolve(e.descriptor).then(this._createDeviceDescriptor.bind(this,e)).catch((function(e){return t._onError(ue.HARMONY,{error:e}),Promise.reject(e)}))}},{key:"_attachListeners",value:function(){var e=this,t=this._transport;t.on(ie.TransportEvent.CONNECTED,this._onConnected),t.on(ie.TransportEvent.AUTHENTICATED,this._onAuthenticated),t.on(ie.TransportEvent.CONNECTION_FAILED,this._onConnectionError),t.on(ie.TransportEvent.AUTHENTICATION_FAILED,this._onAuthenticationError),this.proxyEmit(t,ie.TransportEvent.RECONNECTING,"reconnecting"),this.proxyEmit(t,ie.TransportEvent.RECONNECTED,"reconnected"),this.proxyEmit(t,ie.TransportEvent.LOGGED_OUT,"logged_out"),this.proxyEmitSync(t,ie.TransportEvent.BEFORE_OFFLINE_DISCONNECT,"before_offline_disconnect"),this.proxyEmitSync(t,ie.TransportEvent.BEFORE_ONLINE_DISCONNECT,"before_disconnect"),t.on(ie.TransportEvent.SHORT_SESSION_DISCONNECTED,this._onShortSessionDisconnect.bind(this)),this.proxyEmit(this._productStateObserver,ie.TransportEvent.PRODUCT_STATE_CHANGED,"product_state_changed"),this.on("before_disconnect",(function(t){var n=e._productStateObserver.deregister().catch((function(){}));t.data.awaitPromise(n)}))}},{key:"_onError",value:function(e,t){this.emit("error",{source:e,error:t.error}),t.error&&t.error.unrecoverable&&this.emit("unrecoverable_failure",{source:e,error:t.error})}},{key:"_onConnected",value:function(){this.emit("connected",null)}},{key:"_onAuthenticated",value:function(){this.emit("authenticated",null)}},{key:"_onConnectionError",value:function(e){this._onError(ue.TRANSPORT,{error:e.data.error}),this.emit("connection_error",e.data)}},{key:"_onAuthenticationError",value:function(e){this._onError(ue.TRANSPORT,{error:e.data.error}),this.emit("authentication_error",e.data)}},{key:"_onShortSessionDisconnect",value:function(e){this._logger.logClientEvent({source:"transport",source_version:ze.tagged,source_vendor:"spotify",event:e.type,event_version:"1.0.0",json_data:{disconnectCount:e.data.disconnectCount,sessionLength:e.data.sessionLength}},"object").catch((function(t){return Je.warn("".concat(e.type," Logging Error:"),t)}))}},{key:"getVersionDescriptor",value:function(){return Object.assign({},ze)}},{key:"getSDKId",value:function(){return"harmony:".concat(ze.tagged)}},{key:"getUntaggedSDKId",value:function(){return"harmony:".concat(ze.version)}},{key:"getPlatformIdentifier",value:function(){return this._platformIdentifier.promise}},{key:"getPlatformVersion",value:function(){return this._platformVersion.promise}},{key:"getLogger",value:function(){return this._logger}},{key:"logAppMetrics",value:function(e,t){if(!this._logger)throw new TypeError("Invalid logger instance");return this._logger.logMetrics(e,t)}},{key:"request",value:function(e,t){return this._transport.request(e,t)}},{key:"getPublicTransport",value:function(){return this._transport.toPublic()}},{key:"getClientDescriptor",value:function(){return this._deviceDescriptor.then((function(e){return e.toJSON()}))}},{key:"getDeviceDescriptor",value:function(){return this._deviceDescriptor}},{key:"getUserInfo",value:function(){return this._transport.request("@webapi/v1/me",{responseType:"json"}).then((function(e){var t=e.body;if(200!==e.status){var n=new ge(ne.USER_INFO_REQUEST_FAILED_WITH_STATUS,"User info request failed with status ".concat(e.status));return n.status=e.status,Promise.reject(n)}return t?{display_name:t.display_name,followers:t.followers,id:t.id,images:t.images,uri:t.uri}:Promise.reject(new ge(ne.USER_INFO_REQUEST_EMPTY_RESPONSE,"Unexpected empty response."))}))}},{key:"getProductState",value:function(){return this._productStateObserver.getCurrentState()}},{key:"setName",value:function(e){return this._deviceDescriptor.then((function(t){return t.setName(e)}))}},{key:"setNameTemplate",value:function(e){return this.setName((0,je._p)(e))}},{key:"setCapability",value:function(e,t){return this._deviceDescriptor.then((function(n){return n.setCapability(e,t)}))}},{key:"notifyError",value:function(e,t){this._onError(e,{error:t})}}],[{key:"create",value:function(e){return new n(e)}},{key:"of",value:function(e){return e._client}}]),n}(ce.vp);var nt,rt,it,at,ot,st=n(8367),ct=(n(2564),n(5192),n(9653),n(5018));function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}!function(e){e.KEY_SESSION_MESSAGE="message",e.KEY_SESSION_STATUSES_CHANGE="keystatuseschange",e.MEDIA_SOURCE_OPEN="sourceopen",e.MEDIA_SOURCE_CLOSE="sourceclose",e.SOURCE_BUFFER_UPDATE_END="updateend",e.MS_KEY_ADDED="mskeyadded",e.MS_KEY_ERROR="mskeyerror",e.MS_KEY_MESSAGE="mskeymessage",e.MS_NEEDKEY="msneedkey",e.WEBKIT_KEY_ADDED="webkitkeyadded",e.WEBKIT_KEY_ERROR="webkitkeyerror",e.WEBKIT_KEY_MESSAGE="webkitkeymessage",e.WEBKIT_NEEDKEY="webkitneedkey",e.V0_1B_KEY_ADDED="keyadded",e.V0_1B_KEY_ERROR="keyerror",e.V0_1B_KEY_MESSAGE="keymessage",e.V0_1B_NEEDKEY="needkey",e.MEDIA_CANPLAY="canplay",e.MEDIA_CANPLAYTHROUGH="canplaythrough",e.MEDIA_DURATIONCHANGE="durationchange",e.MEDIA_ENCRYPTED="encrypted",e.MEDIA_ENDED="ended",e.MEDIA_ERROR="error",e.MEDIA_LOADEDMETADATA="loadedmetadata",e.MEDIA_PAUSE="pause",e.MEDIA_PLAY="play",e.MEDIA_PLAYING="playing",e.MEDIA_SEEKING="seeking",e.MEDIA_TIMEUPDATE="timeupdate",e.MEDIA_WAITING="waiting",e.MEDIA_RATECHANGE="ratechange",e.MEDIA_RESIZE="resize",e.INTERNAL_ENCRYPTED="__encrypted",e.INTERNAL_PLAYER_CANPLAY="__canplay",e.INTERNAL_PLAYER_CANPLAYTHROUGH="__canplaythrough",e.INTERNAL_MEDIA_REQUIRES_DURATION="__requiresduration",e.INTERNAL_PLAYER_LOADED_METADATA="__loadedmetadata",e.BUFFER_APPEND_ERROR="append_error",e.BUFFER_QUOTA_EXCEEDED="quota_exceeded",e.BUFFER_STALLED="stalled",e.BUFFER_SOURCE_OPEN="source_open",e.BUFFER_SOURCE_CLOSE="source_close",e.BUFFERING_START="buffering_start",e.BUFFERING_END="buffering_end",e.EME_LICENSE_REQUEST_ERROR="license_request_error",e.EME_LICENSE_REQUEST_CAPPED="license_request_capped",e.LIST_PLAYER_AUTOPLAY_FAILED="player_autoplay_failed",e.LIST_PLAYER_BEFORE_LIST_CHANGE="before_list_change",e.LIST_PLAYER_BEFORE_NEXT="before_next",e.LIST_PLAYER_BEFORE_PLAYER_LOAD="before_player_load",e.LIST_PLAYER_BEFORE_PREVIOUS="before_previous",e.LIST_PLAYER_BEFORE_TRACK_LOAD="before_track_load",e.LIST_PLAYER_BEFORE_VOLUME_CHANGE="before_volume_change",e.LIST_PLAYER_BUFFER_STALLED="stalled",e.LIST_PLAYER_BUFFERING_START="buffering_start",e.LIST_PLAYER_BUFFERING_END="buffering_end",e.LIST_PLAYER_CAPPED="capped",e.LIST_PLAYER_CLEARED="cleared",e.LIST_PLAYER_DURATION_CHANGED="duration_changed",e.LIST_PLAYER_ERROR="error",e.LIST_PLAYER_ERROR_SYNC="error_sync",e.LIST_PLAYER_LIST_CHANGED="list_change",e.LIST_PLAYER_LIST_ENDED="list_ended",e.LIST_PLAYER_LOAD_VIDEO="load_video",e.LIST_PLAYER_MAX_LIST_ERRORS_REACHED="max_list_errors_reached",e.LIST_PLAYER_PAUSED="paused",e.LIST_PLAYER_PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.LIST_PLAYER_PLAYER_LOAD="player_load",e.LIST_PLAYER_PLAYING="playing",e.LIST_PLAYER_POSITION_CHANGED="position_changed",e.LIST_PLAYER_PROGRESS="progress",e.LIST_PLAYER_REPEAT_MODE_CHANGED="repeat_mode_changed",e.LIST_PLAYER_SHUFFLE_CHANGED="shuffle_changed",e.LIST_PLAYER_STOPPED="stopped",e.LIST_PLAYER_STOPPED_VIDEO="stopped_video",e.LIST_PLAYER_TRACKING_DATA_CREATED="tracking_data_created",e.LIST_PLAYER_TRACKING_DATA_FINALIZED="tracking_data_finalized",e.LIST_PLAYER_TRACK_ENDED="track_ended",e.LIST_PLAYER_TRACK_LOADED="track_loaded",e.LIST_PLAYER_TRACK_TIMEOUT="track_timeout",e.LIST_PLAYER_TRACK_UNPLAYABLE="track_unplayable",e.LIST_PLAYER_DATA_CREATED="tracking_data_created",e.LIST_PLAYER_DATA_FINALIZED="tracking_data_finalized",e.LIST_PLAYER_VOLUME_CHANGED="volume_changed",e.LIST_PLAYER_VIDEO_ELEMENT_APPENDED="video_element_appended",e.LIST_PLAYER_VIDEO_ELEMENT_REMOVED="video_element_removed",e.LIST_PLAYER_VIDEO_PROFILE_CHANGED="video_profile_changed",e.LIST_PLAYER_SEEK_HANDLED="list_player_seek_handled",e.LIST_PLAYER_DISPLAYED_CUES_CHANGED="displayed_cues_changed",e.LIST_PLAYER_PLAYBACK_SPEED_CHANGED="playback_speed_changed",e.LIST_PLAYER_SUBTITLE_LANGUAGES_LOADED="subtitle_languages_loaded",e.LOGGER_ERROR="error",e.PLAYER_AUTOPLAY_FAILED="player_autoplay_failed",e.PLAYER_BEFORE_LOAD="before_load",e.PLAYER_BEFORE_STOP="before_stop",e.PLAYER_BEFORE_VOLUME_CHANGE="before_volume_change",e.PLAYER_BUFFER_STALLED="stalled",e.PLAYER_BUFFERING_START="buffering_start",e.PLAYER_BUFFERING_END="buffering_end",e.PLAYER_CAN_PRELOAD="can_preload",e.PLAYER_CAPPED="capped",e.PLAYER_DURATION_CHANGED="duration_changed",e.PLAYER_ENDED="ended",e.PLAYER_ENDED_VIDEO="ended_video",e.PLAYER_ERROR="error",e.PLAYER_WARNING="warning",e.PLAYER_FIRST_BYTES="first_bytes",e.PLAYER_KEY_RECEIVED="key",e.PLAYER_LOAD="load",e.PLAYER_LOAD_VIDEO="load_video",e.PLAYER_LOADING_FAILED="loading_failed",e.PLAYER_PAUSED="paused",e.PLAYER_PLAY="play",e.PLAYER_PLAYING="playing",e.PLAYER_POSITION_CHANGED="position_changed",e.PLAYER_PRELOADING_ERROR="preloading_error",e.PLAYER_PROGRESS="progress",e.PLAYER_STALLED="stalled",e.PLAYER_STOPPED="stopped",e.PLAYER_STOPPED_VIDEO="stopped_video",e.PLAYER_PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.PLAYER_TIMEOUT="timeout",e.PLAYER_PLAYBACK_START="playback_start",e.PLAYER_TRACKING_DATA_CREATED="tracking_data_created",e.PLAYER_TRACKING_DATA_FINALIZED="tracking_data_finalized",e.PLAYER_VIDEO_ELEMENT_APPENDED="video_element_appended",e.PLAYER_VIDEO_ELEMENT_REMOVED="video_element_removed",e.PLAYER_VIDEO_PROFILE_CHANGED="video_profile_changed",e.PLAYER_DISPLAYED_CUES_CHANGED="displayed_cues_changed",e.PLAYER_SEEKING="seeking",e.PLAYER_FRAGMENT_FETCHED="fragment_fetched",e.PLAYER_FRAGMENT_FETCH_ERROR="fragment_fetch_error",e.PLAYER_VIDEO_MANIFEST_RESOLVED="video_manifest_resolved",e.PLAYER_VIDEO_MANIFEST_RESOLVE_FAILED="video_manifest_resolve_failed",e.PLAYER_PLAYBACK_SPEED_CHANGED="playback_speed_changed",e.PLAYER_SUBTITLE_LANGUAGES_LOADED="subtitle_languages_loaded",e.PLAYER_VIDEO_RESIZED="resize",e.PLAYER_MANAGER_READY="ready",e.TRACKER_PLAYBACK_START="playback_start",e.TRACKER_PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.TRACKER_TRACKING_DATA_CREATED="tracking_data_created",e.TRACKER_TRACKING_DATA_FINALIZED="tracking_data_finalized",e.VIDEO_MANIFEST_RESOLVED="video_manifest_resolved",e.VIDEO_MANIFEST_RESOLVE_FAILED="video_manifest_resolve_failed",e.ABR_MANAGER_BITRATE_CHANGE="bitrate_change"}(nt||(nt={})),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready",e.PLAYREADY_HARDWARE="com.microsoft.playready.hardware",e.FAIRPLAY="com.apple.fps.1_0",e.INVALID_SPOTIFY_KEY="com.spotify.invalid"}(rt||(rt={})),function(e){e.SUCCESS="RESULT_SUCCESS",e.INVALID="RESULT_INVALID",e.FORBIDDEN="RESULT_FORBIDDEN",e.OUT_OF_BOUNDS="RESULT_OUT_OF_BOUNDS",e.NO_LIST="RESULT_NO_LIST",e.NO_TRACK="RESULT_NO_TRACK",e.LIST_END="RESULT_LIST_END",e.INVALID_TRACK="RESULT_INVALID_TRACK",e.CANCELLED="CANCELLED",e.NO_TRACK_PLAYER="NO_TRACK_PLAYER"}(it||(it={})),function(e){e.MP3="MP3",e.MP4="MP4",e.MP4_DUAL="MP4_DUAL",e.MP4_CBCS="MP4_CBCS",e.MP4_FLAC="MP4_FLAC",e.MANIFEST_ID="MANIFEST_ID"}(at||(at={})),function(e){e.FRAGMENT_FETCHED="fragment_fetched",e.FRAGMENT_FETCH_ERROR="fragment_fetch_error",e.VIDEO_PROFILE_CHANGED="video_profile",e.SUBTITLE_LANGUAGES_LOADED="subtitle_languages_loaded"}(ot||(ot={}));var ut=function(e){m()(n,e);var t=lt(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).unrecoverable=!1,i.listPlayerIgnore=!1,i.debug={},i.code=e,i.message=r,i.name="PlaybackError",i}return h()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(ve()(Error));function dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var pt=function(e){m()(n,e);var t=dt(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q.STORAGE_ERROR,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"File Error";return _()(this,n),(e=t.call(this,i)).canPlayNext=!0,e.debug={},e.code=r,e.message=i,e.name="FileError",e}return h()(n)}(ve()(Error));n(4603),n(4723),n(1058),n(8255),n(8264);function _t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var ft=function(e){m()(n,e);var t=_t(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q.EME_ERROR_UNKNOWN,i=arguments.length>1?arguments[1]:void 0;return _()(this,n),(e=t.call(this,i)).status=-1,e.licenseServer="",e.shouldRefreshEndpoint=!1,e.unrecoverable=!1,e.debug={},e.code=r,e.message=i,e.name="EMEError",e}return h()(n,null,[{key:"fatal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q.EME_ERROR_UNKNOWN,t=arguments.length>1?arguments[1]:void 0,r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(ve()(Error));function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var vt=function(e){m()(n,e);var t=ht(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).name="CappingError",i.message=r,i.code=e,i}return h()(n)}(ve()(Error));function yt(e){var t=document.createEvent("Event");t.initEvent("encrypted",!1,!1),t.initDataType="cenc",t.initData=e.initData,t.fromPolyfill=!0,this.dispatchEvent(t)}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var mt=function(e){m()(n,e);var t=gt(n);function n(e){var r;return _()(this,n),(r=t.call(this,nt.KEY_SESSION_MESSAGE,null)).messageType="license-request",r.message=e,r}return h()(n)}(ce.B);function Et(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function St(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Rt=function(e){m()(n,e);var t=St(n);function n(e){var r;return _()(this,n),(r=t.call(this))._nativeKeySession=null,r._lastUpdateDeferred=(0,pe.$)(),r._lastGenerateDeferred=(0,pe.$)(),r.addEventListener=r.addListener,r.removeEventListener=r.removeListener,r._nativeMediaKeys=e,r._onKeyMessage=r._onKeyMessage.bind(y()(r)),r._onKeyAdded=r._onKeyAdded.bind(y()(r)),r._onKeyError=r._onKeyError.bind(y()(r)),r}return h()(n,[{key:"_attach",value:function(){var e=this._nativeKeySession;e&&(e.addEventListener(nt.MS_KEY_ADDED,this._onKeyAdded),e.addEventListener(nt.MS_KEY_ERROR,this._onKeyError),e.addEventListener(nt.MS_KEY_MESSAGE,this._onKeyMessage))}},{key:"_detach",value:function(){var e=this._nativeKeySession;e&&(e.removeEventListener(nt.MS_KEY_ADDED,this._onKeyAdded),e.removeEventListener(nt.MS_KEY_ERROR,this._onKeyError),e.removeEventListener(nt.MS_KEY_MESSAGE,this._onKeyMessage))}},{key:"_onKeyMessage",value:function(e){e.message&&e.message.buffer&&(this.emitEvent(new mt(e.message.buffer)),this._lastGenerateDeferred&&(this._lastGenerateDeferred.resolve(!0),this._lastGenerateDeferred=null))}},{key:"_onKeyAdded",value:function(){this._lastUpdateDeferred&&(this._lastUpdateDeferred.resolve(!0),this._lastUpdateDeferred=null),this._lastGenerateDeferred&&(this._lastGenerateDeferred.resolve(!0),this._lastGenerateDeferred=null),this.emit(nt.KEY_SESSION_STATUSES_CHANGE,null)}},{key:"_onKeyError",value:function(){var e=this._nativeKeySession&&this._nativeKeySession.error;this._lastGenerateDeferred&&(this._lastGenerateDeferred.reject(e),this._lastGenerateDeferred=null),this._lastUpdateDeferred&&(this._lastUpdateDeferred.reject(e),this._lastUpdateDeferred=null),this.emit(nt.KEY_SESSION_STATUSES_CHANGE,null)}},{key:"generateRequest",value:function(e,t){var n=this;return new Promise((function(e,r){n._lastGenerateDeferred&&(n._lastGenerateDeferred.resolve=e,n._lastGenerateDeferred.reject=r),n._nativeKeySession=n._nativeMediaKeys.createSession("audio/mp4",new Uint8Array(t),null),n._attach()}))}},{key:"update",value:function(e){var t=this;return new Promise((function(n,r){t._lastGenerateDeferred&&(t._lastGenerateDeferred.resolve=n,t._lastGenerateDeferred.reject=r),t._nativeKeySession&&t._nativeKeySession.update(new Uint8Array(e))}))}},{key:"close",value:function(){var e=this;return new Promise((function(t){e._nativeKeySession&&e._nativeKeySession.close(),e._detach(),t(!0)}))}}]),n}(ce.vp),kt=function(){function e(t){_()(this,e),this._lastBoundSetter=null,this.shouldRefreshPerTrack=!0,this._nativeMediaKeys=new MSMediaKeys(t)}return h()(e,[{key:"attach",value:function(e){var t=this;return new Promise((function(n){if(e.readyState>=1)return e.msSetMediaKeys(t._nativeMediaKeys),void n();var r=function n(){e.removeEventListener(nt.MEDIA_LOADEDMETADATA,n),t._lastBoundSetter=null,e.msSetMediaKeys(t._nativeMediaKeys)};t._lastBoundSetter=r,e.addEventListener(nt.MEDIA_LOADEDMETADATA,r),e.addEventListener(nt.MS_NEEDKEY,yt),n()}))}},{key:"detach",value:function(e){this._lastBoundSetter&&(e.removeEventListener(nt.MS_NEEDKEY,yt),e.removeEventListener(nt.MEDIA_LOADEDMETADATA,this._lastBoundSetter),this._lastBoundSetter=null)}},{key:"setServerCertificate",value:function(){return Promise.reject(new ft(Q.EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM,"Cannot set server certificate on this platform."))}},{key:"createSession",value:function(){return new Rt(this._nativeMediaKeys)}}]),e}();function Pt(e){var t=this.mediaKeys;return t&&t!==e&&t.detach(this),delete this.mediaKeys,this.mediaKeys=e,e&&e.attach(this),Promise.resolve()}var Tt=function(){function e(t,n){if(_()(this,e),this._configuration=null,this.keySystem=t,!this._checkConfig(n))throw new ft(Q.EME_NO_SUPPORTED_CONFIGURATION,"No supported configurations")}return h()(e,[{key:"_checkConfig",value:function(e){var t,n,r,i=this.keySystem,a=Et(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s={initDataTypes:o.initDataTypes,audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",sessionTypes:["temporary"],label:o.label},c=void 0;if(o.audioCapabilities&&o.audioCapabilities.length&&s.audioCapabilities){c=!1;var l,u=Et(o.audioCapabilities);try{for(u.s();!(l=u.n()).done;){var d=l.value,p=null===(t=d.contentType)||void 0===t?void 0:t.split(";")[0];MSMediaKeys.isTypeSupported(i,p)&&(s.audioCapabilities.push(d),c=!0)}}catch(y){u.e(y)}finally{u.f()}}if(o.videoCapabilities&&o.videoCapabilities.length&&s.videoCapabilities){c=!1;var _,f=Et(o.videoCapabilities);try{for(f.s();!(_=f.n()).done;){var h=_.value,v=null===(n=h.contentType)||void 0===n?void 0:n.split(";")[0];MSMediaKeys.isTypeSupported(i,v)&&(s.videoCapabilities.push(h),c=!0)}}catch(y){f.e(y)}finally{f.f()}}if(c)return this._configuration=s,!0}}catch(y){a.e(y)}finally{a.f()}return!1}},{key:"getConfiguration",value:function(){return this._configuration}},{key:"createMediaKeys",value:function(){var e=this;return new Promise((function(t){t(new kt(e.keySystem))}))}}]),e}();function At(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var It=xe.P.forTag("eme_polyfill.v0_1b"),Lt=function(e){m()(n,e);var t=wt(n);function n(e,r,i){var a;return _()(this,n),(a=t.call(this))._mediaElement=null,a._lastUpdateDeferred=null,a._lastGenerateResolver=null,a.sessionId=null,a._keySystem=e,a._mediaElement=r,a._prefix=i,a.addEventListener=a.addListener,a.removeEventListener=a.removeListener,a}return h()(n,[{key:"_addPrefix",value:function(e){return this._prefix?this._prefix+e.replace(/\b[a-z]/,(function(e){return e.toUpperCase()})):e}},{key:"generateComplete",value:function(e){this.emitEvent(new mt(e)),this._lastGenerateResolver&&(this._lastGenerateResolver.resolve(!0),this._lastGenerateResolver=null)}},{key:"updateComplete",value:function(){this._lastUpdateDeferred&&(this._lastUpdateDeferred.resolve(!0),this._lastUpdateDeferred=null),this.emit(nt.KEY_SESSION_STATUSES_CHANGE,null)}},{key:"handleErrorEvent",value:function(e){var t=new ft(Q.EME_MEDIA_KEY_SESSION_V0_1B_ERROR,"MediaKeySession v0.1b Error");t.debug.errorCode=e.errorCode,t.debug.systemCode=e.systemCode,!e.sessionId&&this._lastGenerateResolver?(this._lastGenerateResolver.reject(t),this._lastGenerateResolver=null):e.sessionId&&this._lastUpdateDeferred?(this._lastUpdateDeferred.reject(t),this._lastUpdateDeferred=null):this.emit(nt.KEY_SESSION_STATUSES_CHANGE,null)}},{key:"generateRequest",value:function(e,t){var n=this;return this._mediaElement?new Promise((function(e,r){n._lastGenerateResolver={resolve:e,reject:r};try{n._mediaElement[n._addPrefix("generateKeyRequest")](n._keySystem,new Uint8Array(t))}catch(i){r(i),n._lastGenerateResolver=null}})):Promise.reject(new ReferenceError("InvalidState: Media keys are not attached."))}},{key:"update",value:function(e){if(!this._mediaElement)return Promise.reject(new ReferenceError("InvalidState: Media keys are not attached."));if(this._lastUpdateDeferred){var t=this.update.bind(this,e);return this._lastUpdateDeferred.promise.then(t,t)}var n=(0,pe.$)();this._lastUpdateDeferred=n;try{this._mediaElement[this._addPrefix("addKey")](this._keySystem,new Uint8Array(e),null,this.sessionId)}catch(r){n.reject(r),this._lastUpdateDeferred=null}return n.promise}},{key:"close",value:function(){if(this.sessionId&&this._mediaElement)try{this._mediaElement[this._addPrefix("cancelKeyRequest")](this._keySystem,this.sessionId)}catch(e){It.warn("Could not close keysession",e)}return Promise.resolve(!0)}}]),n}(ce.vp),Ot=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_()(this,e),this._mediaElement=null,this._waitingForSessionIds=[],this._sessionMap={},this.shouldRefreshPerTrack=!0,this._keySystem=t,this._prefix=n,this._onKeyMessage=this._onKeyMessage.bind(this),this._onKeyAdded=this._onKeyAdded.bind(this),this._onKeyError=this._onKeyError.bind(this)}return h()(e,[{key:"attach",value:function(e){this._mediaElement=e;var t=this._prefix;e.addEventListener(t+nt.V0_1B_NEEDKEY,yt);var n=e.addEventListener.bind(e);n(t+nt.V0_1B_KEY_ADDED,this._onKeyAdded),n(t+nt.V0_1B_KEY_ERROR,this._onKeyError),n(t+nt.V0_1B_KEY_MESSAGE,this._onKeyMessage)}},{key:"detach",value:function(e){this._mediaElement=null;var t=this._prefix;e.removeEventListener(t+nt.V0_1B_NEEDKEY,yt);var n=e.removeEventListener.bind(e);n(t+nt.V0_1B_KEY_ADDED,this._onKeyAdded),n(t+nt.V0_1B_KEY_ERROR,this._onKeyError),n(t+nt.V0_1B_KEY_MESSAGE,this._onKeyMessage)}},{key:"_getSession",value:function(e){var t=this._sessionMap[e];if(t)return t;var n=this._waitingForSessionIds.shift();return n?(n.sessionId=e,this._sessionMap[e]=n,n):null}},{key:"_onKeyMessage",value:function(e){var t=this._getSession(e.sessionId);t?t.generateComplete(e.message):It.warn("Got keymessage without session.")}},{key:"_onKeyAdded",value:function(e){var t=this._getSession(e.sessionId);t?t.updateComplete():It.warn("Got keyadded without session.")}},{key:"_onKeyError",value:function(e){var t=this._getSession(e.sessionId);t?t.handleErrorEvent(e):It.warn("Got keyerror without session.")}},{key:"setServerCertificate",value:function(){return Promise.reject(new ft(Q.EME_CANNOT_SET_CERTIFICATE_FOR_PLATFORM,"Cannot set server certificate on this platform."))}},{key:"createSession",value:function(){var e=new Lt(this._keySystem,this._mediaElement,this._prefix);return this._waitingForSessionIds.push(e),e}}]),e}();function Dt(e){var t=this.mediaKeys;return t&&t!==e&&t.detach(this),delete this.mediaKeys,this.mediaKeys=e,e&&e.attach(this),Promise.resolve()}var Nt=function(){function e(t,n,r){if(_()(this,e),this._configuration=null,this.keySystem=t,this._prefix=r,!this._checkConfig(n))throw new ft(Q.EME_NO_SUPPORTED_CONFIGURATION,"No supported configurations")}return h()(e,[{key:"_checkConfig",value:function(e){var t,n,r,i=this.keySystem,a=document.createElement("video"),o=At(e);try{for(o.s();!(r=o.n()).done;){var s=r.value,c={initDataTypes:s.initDataTypes,audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",sessionTypes:["temporary"],label:s.label},l=!1;if(s.audioCapabilities&&s.audioCapabilities.length&&c.audioCapabilities){l=!1;var u,d=At(s.audioCapabilities);try{for(d.s();!(u=d.n()).done;){var p=u.value,_=null===(t=p.contentType)||void 0===t?void 0:t.split(";")[0];_&&a.canPlayType(_,i)&&(c.audioCapabilities.push(p),l=!0)}}catch(g){d.e(g)}finally{d.f()}}if(s.videoCapabilities&&s.videoCapabilities.length&&c.videoCapabilities){l=!1;var f,h=At(s.videoCapabilities);try{for(h.s();!(f=h.n()).done;){var v=f.value,y=null===(n=v.contentType)||void 0===n?void 0:n.split(";")[0];y&&a.canPlayType(y,i)&&(c.videoCapabilities.push(v),l=!0)}}catch(g){h.e(g)}finally{h.f()}}if(l)return this._configuration=c,!0}}catch(g){o.e(g)}finally{o.f()}return!1}},{key:"getConfiguration",value:function(){return this._configuration}},{key:"createMediaKeys",value:function(){var e=this;return new Promise((function(t){t(new Ot(e.keySystem,e._prefix))}))}}]),e}();function Mt(e){navigator.requestMediaKeySystemAccess=function(t,n){return new Promise((function(r){r(new Nt(t,n,e))}))};var t=HTMLMediaElement.prototype;delete t.mediaKeys,t.setMediaKeys=Dt}n(6716);function Ut(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var jt=xe.P.forTag("eme_polyfill.safari");var Bt=function(e){m()(n,e);var t=Ft(n);function n(e,r){var i;return _()(this,n),(i=t.call(this))._attached=!1,i._nativeKeySession=null,i._lastGenerateResolver=(0,pe.$)(),i._lastUpdateResolver=(0,pe.$)(),i.addEventListener=i.addListener,i.removeEventListener=i.removeListener,i._nativeMediaKeys=e,i._serverCertificate=r,i._onKeyMessage=i._onKeyMessage.bind(y()(i)),i._onKeyAdded=i._onKeyAdded.bind(y()(i)),i._onKeyError=i._onKeyError.bind(y()(i)),i}return h()(n,[{key:"_attach",value:function(){if(!this._attached){var e=this._nativeKeySession;e?(e.addEventListener(nt.WEBKIT_KEY_MESSAGE,this._onKeyMessage),e.addEventListener(nt.WEBKIT_KEY_ADDED,this._onKeyAdded),e.addEventListener(nt.WEBKIT_KEY_ERROR,this._onKeyError)):jt.warn("Tried to attach with no WebKitMediaKeySession")}}},{key:"_detach",value:function(){if(this._attached){var e=this._nativeKeySession;e?(e.removeEventListener(nt.WEBKIT_KEY_MESSAGE,this._onKeyMessage),e.removeEventListener(nt.WEBKIT_KEY_ADDED,this._onKeyAdded),e.removeEventListener(nt.WEBKIT_KEY_ERROR,this._onKeyError)):jt.warn("Tried to detach with no WebKitMediaKeySession")}}},{key:"_onKeyMessage",value:function(e){e.message&&e.message.buffer&&(this.emitEvent(new mt(e.message.buffer)),this._lastGenerateResolver&&(this._lastGenerateResolver.resolve(!0),this._lastGenerateResolver=null))}},{key:"_onKeyAdded",value:function(){this._lastUpdateResolver&&(this._lastUpdateResolver.resolve(!0),this._lastUpdateResolver=null),this.emit(nt.KEY_SESSION_STATUSES_CHANGE,null)}},{key:"_onKeyError",value:function(){var e=this._nativeKeySession&&this._nativeKeySession.error,t=new ft(Q.EME_MEDIA_KEY_SESSION_SAFARI_ERROR,e&&e.message||"MediaKeySession Safari Error");e&&(t.debug.errorCode=e.code,t.debug.systemCode=e.systemCode),this._lastGenerateResolver?(this._lastGenerateResolver.reject(t),this._lastGenerateResolver=null):this._lastUpdateResolver&&(this._lastUpdateResolver.reject(t),this._lastUpdateResolver=null)}},{key:"_rebuildInitData",value:function(e){var t=new Uint8Array(e);if(new DataView(t.buffer).getUint32(0,!0)+4!==t.byteLength)throw new ft(Q.EME_INIT_DATA_MALFORMED,"Malformed init data");var n=function(e){for(var t=Math.floor(e.byteLength/2),n=new Uint16Array(t),r=new DataView(e.buffer),i=0;i<t;i++)n[i]=r.getUint16(2*i,!0);return String.fromCharCode.apply(null,n)}(t.slice(4)),r=n.match(/^skd:\/\/([0-9a-fA-F]+)/);if(!(null==r?void 0:r[1]))throw new ft(Q.EME_INIT_DATA_MALFORMED,"Invalid content ID");var i=r[1],a=new Uint8Array(function(e){for(var t=new Uint8Array(2*e.length),n=new DataView(t.buffer),r=e.split(""),i=0,a=r.length;i<a;i++){var o=r[i].charCodeAt(0);n.setUint16(2*i,o,!0)}return t.buffer}(i)),o=this._serverCertificate,s=new Uint8Array(t.byteLength+4+a.byteLength+4+o.byteLength),c=0;s.set(t,c),c+=t.byteLength;var l=new DataView(s.buffer);return l.setUint32(c,a.byteLength,!0),c+=4,s.set(a,c),c+=a.byteLength,l.setUint32(c,o.byteLength,!0),c+=4,s.set(o,c),s}},{key:"generateRequest",value:function(e,t){var n=this;return new Promise((function(e,r){n._lastGenerateResolver={resolve:e,reject:r};try{var i=n._rebuildInitData(t);n._nativeKeySession=n._nativeMediaKeys.createSession("video/mp4",new Uint8Array(i),null),n._attach()}catch(a){n._lastGenerateResolver=null,r(a)}}))}},{key:"update",value:function(e){var t=(0,pe.$)();if(this._lastUpdateResolver=t,!this._nativeKeySession)return jt.warn("Tried to update with no WebKitMediaKeySession"),t.promise;try{this._nativeKeySession.update(new Uint8Array(e))}catch(n){t.reject(n)}return t.promise}},{key:"close",value:function(){var e=this;return new Promise((function(t){e._detach(),t(!0)}))}}]),n}(ce.vp),Yt=function(){function e(t){_()(this,e),this._lastBoundSetter=null,this._serverCertificate=null,this.shouldRefreshPerTrack=!0,this._nativeMediaKeys=new WebKitMediaKeys(t)}return h()(e,[{key:"attach",value:function(e){var t=this;return new Promise((function(n){if(e.readyState>=1)return e.webkitSetMediaKeys(t._nativeMediaKeys),void n();var r=function n(){e.removeEventListener(nt.MEDIA_LOADEDMETADATA,n),t._lastBoundSetter=null,e.webkitSetMediaKeys(t._nativeMediaKeys)};t._lastBoundSetter=r,e.addEventListener(nt.MEDIA_LOADEDMETADATA,r),e.addEventListener(nt.WEBKIT_NEEDKEY,yt),n()}))}},{key:"detach",value:function(e){e.removeEventListener(nt.WEBKIT_NEEDKEY,yt),this._lastBoundSetter&&(e.removeEventListener(nt.MEDIA_LOADEDMETADATA,this._lastBoundSetter),this._lastBoundSetter=null)}},{key:"setServerCertificate",value:function(e){return this._serverCertificate=new Uint8Array(e),Promise.resolve(!0)}},{key:"createSession",value:function(){if(!this._serverCertificate)throw new ft(Q.EME_INVALID_STATE_ERROR,"The server certificate is not available");return new Bt(this._nativeMediaKeys,this._serverCertificate)}}]),e}(),Vt=function(){function e(t,n){_()(this,e),this.keySystem=t;var r=this._checkConfig(n);if(!r)throw new ft(Q.EME_NO_SUPPORTED_CONFIGURATION,"No supported configurations");this._configuration=r}return h()(e,[{key:"_checkConfig",value:function(e){var t,n=this.keySystem,r=!1,i=Ut(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o={initDataTypes:a.initDataTypes,audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",sessionTypes:["temporary"]};if(a.audioCapabilities){var s,c=Ut(a.audioCapabilities);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(l.contentType){var u=l.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(n,u)&&(o.audioCapabilities.push(l),r=!0)}}}catch(h){c.e(h)}finally{c.f()}}if(a.videoCapabilities){var d,p=Ut(a.videoCapabilities);try{for(p.s();!(d=p.n()).done;){var _=d.value;if(_.contentType){var f=_.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(n,f)&&(o.videoCapabilities.push(_),r=!0)}}}catch(h){p.e(h)}finally{p.f()}}if(r)return o}}catch(h){i.e(h)}finally{i.f()}return null}},{key:"getConfiguration",value:function(){return this._configuration}},{key:"createMediaKeys",value:function(){var e=this;return new Promise((function(t){t(new Yt(e.keySystem))}))}}]),e}();function Kt(e){var t=this.mediaKeys;return t&&t!==e&&t.detach(this),delete this.mediaKeys,this.mediaKeys=e,e?e.attach(this):Promise.resolve()}var Ht,Gt=xe.P.forTag("eme_polyfills.tester");function qt(){return"undefined"!=typeof navigator&&(null===navigator||void 0===navigator?void 0:navigator.requestMediaKeySystemAccess)&&"undefined"==typeof WebKitMediaKeys&&"undefined"!=typeof MediaKeySystemAccess&&(null===MediaKeySystemAccess||void 0===MediaKeySystemAccess?void 0:MediaKeySystemAccess.prototype.getConfiguration)?(Gt.log("Using native EME implementation."),"native"):"undefined"!=typeof HTMLMediaElement&&(null===HTMLMediaElement||void 0===HTMLMediaElement?void 0:HTMLMediaElement.prototype.webkitGenerateKeyRequest)?(Gt.log('Detected "webkit" Prefixed EME v0.1b. Polyfilling.'),Mt("webkit"),"v0.1b-webkit"):"undefined"!=typeof HTMLMediaElement&&(null===HTMLMediaElement||void 0===HTMLMediaElement?void 0:HTMLMediaElement.prototype.generateKeyRequest)?(Gt.log("Detected Unprefixed EME v0.1b. Polyfilling."),Mt(),"v0.1b"):"undefined"!=typeof MSMediaKeys?(Gt.log("Detected MS IE EME. Polyfilling."),function(){navigator.requestMediaKeySystemAccess=function(e,t){return new Promise((function(n){n(new Tt(e,t))}))};var e=HTMLMediaElement.prototype;delete e.mediaKeys,e.setMediaKeys=Pt}(),"ms-ie"):"function"==typeof WebKitMediaKeys?(Gt.log("Detected Safari EME. Polyfilling."),function(){navigator.requestMediaKeySystemAccess=function(e,t){return new Promise((function(n){n(new Vt(e,t))}))};var e=HTMLMediaElement.prototype;delete e.mediaKeys,e.setMediaKeys=Kt}(),"safari"):(Gt.warn("Detected no EME APIs."),null)}var Wt=(Ht={},i()(Ht,rt.WIDEVINE,{commonName:"widevine",licenseServer:"https://@webgate/widevine-license",withCertificate:!0,pssh_field:{audio:"pssh_widevine",video:"encryption_data"}}),i()(Ht,rt.PLAYREADY,{commonName:"playready",licenseServer:"https://@webgate/playready-license",withCertificate:!1,pssh_field:{audio:"pssh_playready",video:"encryption_data"}}),i()(Ht,rt.PLAYREADY_HARDWARE,{commonName:"playready",licenseServer:"https://@webgate/playready-license",withCertificate:!1,pssh_field:{audio:"pssh_playready",video:"encryption_data"}}),i()(Ht,rt.FAIRPLAY,{commonName:"fairplay",licenseServer:"https://@webgate/fairplay-license",withCertificate:!0,pssh_field:{audio:"pssh_fairplay",video:"asset_id"}}),i()(Ht,rt.INVALID_SPOTIFY_KEY,{commonName:"spotify-invalid",licenseServer:"https://@webgate",withCertificate:!1,pssh_field:{audio:"pssh_invalid",video:"encryption_data"}}),Ht),zt=[{label:"video-sw-decode",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/webm; codecs="opus"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="flac"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/webm; codecs="vp9"',robustness:"SW_SECURE_DECODE"},{contentType:'video/webm; codecs="vp8"',robustness:"SW_SECURE_DECODE"},{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:"SW_SECURE_DECODE"},{contentType:'video/mp2t; codecs="avc1.4d401f"',robustness:"SW_SECURE_DECODE"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"video-sw-crypto",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/webm; codecs="opus"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="flac"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:'video/webm; codecs="vp9"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/webm; codecs="vp8"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:"SW_SECURE_CRYPTO"},{contentType:'video/mp2t; codecs="avc1.4d401f"',robustness:"SW_SECURE_CRYPTO"}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"video-no-robustness",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/webm; codecs="opus"',robustness:""},{contentType:'audio/mp4; codecs="flac"',robustness:""},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:""}],videoCapabilities:[{contentType:'video/webm; codecs="vp9"',robustness:""},{contentType:'video/webm; codecs="vp8"',robustness:""},{contentType:'video/mp4; codecs="avc1.4d401f"',robustness:""},{contentType:'video/mp2t; codecs="avc1.4d401f"',robustness:""}],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-flac-sw-crypto",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="flac"',robustness:"SW_SECURE_CRYPTO"},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-flac-no-robustness",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="flac"',robustness:""},{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:""}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-sw-crypto",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]},{label:"audio-no-robustness",initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4; codecs="mp4a.40.2"',robustness:""}],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:"optional",sessionTypes:["temporary"]}];function Qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xt(e,t){var n,r,i,a=Qt(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s={audioCapabilities:[],videoCapabilities:[]},c=void 0,l=!1;if(null===(n=o.audioCapabilities)||void 0===n?void 0:n.length){l=!1;var u,d=Qt(o.audioCapabilities);try{for(d.s();!(u=d.n()).done;){var p=u.value;(c=p.contentType)&&(t(c)&&(s.audioCapabilities.push(p),l=!0))}}catch(v){d.e(v)}finally{d.f()}}if(null===(r=o.videoCapabilities)||void 0===r?void 0:r.length){l=!1;var _,f=Qt(o.videoCapabilities);try{for(f.s();!(_=f.n()).done;){var h=_.value;(c=h.contentType)&&(t(c)&&(s.videoCapabilities.push(h),l=!0))}}catch(v){f.e(v)}finally{f.f()}}if(l)return s}}catch(v){a.e(v)}finally{a.f()}return null}var Zt=/([^;]+)(?:;\s?codecs="(.*)")?/;function Jt(e){var t,n=null!==(t=e.match(Zt))&&void 0!==t?t:[],r=se()(n,3),i=r[1],a=void 0===i?"unknown":i,o=r[2];return{mimeType:a,codec:void 0===o?"unknown":o,contentType:e}}function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function tn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rn=/([^;]+)(?:;\s?codecs="(.*)")?/,an=xe.P.forTag("playback.eme_manager"),on={EMPTY:"-no-robustness",SW_CRYPTO:"-sw-crypto",SW_DECODE:"-sw-decode",HW_CRYPTO:"-hw-crypto",HW_DECODE:"-hw-decode",HW_ALL:"-hw-all"};function sn(e,t){var n,r,i=[],a=new RegExp('codecs="('.concat(t.join("|"),')"')),o=tn(e);try{for(o.s();!(r=o.n()).done;){var s=r.value;a.test(null!==(n=s.contentType)&&void 0!==n?n:"")||i.push(s)}}catch(c){o.e(c)}finally{o.f()}return i.length?i:null}function cn(e,t){var n,r,i,a,o=t.audio,s=t.video;if(!(null==o?void 0:o.length)&&!(null==s?void 0:s.length))return e;var c=e.audioCapabilities,l=e.videoCapabilities;return(null==o?void 0:o.length)&&(null===(n=e.audioCapabilities)||void 0===n?void 0:n.length)&&!(c=null!==(r=sn(e.audioCapabilities,o))&&void 0!==r?r:void 0)||(null==s?void 0:s.length)&&(null===(i=e.videoCapabilities)||void 0===i?void 0:i.length)&&!(l=null!==(a=sn(e.videoCapabilities,s))&&void 0!==a?a:void 0)?null:Object.assign(Object.assign({},e),{audioCapabilities:c,videoCapabilities:l})}var ln=function(e){m()(n,e);var t=en(n);function n(e){var r,i;return _()(this,n),(r=t.call(this))._unauthServerCertificateBase="",r._disallowCodecs={},r._keySystemDeferred=(0,pe.$)(),r._configuration=(0,pe.$)(),r._keySystemSettings=null,r._keySessions=[],r._configs=[],r._pendingCertificateRequest=null,r._certificate=null,r._transport=e.transport,r._emeImpl=e.emeImpl,r._noServerCertificate=!!e.noServerCertificate,r._precacheServerCertificate=null===(i=e.precacheServerCertificate)||void 0===i||i,r._unauthServerCertificateBase=e.unauthServerCertificateBase||"https://spclient.wg.spotify.com",r._configFilter=function(e){var t=["--ensure-no-match--"];if(null==e?void 0:e.length)for(var n=e.length;n--;){var r=e[n];r&&on.hasOwnProperty(r)&&t.push(on[r])}return new RegExp("(".concat(t.join("|"),")$"))}(e.disallowRobustnessValues||[]),r._disallowCodecs=e.disallowCodecs,r._preferredKeySystems=e.preferredKeySystems||[rt.WIDEVINE,rt.PLAYREADY,rt.PLAYREADY_HARDWARE,rt.FAIRPLAY],r}return h()(n,[{key:"_prepareConfiguration",value:function(e){var t=e.getConfiguration();an.info("KeySystem configured as ",t.label),t.audioCapabilities&&t.audioCapabilities.length||this._appendProbableMediaCapabilities(e.keySystem,t);var n={keySystem:e.keySystem,keySystemImpl:this._emeImpl,audioFormats:this._parseCapabilities(t.audioCapabilities),videoFormats:this._parseCapabilities(t.videoCapabilities)};return this._keySystemSettings=Wt[e.keySystem],this._configuration.resolve(n),n}},{key:"_parseCapabilities",value:function(e){var t;if(!e)return[];var n,r=[],i=tn(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(null==a?void 0:a.contentType){var o=null!==(t=a.contentType.match(rn))&&void 0!==t?t:[],s=se()(o,3),c=s[1],l=s[2];c&&r.push({contentType:a.contentType,mimeType:c,codec:null!=l?l:""})}}}catch(u){i.e(u)}finally{i.f()}return r}},{key:"_appendProbableMediaCapabilities",value:function(e,t){var n=Xt(this._configs,(function(t){return(-1===t.indexOf("webm")||e!==rt.PLAYREADY&&e!==rt.PLAYREADY_HARDWARE)&&!!MediaSource.isTypeSupported(t)}));n&&(t.audioCapabilities=n.audioCapabilities,t.videoCapabilities=n.videoCapabilities)}},{key:"_trySetServerCertificate",value:function(e,t){var n=this,r=this._certificate;return(r&&r.expiry>Date.now()?Promise.resolve(r):this._requestServerCertificate(e)).then((function(e){return t.setServerCertificate(e.contents)})).then((function(){return n})).catch((function(e){return an.warn("Error from setting server certificate",e),n}))}},{key:"_cacheServerCertificate",value:function(e){var t=this,n="";switch(e){case rt.FAIRPLAY:n="fairplay";break;case rt.WIDEVINE:n="widevine";break;default:return Promise.resolve(this)}return this._requestServerCertificate("".concat(this._unauthServerCertificateBase,"/").concat(n,"-license"),!1).then((function(){return t}),(function(e){return an.warn("Cannot precache server certificate",e),t}))}},{key:"_requestServerCertificate",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._pendingCertificateRequest)return this._pendingCertificateRequest;var r=this._transport.request("".concat(e,"/v1/application-certificate"),{authorize:n,responseType:"arraybuffer",parseResponseHeaders:!0,retry:{condition:function(e,t){return e.getStatusFamily()===t.SERVER_ERROR}}}).then((function(e){var n;if(!e.body)throw new TypeError("Response body is invalid");t._pendingCertificateRequest=null;var r=3600,i=null===(n=e.headers)||void 0===n?void 0:n.get("cache-control");if(i){var a=i.match(/(?:^|,|\s)max-age=(\d+)(?:,|$)/);a&&a[1]&&(r=1e3*parseInt(a[1],10))}return t._certificate={expiry:Date.now()+(r-600),contents:e.body},t._certificate}));return r}},{key:"_extractPlayReadyChallenge",value:function(e,t){var n,r=null,i=new Uint16Array(e),a=String.fromCharCode.apply(null,i);if(-1===a.indexOf("PlayReadyKeyMessage"))return an.info("Using unextracted PlayReady message."),e;var o=(new DOMParser).parseFromString(a,"application/xml"),s=o.getElementsByTagName("Challenge")[0],c=null===(n=null==s?void 0:s.childNodes[0])||void 0===n?void 0:n.nodeValue;if(c)try{r=atob(c);var l=o.getElementsByTagName("name"),u=o.getElementsByTagName("value");if(l.length!==u.length)throw new ft(Q.EME_HEADER_KEY_VALUE_MISMATCH,"Mismatched header <name>/<value> pair in key message")}catch(d){this.emit(nt.EME_LICENSE_REQUEST_ERROR,{playId:t,error:d}),r=null}else this.emit(nt.EME_LICENSE_REQUEST_ERROR,{playId:t,error:new ft(Q.EME_HEADER_KEY_VALUE_MISMATCH,"Mismatched header <name>/<value> pair in key message")});return r}},{key:"_onMessage",value:function(e,t){e.timeMap.generate.end=Date.now();var n="message"in t?t.message:null,r="messageType"in t?t.messageType:void 0;if(an.info("Got EME message event with type",r),n&&e.keySystem===rt.PLAYREADY&&(n=this._extractPlayReadyChallenge(n,e.playId)),n)if(e.licenseServer){e.timeMap.request.start=Date.now();var i=e.licenseServer;e.keySystem===rt.FAIRPLAY&&(i="".concat(i).concat(-1!==i.indexOf("?")?"&":"?","assetId=hex")),this._transport.request(i,{method:"POST",payload:n,responseType:"arraybuffer",retry:{condition:function(e,t){return 400!==e.status&&402!==e.status&&403!==e.status&&(!e.body||e.getStatusFamily()!==t.SUCCESS)}}}).then(this._handleLicenseResponse.bind(this,e))}else an.info("Ignoring message event: no licenseServer url");else an.info("Ignoring message event: no valid request payload")}},{key:"_handleLicenseResponse",value:function(e,t){var n,r=this,i=function(t){t.playId=e.playId,e.licenseServer&&(t.licenseServer=e.licenseServer),r.emit(nt.EME_LICENSE_REQUEST_ERROR,{playId:e.playId,error:t})};if(e.timeMap.request.end=Date.now(),200!==t.status){var a;try{if(t.body){var o=new Uint8Array(t.body),s=String.fromCharCode.apply(String,o);a=JSON.parse(s).errorMsg}}catch(l){}402===t.status?this.emit(nt.EME_LICENSE_REQUEST_CAPPED,{playId:e.playId,error:new vt(Q.CAPPING_USER_IS_CAPPED,"User is capped.")}):400===t.status&&"widevine error"===a?((n=ft.fatal(Q.EME_LICENSE_REQUEST_WIDEVINE_ERROR,"Widevine license server failed to parse request.")).status=t.status,n.shouldRefreshEndpoint=!0,i(n)):((n=new ft(Q.EME_LICENSE_REQUEST_FAILED_WITH_STATUS,"License request failed (".concat(a||"unknown",")"))).status=t.status,n.shouldRefreshEndpoint=400===t.status||403===t.status,i(n))}else{if(!t.body)return(n=new ft(Q.EME_LICENSE_REQUEST_EMPTY_RESPONSE,"Empty license response body")).status=t.status,void i(n);try{e.timeMap.update.start=Date.now(),e.keySession.update(t.body).catch((function(e){i(new ft(Q.EME_LICENSE_UPDATE_FAILED,e.message||"License update failed."))})),an.info("KeySession updated.")}catch(u){var c=u.message;i(new ft(Q.EME_LICENSE_UPDATE_FAILED,c||"License update failed."))}}}},{key:"_selectKeySystem",value:function(e){for(var t=this._preferredKeySystems,n=0,r=t.length;n<r;n++){var i=t[n];if(i&&i in e)return e[i]}return null}},{key:"_testMediaKeys",value:function(e){return new Promise((function(t){t(e.createMediaKeys())})).then((function(t){if(!t)return Promise.reject(ft.fatal(Q.EME_MEDIA_KEYS_NOT_SUPPORTED,"Cannot create MediaKeys from KeySystemAccess"));e.keySystem===rt.FAIRPLAY&&t.setServerCertificate(new ArrayBuffer(0));try{if(!t.createSession())throw new Error("")}catch(r){var n=r.message;return Promise.reject(ft.fatal(Q.EME_MEDIA_KEY_SESSION_NOT_SUPPORTED,n||"Cannot create MediaKeySession from KeySystemAccess"))}return Promise.resolve(e)}),(function(e){return an.error(e.name),Promise.reject(ft.fatal(Q.EME_MEDIA_KEYS_NOT_SUPPORTED,e.message||"Unknown error"))}))}},{key:"_saveSession",value:function(e){this._keySessions.push(e)}},{key:"destroySessions",value:function(){var e,t=[],n=tn(this._keySessions);try{for(n.s();!(e=n.n()).done;){var r=e.value;try{var i=r.keySession;if(!i)continue;r.onMessageListener&&i.removeEventListener(nt.KEY_SESSION_MESSAGE,r.onMessageListener),r.onKeyStatusChangeListener&&i.removeEventListener(nt.KEY_SESSION_STATUSES_CHANGE,r.onKeyStatusChangeListener);var a=Promise.resolve(i.close()).catch((function(e){an.warn("Failed to close KeySession",e)}));t.push(a),r.keySession=null,r.onMessageListener=null,r.onKeyStatusChangeListener=null,an.info("Closed KeySession")}catch(o){an.warn("Failed to close KeySession",o)}}}catch(s){n.e(s)}finally{n.f()}return this._keySessions=[],Promise.all(t)}},{key:"init",value:function(){var e,t=this,n=this._keySystemDeferred,r={},i=[],a=[],o=tn(zt);try{for(o.s();!(e=o.n()).done;){var s=e.value;if(!s.label||!this._configFilter.test(s.label)){if(this._disallowCodecs){var c=cn(s,this._disallowCodecs);if(!c)continue;s=c}a.push(s)}}}catch(d){o.e(d)}finally{o.f()}for(var l in this._configs=a,rt)if(Object.prototype.hasOwnProperty.call(rt,l)){var u=l;i.push(navigator.requestMediaKeySystemAccess(rt[u],a).then((function(e){r[e.keySystem]=e})).catch((function(){})))}return Promise.all(i).then(this._selectKeySystem.bind(this,r)).then((function(e){return e?t._testMediaKeys(e):Promise.reject(new ft(Q.EME_NO_SUPPORTED_KEYSYSTEM,"No supported keysystem was found."))})).then((function(e){return t._prepareConfiguration(e),n.resolve(e),t._precacheServerCertificate?t._cacheServerCertificate(e.keySystem):t})).catch((function(e){var r=e.code||Q.EME_NO_SUPPORTED_KEYSYSTEM,i=e.message||"No supported keysystem";return n.reject(ft.fatal(r,i)),n.promise.then((function(){return t}))}))}},{key:"createMediaKeys",value:function(e){var t=this;return this._keySystemDeferred.promise.then((function(e){return e.createMediaKeys()})).then((function(t){return Promise.all([e.setMediaKeys(t),t])})).then((function(n){var r=se()(n,2),i=(r[0],r[1]);if(!e.mediaKeys)throw new ft(Q.EME_PLAYER_MEDIA_KEYS_SETTING_FAILED,"Failed to set MediaKeys on HTMLMediaElement");return t._configuration.promise.then((function(){var e=t._keySystemSettings;return e&&!t._noServerCertificate&&e.withCertificate?t._trySetServerCertificate(e.licenseServer,i):t}))}))}},{key:"removeMediaKeys",value:function(e){var t=this;return Promise.resolve(e.setMediaKeys(null)).then((function(){return t}))}},{key:"getKeySystemInfo",value:function(){return this._configuration.promise}},{key:"getKeySystemImpl",value:function(){return this._emeImpl}},{key:"createSessionWithParams",value:function(e){var t=this;return new Promise((function(n,r){an.info("Creating KeySession",e.keySystem);var i=e.mediaKeys.createSession(),a={generate:{start:0,end:0},request:{start:0,end:0},update:{start:0,end:0}},o=t._keySystemSettings&&t._keySystemSettings.licenseServer||void 0,s=t._onMessage.bind(t,{keySystem:e.keySystem,keySession:i,licenseServer:e.licenseServer||o,playId:e.playId,timeMap:a});i.addEventListener(nt.KEY_SESSION_MESSAGE,s);var c=function(){an.info("KeyStatus change"),a.update.end=Date.now(),n({elapsed:{generate:Math.max(a.generate.end-a.generate.start,0),request:Math.max(a.request.end-a.request.start,0),update:Math.max(a.update.end-a.update.start,0)}})};return i.addEventListener(nt.KEY_SESSION_STATUSES_CHANGE,c),t._saveSession({keySession:i,onMessageListener:s,onKeyStatusChangeListener:c}),an.info("Generating KeySession request",e.keySystem),a.generate.start=Date.now(),Promise.resolve(i.generateRequest(e.initDataType,e.initData.buffer)).catch((function(e){if(e){var t;switch(e.name){case"NotSupportedError":t=Q.EME_NOT_SUPPORTED_ERROR;break;case"InvalidStateError":t=Q.EME_INVALID_STATE_ERROR;break;default:t=Q.EME_UNKNOWN_ERROR}r(new ft(t,e.message||"Unknown error message."))}}))}))}}],[{key:"create",value:function(e){return new Promise((function(t){var r=qt();if(!r)throw ft.fatal(Q.EME_API_NOT_SUPPORTED,"Platform does not support navigator.requestMediaKeySystemAccess");t(new n(Object.assign(Object.assign({},e),{emeImpl:r})).init())}))}}]),n}(ce.vp),un=n(8551),dn=n.n(un);n(4363);function pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var _n=function(e){m()(n,e);var t=pn(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _()(this,n),(a=t.call(this,r)).code=e,a.message=r,a.status=i,a.debug=o,a.name="FragmentError",a}return h()(n)}(ve()(Error)),fn=function(){function e(t){var n;if(_()(this,e),this._fallbackURLs=[],this._fragments=[],this._loaded=!1,this._mediaType="audio",this._noAuth=!1,this._resolvedURLs=[],this._segmentLength=0,this._duration=0,!t.fileId&&!t.resolvedURL)throw new TypeError("Missing: provide either fileId or resolvedURL");this._abrManager=t.abrManager,this._mediator=t.mediator,this._disableCache=t.disableCache,this._fileId=t.fileId,this._format=t.format,this._isAd=t.isAd||!1,this._keySystem=t.keySystem,this._keySystemSettings=Wt[this._keySystem],this._licenseEndpoint=t.licenseEndpoint,this._logData=t.logData||{displayTrack:"",playbackId:""},this._resolver=t.resolver,this._resolvedURL=t.resolvedURL,this._noAuth=null!==(n=t.noAuth)&&void 0!==n&&n,this._transport=t.transport,this._uri=t.uri}return h()(e,[{key:"_parsePSSHBox",value:function(e){for(var t=Be.Base64.decode(e),n=new Uint8Array(t.length),r=0,i=t.length;r<i;r++)n[r]=t.charCodeAt(r);return n}},{key:"_parseAssetID",value:function(e){for(var t=Be.Base64.decode(e),n=new Array(t.length),r=0,i=t.length;r<i;r++){var a=t.charCodeAt(r).toString(16);n[r]=1===a.length?"0".concat(a):a}return n.join("")}},{key:"getCalculatedDuration",value:function(){return this._duration}},{key:"getFileId",value:function(){return this._fileId}},{key:"getFormat",value:function(){return this._format||""}},{key:"getFragmentLength",value:function(){return this._segmentLength}},{key:"canLowerBitrate",value:function(){return!1}},{key:"getInitFragment",value:function(){return this._initFragment}},{key:"getInitParams",value:function(){var e={keySystem:this._keySystem,initDataType:this._protection,initData:this._psshBox,licenseServer:null};return Promise.resolve(e)}},{key:"getKeySystem",value:function(){return this._keySystem}},{key:"getLicenseEndpoint",value:function(){return this._licenseEndpoint}},{key:"getLogData",value:function(){return this._logData||{}}},{key:"getMediaType",value:function(){return this._mediaType}},{key:"getResolvedURL",value:function(){return this._resolvedURL}},{key:"getResolvedURLs",value:function(){return this._resolvedURLs}},{key:"getHLSURL",value:function(){throw new pt(Q.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.")}},{key:"releaseHLSURL",value:function(){}},{key:"getURI",value:function(){return this._uri}},{key:"isAd",value:function(){return this._isAd}},{key:"isProtected",value:function(){return!!this._protection&&!!this._psshBox}},{key:"setLogData",value:function(e){return this._logData=e,this}},{key:"toLogJSON",value:function(){return{uri:this._uri,fileId:this._fileId,format:this._format||"",resolved_url:this._resolvedURL}}}]),e}(),hn="application/vnd.apple.mpegurl";function vn(e){var t,n=function(e){return e.map((function(e){if(e.byteEnd&&void 0!==e.byteStart){var t="".concat(1+e.byteEnd-e.byteStart);return t+="@".concat(e.byteStart),"#EXTINF:".concat(e.duration,",\n#EXT-X-BYTERANGE:").concat(t,"\n").concat(e.url)}return"#EXTINF:".concat(e.duration,",\n").concat(e.url)})).join("\n")}(e.segments),r=e.assetID?'#EXT-X-KEY:METHOD=SAMPLE-AES,URI="skd://'.concat(e.assetID,'",KEYFORMATVERSIONS="1",KEYFORMAT="com.apple.streamingkeydelivery"'):"",i=e.map?'#EXT-X-MAP:URI="'.concat(e.map.url,'"'):"";return(null===(t=e.map)||void 0===t?void 0:t.byteEnd)&&void 0!==e.map.byteStart&&(i+=',BYTERANGE="'.concat(1+e.map.byteEnd,"@").concat(e.map.byteStart,'"')),"#EXTM3U\n#EXT-X-VERSION:6\n#EXT-X-TARGETDURATION:".concat(Math.floor(e.targetDuration),"\n#EXT-X-MEDIA-SEQUENCE:0\n#EXT-X-PLAYLIST-TYPE:VOD\n").concat(i?"".concat(r,"\n").concat(i):r,"\n").concat(n,"\n#EXT-X-ENDLIST")}function yn(e){return"data:application/vnd.apple.mpegurl;base64,".concat(btoa(e))}function gn(e){var t=new Blob([e],{type:hn});return URL.createObjectURL(t)}function mn(e){return gn(vn(e))}function En(e){return yn(vn(e))}n(2707);var bn=/avc1\.(([0-9a-f]{2})[0-9a-f]{2}([0-9a-f]{2}))/;function Sn(e,t){var n=e.toLowerCase().match(bn),r=t.toLowerCase().match(bn);if(!n||!r)return!1;var i=se()(n,4),a=i[1],o=i[2],s=i[3],c=se()(r,4),l=c[1],u=c[2],d=c[3];return a===l||"4d"===o&&"4d"===u&&parseInt(s,16)>=parseInt(d,16)}function Rn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pn(e,t){return e.sort((function(e,n){return"video_bitrate"in e&&"video_bitrate"in n?t?e.video_resolution===n.video_resolution?e.video_bitrate-n.video_bitrate:e.video_resolution-n.video_resolution:e.video_bitrate-n.video_bitrate:e.max_bitrate-n.max_bitrate}))}function Tn(e,t){return void 0!==t&&Array.isArray(e.encryption_indices)&&-1===e.encryption_indices.indexOf(t)}function An(e,t){return!!t&&t(Object.assign({mimeType:e.mime_type},function(e){return"video_codec"in e}(e)?{type:"video",codec:e.video_codec,bitrate:e.video_bitrate,height:e.video_height,width:e.video_width}:{type:"audio",codec:e.audio_codec,bitrate:e.audio_bitrate}))}function Cn(e){return"audio_codec"in e?e.audio_codec:e.video_codec}function wn(e){var t,n=e.codec,r=e.formats,i=e.profiles,a=e.encryptionIndex,o=e.disallowProfile,s=e.preferredKeySystem,c=e.preferredVideoResolution,l=e.allowMixedAVC1Codecs,u=Rn(r);try{for(u.s();!(t=u.n()).done;){var d,p=t.value,_=[],f="spotify/unknown-mimetype",h="unknown-codec",v=Rn(i);try{for(v.s();!(d=v.n()).done;){var y=d.value,g=Cn(y);!(n in y)||Tn(y,a)||s===rt.FAIRPLAY&&"ts"!==y.file_type||An(y,o)||(s!==rt.FAIRPLAY||"ts"!==y.file_type?"unknown-codec"!==h||y.mime_type!==p.mimeType||g!==p.codec&&!Sn(p.codec,g)?y.mime_type===f&&(g===h||l&&Sn(h,g))&&(_.push(y),y.__effective_codec=h):(f=p.mimeType,h=l?p.codec:g,_.push(y),y.__effective_codec=p.codec):_.push(y))}}catch(m){v.e(m)}finally{v.f()}if(_.length)return Pn(_,c)}}catch(m){u.e(m)}finally{u.f()}return[]}function In(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ln(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ln(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function On(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Dn=xe.P.forTag("playback.video_content");function Nn(e){if(!e)return"";var t=e.__effective_codec||("audio_codec"in e?e.audio_codec:e.video_codec);return"".concat(e.mime_type,';codecs="').concat(t,'"')}var Mn,Un,xn={method:"GET",responseType:"arraybuffer",timing:!0,retry:{condition:function(e,t){if(0===e.status)return!0;var n=e.getStatusFamily();return n===t.CONNECTION_ERROR||n===t.SERVER_ERROR}}},Fn=function(e){m()(n,e);var t=On(n);function n(e){var r;return _()(this,n),(r=t.call(this,e))._assetId="",r._endTime=0,r._videoFormats=[],r._audioFormats=[],r._subtitleLanguages=[],r._videoProfile=null,r._videoProfiles=[],r._audioProfile=null,r._audioProfiles=[],r._baseURL="",r._initTemplate="",r._segmentTemplate="",r._subtitleTemplate="",r._initSegments={},r._hlsURLs=[],r._allowMixedAVC1Codecs=!1,r._initTemplate="",r._isAd=e.isAd||!1,r._mediaType="video",r._resolver=e.resolver,r._videoFormats=e.videoFormats,r._audioFormats=e.audioFormats,r._disallowProfile=e.disallowProfile,r._videoResolution=e.videoResolution,r._allowMixedAVC1Codecs=!!e.allowMixedAVC1Codecs,r._keySystem===rt.FAIRPLAY&&r._audioFormats.unshift({mimeType:"audio/mp2t",codec:"mp4a.40.2"}),r._parseFragmentResponse=r._parseFragmentResponse.bind(y()(r)),r}return h()(n,[{key:"_isQualityMatched",value:function(e,t,n){var r,i,a,o;if(this._videoResolution){var s=null!==(r=this._videoResolution.max)&&void 0!==r?r:Number.MAX_SAFE_INTEGER,c=null!==(i=this._videoResolution.min)&&void 0!==i?i:0;if(n){var l=null!==(a=this._videoResolution.start)&&void 0!==a?a:s;return e.video_resolution<=l}return e.video_resolution>=c&&e.video_resolution<=s}var u=null!==(o=null==t?void 0:t.audio_bitrate)&&void 0!==o?o:0,d=this._abrManager.getBandwidthEstimate();return e.video_bitrate+u<2*d-1e5}},{key:"_updateVariants",value:function(e){var t,n=this._audioProfiles[0];this._audioProfile=null!=n?n:null;var r=this._videoProfiles,i=this._videoProfile,a=null,o=r.length;if(o){for(;o--;){var s=r[o];if(s&&this._isQualityMatched(s,n,!!e)){a=s;break}}a||(a=r[0]),this._videoProfile=a,(null==i?void 0:i.id)!==a.id&&(Dn.log("Video profile changed. ID ".concat(a.id," (").concat(a.video_codec,"), Bitrate ").concat(a.video_bitrate,", ").concat(a.video_width,"x").concat(a.video_height)),null===(t=this._mediator)||void 0===t||t.emit(ot.VIDEO_PROFILE_CHANGED,{profile:{type:"video",mimeType:a.mime_type,codec:a.video_codec,bitrate:a.video_bitrate,height:a.video_height,width:a.video_width}}))}}},{key:"_constructFragmentURL",value:function(e,t,n){if(!t&&!n)throw new Error("Both audioProfile and videoProfile is null");return e.init?this._resolver.getInitSegmentURLs(this._baseURL,this._initTemplate,t,n):this._resolver.getSegmentURLs(this._baseURL,this._segmentTemplate,e.timeStart,t,n)}},{key:"_fetchBufferData",value:function(e,t,n,r){return this._transport.request(e,Object.assign(Object.assign({},xn),{metadata:{timeStart:Date.now(),fragment:t,profile:n,loggingURL:r}})).then(this._parseFragmentResponse)}},{key:"_fetchInitSegmentBuffers",value:function(e,t){var n,r=this._initFragment;if(!r)return Promise.reject(new pt(Q.FILE_NOT_RESOLVED,"Cannot fetch Init Segment buffers: File not resolved."));try{n=this._constructFragmentURL(r,e,t)}catch(l){return Promise.reject(l)}var i=this._initSegments,a=Promise.resolve(null);if(e){var o=i[e.id];(null==o?void 0:o.buffer.byteLength)?a=Promise.resolve(o):(null==n?void 0:n.audio)&&(a=this._fetchBufferData(n.audio,r,e,n.audioLogging).then((function(t){return i[e.id]=t,t})))}var s=Promise.resolve(null);if(t){var c=i[t.id];(null==c?void 0:c.buffer.byteLength)?s=Promise.resolve(c):(null==n?void 0:n.video)&&(s=this._fetchBufferData(n.video,r,t,n.videoLogging).then((function(e){return i[t.id]=e,e})))}return Promise.all([a,s]).then((function(e){var t=se()(e,2);return{audio:t[0],video:t[1]}}))}},{key:"_fetchBufferForFragment",value:function(e,t,n){var r;try{r=this._constructFragmentURL(e,t,n)}catch(i){return Promise.reject(i)}return Promise.all([this._fetchInitSegmentBuffers(t,n),!e.init&&r.audio?this._fetchBufferData(r.audio,e,t,r.audioLogging):null,!e.init&&r.video?this._fetchBufferData(r.video,e,n,r.videoLogging):null]).then((function(t){var n,r,i,a=se()(t,3),o=a[0],s=a[1],c=a[2];return e.init?i={audio:null!==(n=o.audio)&&void 0!==n?n:void 0,video:null!==(r=o.video)&&void 0!==r?r:void 0}:(i={audio:null!=s?s:void 0,video:null!=c?c:void 0},e.cacheBufferSet&&(e.bufferSet=i),i.audio&&(null==o?void 0:o.audio)&&(i.audio.initBuffer=o.audio.buffer),i.video&&(null==o?void 0:o.video)&&(i.video.initBuffer=o.video.buffer)),i})).catch((function(e){return Promise.reject(e)}))}},{key:"_parseFragmentResponse",value:function(e){var t,n,r,i,a=e.metadata,o=a.fragment,s=a.profile,c=a.timeStart,l=a.loggingURL,u=Nn(s),d=function(e){return e?"audio_bitrate"in e?e.audio_bitrate:e.video_bitrate:0}(s),p="video_resolution"in s?s.video_resolution:void 0,_="".concat(o.timeStart,"-").concat(o.timeEnd),f="video_resolution"in s?"video":"audio";switch(e.status){case 0:var h=new _n(Q.FRAGMENT_REQUEST_FAILED_WITH_ZERO,"Request failed with status 0.",0,{time_range:_,mimetype:u,resolution:p,bitrate:d});return null===(t=this._mediator)||void 0===t||t.emit(ot.FRAGMENT_FETCH_ERROR,{media_type:"video",segment_type:f,url:l,start_time:c,init:o.init,error:h}),Promise.reject(h);case 200:case 206:var v=e.body;if(!(null==v?void 0:v.byteLength)){var y=new _n(Q.FRAGMENT_REQUEST_EMPTY_RESPONSE,"Empty response for successful buffer.",e.status,{time_range:_,mimetype:u,resolution:p,bitrate:d});return null===(n=this._mediator)||void 0===n||n.emit(ot.FRAGMENT_FETCH_ERROR,{media_type:"video",segment_type:f,url:l,start_time:c,init:o.init,error:y}),Promise.reject(y)}var g=v.byteLength;this._abrManager.sample(g,Date.now()-c),this._updateVariants();var m=8e3*g/e.timing.completed;return null===(r=this._mediator)||void 0===r||r.emit(ot.FRAGMENT_FETCHED,{media_type:"video",segment_type:f,url:l,init:o.init,byte_length:g,start_time:c,end_time:Date.now(),bandwidth:m}),Promise.resolve({profileId:"".concat(this._fileId,"-").concat(s.id),bufferURL:l,buffer:v,byteStart:0,byteEnd:g-1,mimetype:u,resolution:p,bitrate:d,bandwidth:m})}var E=new _n(Q.FRAGMENT_REQUEST_FAILED_WITH_STATUS,"Buffer request failed with status ".concat(e.status),e.status,{time_range:_,mimetype:u,resolution:p,bitrate:d});return null===(i=this._mediator)||void 0===i||i.emit(ot.FRAGMENT_FETCH_ERROR,{media_type:"video",segment_type:f,url:l,init:o.init,start_time:c,error:E}),Promise.reject(E)}},{key:"_getHLSURLForProfile",value:function(e){for(var t=this._duration,n=this._segmentLength,r=this._segmentTemplate,i=[],a=0;a<t;a+=n){var o=a+n>t?t-a:n,s=r.replace("{{profile_id}}",e.id.toString(10)).replace("{{segment_timestamp}}",a.toString(10)).replace("{{file_type}}",e.file_type);i.push({duration:o,url:"".concat(this._baseURL).concat(s)})}var c=("undefined"==typeof MediaSource?mn:En)({assetID:this._assetId,targetDuration:n,segments:i});return this._hlsURLs.push(c),c}},{key:"_calculateFragments",value:function(e){this._duration=e.end_time_millis/1e3;var t=this._segmentLength;this._initFragment={init:!0,cacheBufferSet:!1,timeStart:-1,timeEnd:-1,byteRanges:{}};for(var n=0;n<this._duration;n+=t)this._fragments.push({cacheBufferSet:!n&&!this._disableCache,timeStart:n,timeEnd:n+t,byteRanges:{}})}},{key:"setVideoResolution",value:function(e){this._videoResolution=Object.assign(Object.assign({},this._videoResolution),e),this._updateVariants()}},{key:"getCurrentBitrate",value:function(){var e,t;return null!==(t=null===(e=this._videoProfile)||void 0===e?void 0:e.video_bitrate)&&void 0!==t?t:0}},{key:"getBufferForFragment",value:function(e){var t;if(!e)return Promise.reject(new TypeError("No fragment provided"));var n=this._audioProfile,r=this._videoProfile;return e.bufferSet&&(!r||(null===(t=e.bufferSet.video)||void 0===t?void 0:t.resolution)&&e.bufferSet.video.resolution>=r.video_resolution)?Promise.resolve(e.bufferSet):this._fetchBufferForFragment(e,null!=n?n:void 0,null!=r?r:void 0)}},{key:"clearCachedBuffers",value:function(){this._initFragment&&(this._initSegments={}),this._fragments.forEach((function(e){e.bufferSet=null}))}},{key:"getDuration",value:function(){return this._endTime}},{key:"getFragmentAfterTime",value:function(e){var t;if(!(null===(t=this._fragments)||void 0===t?void 0:t.length))return null;if(0===e||.01===e)return this._fragments[1];var n,r=In(this._fragments);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.timeStart>e)return i}}catch(a){r.e(a)}finally{r.f()}return null}},{key:"getFragmentForTime",value:function(e){var t;if(!(null===(t=this._fragments)||void 0===t?void 0:t.length))return null;if(0===e||.01===e)return this._fragments[0];var n,r=In(this._fragments);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.timeStart<=e&&i.timeEnd>=e)return i}}catch(a){r.e(a)}finally{r.f()}return null}},{key:"getSubtitleLanguages",value:function(){return this._subtitleLanguages}},{key:"getSubtitles",value:function(){var e=this;return this._subtitleLanguages.map((function(t){return{lang:t,url:e._subtitleTemplate.replace("{{language_code}}",t)}}))}},{key:"load",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{resolveLatency:0,manifestLatency:0};if(this._loaded)return t.resolveLatency=0,t.manifestLatency=0,Promise.resolve(this);if(!this._fileId)throw new TypeError("Missing: provide either fileId or resolvedURL");var n=Date.now();return this._resolver.getManifest(this._fileId,this._noAuth).then((function(r){var i,a,o,s;t.resolveLatency=0,t.manifestLatency=Date.now()-n;var c=r.contents[0];if(!c)return(s=new pt(Q.FILE_MALFORMED_SEEKTABLE,"Malformed seektable: no contents.")).track=e.toLogJSON(),Promise.reject(s);e._resolvedURLs=r.base_urls.slice();var l=dn()(r.base_urls),u=l[0],d=l.slice(1);u&&(e._baseURL=u,e._fallbackURLs=d),e._resolvedURL=e._baseURL,e._initTemplate=r.initialization_template,e._segmentTemplate=r.segment_template,e._segmentLength=c.segment_length;var p=void 0;if(null===(i=c.encryption_infos)||void 0===i?void 0:i.length){for(var _,f=c.encryption_infos,h=e._keySystemSettings.commonName,v=0,y=f.length;v<y;v++){var g=f[v];if(g&&g.key_system===h){p=v,_=g[e._keySystemSettings.pssh_field.video];break}}if(!_)return(s=new pt(Q.FILE_FORMAT_NOT_SUPPORTED,"KeySystem does not support the file format.")).track=e.toLogJSON(),Promise.reject(s);switch(e._keySystemSettings.commonName){case"widevine":case"playready":e._protection="cenc";try{e._psshBox=e._parsePSSHBox(_)}catch(m){return(s=new pt(Q.FILE_MALFORMED_PSSH,"Invalid PSSH value.")).track=e.toLogJSON(),Promise.reject(s)}break;case"fairplay":e._protection="hls",e._psshBox=new Uint8Array([]);try{e._assetId=e._parseAssetID(_)}catch(m){return(s=new pt(Q.FILE_MALFORMED_PSSH,"Invalid PSSH value.")).track=e.toLogJSON(),Promise.reject(s)}break;default:return(s=new pt(Q.FILE_FORMAT_NOT_SUPPORTED,"KeySystem does not support the file format.")).track=e.toLogJSON(),Promise.reject(s)}}return e._endTime=r.end_time_millis,e._videoProfiles=wn({codec:"video_codec",formats:e._videoFormats,profiles:c.profiles,encryptionIndex:p,disallowProfile:e._disallowProfile,preferredKeySystem:e._keySystem,preferredVideoResolution:e._videoResolution,allowMixedAVC1Codecs:e._allowMixedAVC1Codecs}),e._audioProfiles=wn({codec:"audio_codec",formats:e._audioFormats,profiles:c.profiles,encryptionIndex:p,preferredKeySystem:e._keySystem}),e._updateVariants(!0),e._calculateFragments(r),e._subtitleLanguages=r.subtitle_language_codes||[],null===(a=e._mediator)||void 0===a||a.emit(ot.SUBTITLE_LANGUAGES_LOADED,{languages:e._subtitleLanguages}),(null===(o=r.subtitle_base_urls)||void 0===o?void 0:o.length)&&r.subtitle_template?e._subtitleTemplate="".concat(r.subtitle_base_urls[0]).concat(r.subtitle_template):(Dn.info("No subtitles available"),e._subtitleTemplate=""),e}))}},{key:"adaptToBandwidth",value:function(){return this._updateVariants(),Promise.resolve(!0)}},{key:"getResolveLatency",value:function(){}},{key:"getPlayableCodecs",value:function(){var e,t;return[Nn(null!==(e=this._videoProfile)&&void 0!==e?e:void 0),Nn(null!==(t=this._audioProfile)&&void 0!==t?t:void 0)].filter((function(e){return!!e}))}},{key:"getAudioProfile",value:function(){return this._audioProfile}},{key:"getVideoProfile",value:function(){return this._videoProfile}},{key:"getVideoProfiles",value:function(){return this._videoProfiles}},{key:"getHLSURL",value:function(){if(!this._resolvedURL)throw new pt(Q.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");this.releaseHLSURL();var e=[],t=this._audioProfiles[0];t&&e.push('#EXT-X-MEDIA:TYPE=AUDIO,GROUP-ID="audio",LANGUAGE="eng",NAME="English",AUTOSELECT=YES,URI="'.concat(this._getHLSURLForProfile(t),'"'));var n,r=In(this._videoProfiles);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.push("#EXT-X-STREAM-INF:BANDWIDTH=".concat(i.max_bitrate,",RESOLUTION=").concat(i.video_width,"x").concat(i.video_height,',CODECS="').concat((null==t?void 0:t.audio_codec)?"mp4a.40.2, ".concat(i.video_codec):i.video_codec,'"').concat((null==t?void 0:t.audio_codec)?',AUDIO="audio"':"","\n").concat(this._getHLSURLForProfile(i)))}}catch(s){r.e(s)}finally{r.f()}var a="#EXTM3U\n".concat(e.join("\n")),o=("undefined"==typeof MediaSource?gn:yn)(a);return this._hlsURLs.push(o),o}},{key:"releaseHLSURL",value:function(){var e,t=In(this._hlsURLs);try{for(t.s();!(e=t.n()).done;){var n=e.value;URL.revokeObjectURL(n)}}catch(r){t.e(r)}finally{t.f()}this._hlsURLs=[]}},{key:"canLowerBitrate",value:function(){var e,t=this._videoProfiles[0];return(null===(e=this._videoProfile)||void 0===e?void 0:e.id)!==(null==t?void 0:t.id)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(fn);!function(e){e[e.MP3_256=3]="MP3_256",e[e.MP3_320=4]="MP3_320",e[e.MP3_160=5]="MP3_160",e[e.MP3_96=6]="MP3_96",e[e.MP4_128=10]="MP4_128",e[e.MP4_256=11]="MP4_256",e[e.MP4_128_DUAL=12]="MP4_128_DUAL",e[e.MP4_256_DUAL=13]="MP4_256_DUAL",e[e.MP4_128_CBCS=14]="MP4_128_CBCS",e[e.MP4_256_CBCS=15]="MP4_256_CBCS",e[e.MP4_FLAC=17]="MP4_FLAC"}(Mn||(Mn={}));var jn=(Un={},i()(Un,Mn.MP3_256,"audio/mp3"),i()(Un,Mn.MP3_320,"audio/mp3"),i()(Un,Mn.MP3_160,"audio/mp3"),i()(Un,Mn.MP3_96,"audio/mp3"),i()(Un,Mn.MP4_128,'audio/mp4; codecs="mp4a.40.2"'),i()(Un,Mn.MP4_256,'audio/mp4; codecs="mp4a.40.2"'),i()(Un,Mn.MP4_128_DUAL,'audio/mp4; codecs="mp4a.40.2"'),i()(Un,Mn.MP4_256_DUAL,'audio/mp4; codecs="mp4a.40.2"'),i()(Un,Mn.MP4_128_CBCS,'audio/mp4; codecs="mp4a.40.2"'),i()(Un,Mn.MP4_256_CBCS,'audio/mp4; codecs="mp4a.40.2"'),i()(Un,Mn.MP4_FLAC,'audio/mp4; codecs="flac"'),Un);function Bn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function Kn(e,t){return t.hasOwnProperty(e)}var Hn=function(e){m()(n,e);var t=Vn(n);function n(e){var r;if(_()(this,n),(r=t.call(this,e))._lastResolveTimestamp=0,r._profileId="".concat(Date.now()),r._initBufferPromise=null,r._lastFetchedBuffer=null,r._hlsURL=null,r._bypassResolve=!!r._resolvedURL,r._emitWarning=e.emitWarning||function(){},r._mediaType="audio",r._noManifest=!!e.noManifest,r._preloadedManifest=e.preloadedManifest,r._resolver=e.resolver,r._segmentLength=0,r._fileFormat=e.fileFormat,r._fileFormat)r._audioCodec=jn[r._fileFormat];else switch(r._format){case at.MP3:r._audioCodec=jn[Mn.MP3_160];break;case at.MP4:case at.MP4_DUAL:case at.MP4_CBCS:r._audioCodec=jn[Mn.MP4_128];break;default:throw new TypeError("Unknown audio format ".concat(r._format))}return r._fileId&&(r._profileId=r._fileId),r._parseFragmentResponse=r._parseFragmentResponse.bind(y()(r)),r}return h()(n,[{key:"_parseFragmentResponse",value:function(e){var t=this,n=e.metadata,r=n.requestURL,i=n.fragment,a=n.byteRangeHeader,o=n.expectedLength,s="".concat(i.timeStart,"-").concat(i.timeEnd);switch(e.status){case 0:if(e.offline)return Promise.reject(new _n(Q.FRAGMENT_OFFLINE_REQUEST_FAILED_WITH_ZERO,"Request failed with status 0.",0,{time_range:s,byte_range:a}));var c=new _n(Q.FRAGMENT_ONLINE_REQUEST_FAILED_WITH_ZERO,"Request failed with status 0.",0),l=!1;return this._resolvedURL!==r?l=!0:this._fallbackURLs.length&&this._resolvedURL===r&&(l=!0,this._resolvedURL=this._fallbackURLs.shift()),c.debug.has_fallback=l,l?(this._emitWarning(c,this.toLogJSON()),this.getBufferForFragment(i)):Promise.reject(c);case 200:case 206:var u=e.body;if(!u)return Promise.reject(new _n(Q.FRAGMENT_REQUEST_EMPTY_RESPONSE,"Empty response for successful buffer.",e.status,{time_range:s,byte_range:a}));if(u.byteLength!==o)return Promise.reject(new _n(Q.FRAGMENT_REQUEST_UNEXPECTED_LENGTH,"Received buffer of unexpected length.",e.status,{time_range:s,byte_range:a,received_length:u.byteLength,expected_length:o}));var d={audio:{profileId:this._profileId,bufferURL:r,byteStart:i.byteRanges.audio.start,byteEnd:i.byteRanges.audio.end,buffer:u,mimetype:this._audioCodec,bandwidth:8e3*u.byteLength/e.timing.completed}};if(i.cacheBufferSet&&u&&u.byteLength){i.bufferSet=d;var p=i.sliceInto;if(null==p?void 0:p.length){var _,f=Bn(p);try{for(f.s();!(_=f.n()).done;){var h=_.value,v=h.fragment;(null==v?void 0:v.cacheBufferSet)&&(v.bufferSet={audio:Object.assign(Object.assign({},d.audio),{buffer:u.slice(h.start,h.end),byteStart:v.byteRanges.audio.start,byteEnd:v.byteRanges.audio.end})})}}catch(g){f.e(g)}finally{f.f()}}}return this._abrManager.sample(u.byteLength,e.timing.completed),Promise.resolve(d);case 403:return this.resolve().then((function(){return t.getBufferForFragment(i)}));default:var y=!1;return this._resolvedURL!==r?y=!0:this._fallbackURLs.length&&this._resolvedURL===r&&(y=!0,this._resolvedURL=this._fallbackURLs.shift()),y?this.getBufferForFragment(i):Promise.reject(new _n(Q.FRAGMENT_REQUEST_FAILED_WITH_STATUS,"Buffer request failed with status ".concat(e.status),e.status,{time_range:s,byte_range:a}))}}},{key:"_getInitBuffer",value:function(){var e,t;if(!this._initFragment)throw new pt(Q.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");return(null===(t=null===(e=this._initFragment.bufferSet)||void 0===e?void 0:e.audio)||void 0===t?void 0:t.buffer.byteLength)?Promise.resolve(this._initFragment.bufferSet.audio.buffer):(this._initBufferPromise||(this._initBufferPromise=this.getBufferForFragment(this._initFragment).then((function(e){var t;if(!(null===(t=e.audio)||void 0===t?void 0:t.buffer.byteLength))throw new Error("Empty initialization segment buffer");return e.audio.buffer}))),this._initBufferPromise)}},{key:"_calculateFragments",value:function(e){var t=e.offset;this._initFragment={init:!0,cacheBufferSet:!this._disableCache,timeStart:0,timeEnd:0,byteRanges:{audio:{start:0,end:t-1}}};for(var n=e.segments,r=e.timescale,i=n.length,a=new Array(i),o=0,s=0,c=0,l=i;c<l;c++){var u=n[c];if(null==u?void 0:u.length){var d=se()(u,2),p=d[0],_=d[1],f=_/r,h={init:!1,cacheBufferSet:!c&&!this._disableCache,timeStart:o,timeEnd:o+f,byteRanges:{audio:{start:t,end:t+(p-1)}}};a[c]=h,t+=p,s+=_,o+=f,Math.floor(f)>this._segmentLength&&(this._segmentLength=Math.floor(f))}}a[a.length-1].isLastFragment=!0,this._fragments=a,this._duration=s/r}},{key:"_calculateFragmentsV1",value:function(e){var t=e.offset;this._initFragment={init:!0,cacheBufferSet:!this._disableCache,timeStart:0,timeEnd:0,byteRanges:{audio:{start:0,end:t-1}}};for(var n=e.references,r=e.timescale,i=n.length,a=new Array(i),o=0,s=0,c=0,l=i;c<l;c++){var u=n[c];if(u){var d=u.duration/r,p={init:!1,cacheBufferSet:!c&&!this._disableCache,timeStart:s,timeEnd:s+d,byteRanges:{audio:{start:t,end:t+(u.size-1)}}};a[c]=p,t+=u.size,o+=u.duration,s+=d,Math.floor(d)>this._segmentLength&&(this._segmentLength=Math.floor(d))}}a[a.length-1].isLastFragment=!0,this._fragments=a,this._duration=o/r}},{key:"_getManifest",value:function(e){if(this._noManifest)return e&&(e.manifestLatency=0),Promise.resolve(null);if(this._preloadedManifest)return e&&(e.manifestLatency=0),Promise.resolve(this._preloadedManifest);if(!this._fileId)throw new TypeError("Missing: fileId");var t=Date.now();return this._resolver.getManifest(this._fileId).then((function(n){return e&&(e.manifestLatency=Date.now()-t),n}))}},{key:"getHLSURL",value:function(){var e,t,n=this._resolvedURL,r=this._initFragment;if(!n||!r)throw new pt(Q.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");this.releaseHLSURL();var i={url:n,byteStart:null===(e=r.byteRanges.audio)||void 0===e?void 0:e.start,byteEnd:null===(t=r.byteRanges.audio)||void 0===t?void 0:t.end},a=this._fragments.map((function(e){var t,r;return{url:n,duration:e.timeEnd-e.timeStart,byteStart:null===(t=e.byteRanges.audio)||void 0===t?void 0:t.start,byteEnd:null===(r=e.byteRanges.audio)||void 0===r?void 0:r.end}})),o="undefined"==typeof MediaSource?mn:En;return this._hlsURL=o({assetID:this._fileId,targetDuration:10,map:i,segments:a}),this._hlsURL}},{key:"releaseHLSURL",value:function(){this._hlsURL&&URL.revokeObjectURL(this._hlsURL),this._hlsURL=null}},{key:"clearCachedBuffers",value:function(){this._headFragment&&delete this._headFragment,this._initFragment&&(this._initFragment.bufferSet=null),this._fragments[0]&&(this._fragments[0].bufferSet=null),this._lastFetchedBuffer=null}},{key:"getPlayableCodecs",value:function(){return[this._audioCodec]}},{key:"getFirstFragment",value:function(){var e;return null!==(e=this._fragments[0])&&void 0!==e?e:null}},{key:"getHeadFragment",value:function(){var e=this._initFragment,t=this._fragments[0];if(!(null==e?void 0:e.byteRanges.audio)||!(null==t?void 0:t.byteRanges.audio))throw new pt(Q.FILE_NOT_RESOLVED,"Cannot return HLS Manifest URL: File not resolved.");return this._headFragment||(this._headFragment={init:!0,cacheBufferSet:!0,timeStart:0,timeEnd:0,byteRanges:{audio:{start:e.byteRanges.audio.start,end:t.byteRanges.audio.end}},sliceInto:[{fragment:e,start:0,end:t.byteRanges.audio.start},{fragment:t,start:t.byteRanges.audio.start,end:void 0}]}),this._headFragment}},{key:"getFragmentAfterTime",value:function(e){var t,n;if(!(null===(t=this._fragments)||void 0===t?void 0:t.length))return null;if(0===e||.01===e)return null!==(n=this._fragments[1])&&void 0!==n?n:null;var r,i=Bn(this._fragments);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.timeStart>e)return a}}catch(o){i.e(o)}finally{i.f()}return null}},{key:"getFragmentForTime",value:function(e){var t,n;if(!(null===(t=this._fragments)||void 0===t?void 0:t.length))return null;if(0===e||.01===e)return null!==(n=this._fragments[0])&&void 0!==n?n:null;var r,i=Bn(this._fragments);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.timeStart<=e&&a.timeEnd>=e)return a}}catch(o){i.e(o)}finally{i.f()}return null}},{key:"getBufferForFragment",value:function(e){var t,n=this;if(!e)return Promise.reject(new Error("FIXME: error type?"));if((null===(t=this._lastFetchedBuffer)||void 0===t?void 0:t.fragment)===e)return Promise.resolve(this._lastFetchedBuffer.bufferSet);if(e.bufferSet)return Promise.resolve(e.bufferSet);if(!this._resolvedURL)return Promise.reject(new pt(Q.FILE_NOT_RESOLVED,"Cannot fetch buffer: No resolved URL"));var r=e.byteRanges.audio,i="".concat(r.start,"-").concat(r.end),a=r.end+1-r.start,o=this._resolvedURL,s=e.init?Promise.resolve(null):this._getInitBuffer();return Promise.all([s,this._transport.request(o,{method:"GET",responseType:"arraybuffer",headers:{Range:"bytes=".concat(i)},timing:!0,metadata:{requestURL:o,fragment:e,byteRangeHeader:i,expectedLength:a},retry:{condition:function(e,t){if(0===e.status)return e.offline;var n=e.getStatusFamily();return n===t.CONNECTION_ERROR||n===t.SERVER_ERROR||!(n!==t.SUCCESS||!e.body)&&e.body.byteLength!==a}}}).then(this._parseFragmentResponse)]).then((function(t){var r=se()(t,2),i=r[0],a=r[1];return i&&a.audio&&(a.audio.initBuffer=i),n._lastFetchedBuffer={fragment:e,bufferSet:a},a}))}},{key:"resolve",value:function(e){var t=this,n=this._fileId;if(this._bypassResolve)return e&&(e.resolveLatency=0),Promise.resolve({uri:this._resolvedURL,uris:[],protection:this._preloadedManifest||!this._noManifest?"cenc":void 0});if(!n)throw new TypeError("Missing: fileId is required to resolve content URL");clearTimeout(this._lastResolveToken);var r,i=function(){return t._lastResolveTimestamp=Date.now(),t._resolver.getCDNURL(n,t._fileFormat).then((function(n){return e&&(e.resolveLatency=Date.now()-t._lastResolveTimestamp),n}))},a=Date.now()-this._lastResolveTimestamp;return r=a<1001?new Promise((function(e,n){t._lastResolveToken=setTimeout((function(){i().then(e,n)}),1001-a)})):i(),r.then((function(e){t._resolvedURLs=[];var n,r=Bn(e.uris);try{for(r.s();!(n=r.n()).done;){var i=n.value.split("?")[0];t._resolvedURLs.push(i)}}catch(a){r.e(a)}finally{r.f()}return t._fallbackURLs=e.uris,t._resolvedURL=t._fallbackURLs.shift(),e})).catch((function(e){return e&&(e.track=t.toLogJSON()),Promise.reject(e)}))}},{key:"load",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{resolveLatency:0,manifestLatency:0};return this._loaded?(t.resolveLatency=0,t.manifestLatency=0,Promise.resolve(this)):Promise.all([this.resolve(t),this._getManifest(t)]).then((function(t){var n,r,i=se()(t,2),a=i[0],o=i[1];if(e._loaded=!0,!a.protection||!o)return e;if(e._keySystem===rt.INVALID_SPOTIFY_KEY)return e._protection=o.protection||"cenc",e._psshBox=new Uint8Array(0),e;var s=e._keySystemSettings.pssh_field.audio,c=Kn(s,o)?o[s]:null;if(!c&&"pssh_widevine"===s&&"pssh"in o&&(c=null!==(n=o.pssh)&&void 0!==n?n:null),!c)return(r=new pt(Q.FILE_FORMAT_NOT_SUPPORTED,"KeySystem does not support the file format.")).track=e.toLogJSON(),Promise.reject(r);if(e._protection=o.protection||"cenc",e._psshBox=e._parsePSSHBox(c),"segments"in o&&o.segments)e._calculateFragments(o);else{if(!("references"in o)||!o.references)return(r=new pt(Q.FILE_MALFORMED_SEEKTABLE,"Malformed seektable.")).track=e.toLogJSON(),Promise.reject(r);e._calculateFragmentsV1(o)}return e}))}},{key:"adaptToBandwidth",value:function(){return Promise.resolve(!1)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(fn);function Gn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var zn,Qn=xe.P.forTag("playback.content_buffer");function $n(){}!function(e){e[e.AUDIO=10]="AUDIO",e[e.VIDEO=20]="VIDEO"}(zn||(zn={}));var Xn,Zn=function(e){m()(n,e);var t=Wn(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _()(this,n),(r=t.call(this))._mediaSource=null,r._sourceBuffers={},r._appendingFragments=[],r._currentInitSegments={},r._updateQueue=[],r._codecs=[],r._playId=0,r._lastBufferClearTime=Date.now(),r._customSourceBufferParams="",r._codecs=i,r._tracker=e,r._disableBufferAbort=!!a.disableBufferAbort,r._customSourceBufferParams=r._parseCodecParam(a.customSourceBufferParams),r._onSourceOpen=r._onSourceOpen.bind(y()(r)),r._onSourceClose=r._onSourceClose.bind(y()(r)),r.dequeueUpdates=r.dequeueUpdates.bind(y()(r)),a.noInit||r._init(),r}return h()(n,[{key:"_init",value:function(){this._mediaSource=new MediaSource,this._mediaSource.addEventListener(nt.MEDIA_SOURCE_OPEN,this._onSourceOpen),this._mediaSource.addEventListener(nt.MEDIA_SOURCE_CLOSE,this._onSourceClose),this._sourceBuffers={},this._currentInitSegments={}}},{key:"_parseCodecParam",value:function(e){if(!e)return"";var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n]?'="'.concat(e[n],'"'):"";t.push("".concat(n).concat(r))}return t.length?"; ".concat(t.join("; ")):""}},{key:"_onSourceOpen",value:function(){Qn.info("MediaSource opened.");var e=this._mediaSource;if(e&&0===e.sourceBuffers.length&&"open"===e.readyState){Qn.info("Creating source buffers for codecs",this._codecs);var t,n=Gn(this._codecs);try{for(n.s();!(t=n.n()).done;){var r=t.value;this._addSourceBuffer(r)}}catch(i){n.e(i)}finally{n.f()}}this.dequeueUpdates(),this.emit(nt.BUFFER_SOURCE_OPEN,null)}},{key:"_onSourceClose",value:function(){Qn.info("MediaSource closed."),this._destroySourceBuffers(),this.emit(nt.BUFFER_SOURCE_CLOSE,null)}},{key:"_removeAppendingFragment",value:function(e){if(e){var t=this._appendingFragments,n=t.indexOf(e);-1!==n&&t.splice(n,1)}}},{key:"_addSourceBuffer",value:function(e){if(this._mediaSource){var t=this._mediaSource.addSourceBuffer(e+this._customSourceBufferParams);t.addEventListener(nt.SOURCE_BUFFER_UPDATE_END,this.dequeueUpdates),this._sourceBuffers[e]=t}}},{key:"_trackBufferingProgress",value:function(e){e.audio&&e.audio.buffer&&this._tracker.trackBytesDownloaded(e.audio.buffer.byteLength),e.video&&e.video.buffer&&this._tracker.trackBytesDownloaded(e.video.buffer.byteLength)}},{key:"_checkStalling",value:function(e,t,n){var r,i,a,o=t.byteRanges.video?t.byteRanges.video.start:null!==(i=null===(r=t.byteRanges.audio)||void 0===r?void 0:r.start)&&void 0!==i?i:-1;e>9e3&&this.emit(nt.BUFFER_STALLED,{byteStart:o,timeStart:(a=t.timeStart,Math.ceil(1e3*a)),stallAmount:e-9e3,didTimeout:n})}},{key:"_appendBufferData",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();this.emit(nt.BUFFERING_END,null);var i=[];if(e.audio){var a=(0,pe.$)();this.tryUpdate({playId:n,timestamp:r,fragment:t,type:"append",profileId:e.audio.profileId,buffer:e.audio.buffer,initBuffer:e.audio.initBuffer,codec:e.audio.mimetype,init:!!t.init,resolve:a.resolve}),i.push(a.promise),null!==e.audio.bandwidth&&this._tracker.trackBufferURL(e.audio.bufferURL||"",{bandwidth:e.audio.bandwidth||0})}if(e.video){var o=(0,pe.$)();this.tryUpdate({playId:n,timestamp:r,fragment:t,type:"append",profileId:e.video.profileId,buffer:e.video.buffer,initBuffer:e.video.initBuffer,codec:e.video.mimetype,init:!!t.init,resolve:o.resolve}),i.push(o.promise),null!==e.video.bandwidth&&this._tracker.trackBufferURL(e.video.bufferURL||"",{bandwidth:e.video.bandwidth||0})}return Promise.all(i)}},{key:"_appendUpdate",value:function(e){var t,n,r=this,i=this._sourceBuffers[e.codec];if(i&&!i.updating){var a=e.buffer;if(e.fragment.init&&this._currentInitSegments[e.codec]===e.profileId)return null===(t=e.resolve)||void 0===t||t.call(e,!0),void Promise.resolve().then(this.dequeueUpdates);if(e.initBuffer&&e.buffer&&this._currentInitSegments[e.codec]!==e.profileId){var o=new Uint8Array(e.initBuffer.byteLength+e.buffer.byteLength);o.set(new Uint8Array(e.initBuffer),0),o.set(new Uint8Array(e.buffer),e.initBuffer.byteLength),a=o.buffer}try{i.appendBuffer(a)}catch(l){var s=!1;return"QuotaExceededError"===l.name?(Qn.warn("Failed to append buffer: exceeded quota."),s=!0,this.emitSync(nt.BUFFER_QUOTA_EXCEEDED,null)):Qn.warn("Failed to append buffer",l),void new Promise((function(e){s?setTimeout(e,500):e()})).then((function(){r._removeAppendingFragment(e.fragment),r.dequeueUpdates()})).then((function(){e.init&&r._updateQueue.push(e)}))}this._removeAppendingFragment(e.fragment);var c=a.byteLength>e.buffer.byteLength;(e.fragment.init||c)&&(this._currentInitSegments[e.codec]=e.profileId),null===(n=e.resolve)||void 0===n||n.call(e,!0),c?Qn.info("Injected combined init segment and playable segment (".concat(e.codec,", ").concat(e.profileId,")")):e.init&&Qn.info("Injected individual init segment (".concat(e.codec,", ").concat(e.profileId,")"))}else this._updateQueue.push(e)}},{key:"_abortUpdate",value:function(e){"fragment"in e&&this._removeAppendingFragment(e.fragment),e.resolve&&e.resolve(!1),Promise.resolve().then(this.dequeueUpdates)}},{key:"_processUpdate",value:function(e){"end"===e.type?this._endUpdate(e):"duration"===e.type?this._durationUpdate(e):"append"===e.type&&this._appendUpdate(e)}},{key:"_isUpdating",value:function(){if(!this._mediaSource)return!1;for(var e=this._mediaSource.sourceBuffers,t=0,n=e.length;t<n;t++){var r=e[t];if(r&&r.updating)return!0}return!1}},{key:"_endUpdate",value:function(e){this._isUpdating()?this._updateQueue.push(e):this._mediaSource&&"open"===this._mediaSource.readyState&&(this._mediaSource.endOfStream(),e.resolve&&e.resolve(!0))}},{key:"_durationUpdate",value:function(e){this._isUpdating()?this._updateQueue.push(e):(this._mediaSource&&(this._mediaSource.duration=e.duration),e.resolve&&e.resolve(!0))}},{key:"_destroySourceBuffers",value:function(){var e=this._mediaSource;if(e){var t=e.sourceBuffers;if(t.length)for(var n=0,r=t.length;n<r;n++){var i=t[n];if(i){i.removeEventListener("updateend",this.dequeueUpdates);try{e.removeSourceBuffer(i),Qn.info("Removed source buffer")}catch(a){Qn.warn("Failed to remove sourcebuffer",a)}}}this._sourceBuffers={},this._currentInitSegments={}}}},{key:"_endOfStream",value:function(){this._mediaSource&&"ended"!==this._mediaSource.readyState&&this.tryUpdate({playId:this._playId,timestamp:Date.now(),type:"end"})}},{key:"dequeueUpdates",value:function(){var e=this._updateQueue.shift();e&&this.tryUpdate(e)}},{key:"appendFragment",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(-1!==this._appendingFragments.indexOf(t))return Promise.resolve([]);this._appendingFragments.push(t),this.emit(nt.BUFFERING_START,null);var i=Date.now(),a=this._playId,o=e.toLogJSON();return e.getBufferForFragment(t).then((function(e){return n._trackBufferingProgress(e),a!==n._playId?(Qn.info("Append fragment dropped: playId has changed."),[]):(r||n._checkStalling(Date.now()-i,t,!1),n._appendBufferData(e,t,a,i))})).catch((function(e){return n._removeAppendingFragment(t),r||n._checkStalling(Date.now()-i,t,!0),n.emit(nt.BUFFER_APPEND_ERROR,{error:e,canPlayNext:!0,track:o}),Promise.reject(e)}))}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._lastBufferClearTime=Date.now(),this._appendingFragments=[],this._disableBufferAbort)Qn.info("MediaSource abort skipped; action disabled.");else{var t=this._mediaSource;if(t)for(var n=t.sourceBuffers,r=0,i=n.length;r<i;r++){var a=n[r];if("open"===t.readyState&&a)try{a.abort();var o=a.buffered;if(e&&o.length){var s=o.start(0),c=o.end(o.length-1);a.remove(s,c),Qn.info("Cleared buffer range",s,c)}}catch(l){Qn.warn("ContentBuffer.clear failed.",l)}}this._currentInitSegments={}}}},{key:"getMediaSource",value:function(){return this._mediaSource}},{key:"tryUpdate",value:function(e){if(e){if(e.playId!==this._playId)return Qn.info("Try update dropped: playId has changed"),void this._abortUpdate(e);if(e.timestamp<this._lastBufferClearTime)return Qn.info("Try update dropped: update is older than the last clear"),void this._abortUpdate(e);var t=this._mediaSource;t&&"open"!==t.readyState&&"ended"!==t.readyState?this._updateQueue.push(e):this._processUpdate(e)}}},{key:"destroy",value:function(){var e=this._mediaSource;e&&(Qn.info("Source destroyed"),e.removeEventListener("sourceopen",this._onSourceOpen),e.removeEventListener("sourceclose",this._onSourceClose),this._destroySourceBuffers(),this._mediaSource=null)}},{key:"progress",value:function(e,t,n){var r=this._mediaSource;if(r){var i="video"===e.getMediaType()?zn.VIDEO:zn.AUDIO;if("open"===r.readyState||"ended"===r.readyState){var a,o=function(e,t){var n,r=null===(n=e.sourceBuffers[e.sourceBuffers.length-1])||void 0===n?void 0:n.buffered;if(r)for(var i,a,o=0;o<r.length;o++)if(i=r.start(o),a=r.end(o),i<=t&&t<=a)return{start:i,end:a};return null}(r,n);if(o){if(n+i>r.duration)return void("open"===r.readyState&&this._endOfStream());var s=e.getFragmentLength();Math.ceil(n/s)>Math.floor(o.end/s)&&(a=e.getFragmentForTime(n))&&this.appendFragment(e,a,t).catch($n);var c=Math.floor(o.end-n);if(c>i)return;var l=Math.min(e.getFragmentLength(),i-c);if(l<1)return;var u=Math.floor(o.end+l);(a=e.getFragmentForTime(u))?this.appendFragment(e,a,t).catch($n):this._endOfStream()}else if(a=e.getFragmentForTime(n)){if(this.appendFragment(e,a,t).catch($n),a.timeEnd<n+5){var d=e.getFragmentAfterTime(a.timeStart);d?this.appendFragment(e,d,t).catch($n):this._endOfStream()}}else this._endOfStream()}}}},{key:"recreate",value:function(e){this.abort(),this.destroy(),this._codecs=e,this._init()}},{key:"setDuration",value:function(e){this.tryUpdate({playId:this._playId,timestamp:Date.now(),type:"duration",duration:e})}},{key:"setPlayId",value:function(e){this._playId=e}}],[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new n(e,t,r)}}]),n}(ce.vp),Jn=function(){function e(t){if(_()(this,e),this._estimate=0,this._totalWeight=0,t<0)throw new TypeError("Halflife must be set to a positive value.");this._weightingDecrease=Math.exp(Math.log(.5)/t)}return h()(e,[{key:"sample",value:function(e,t){var n=Math.pow(this._weightingDecrease,e),r=t*(1-n)+n*this._estimate;isNaN(r)||(this._estimate=r,this._totalWeight+=t)}},{key:"getEstimate",value:function(){return this._estimate/1-Math.pow(this._weightingDecrease,this._totalWeight)}}]),e}(),er=4e5,tr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er;_()(this,e),this._totalBytes=0,this._overrideBitrate=0,this._currentBandwidth=t,this._short=new Jn(2),this._long=new Jn(5),this._init()}return h()(e,[{key:"_init",value:function(){if("undefined"!=typeof navigator){var e=navigator;e.connection&&e.connection.downlink&&(this._currentBandwidth=1e6*e.connection.downlink,this._onConnectionChange=this._onConnectionChange.bind(this),e.connection.addEventListener("change",this._onConnectionChange))}}},{key:"_onConnectionChange",value:function(e){var t=e.target.downlink||0;this._setBandwidth(t)}},{key:"_setBandwidth",value:function(e){this._currentBandwidth=1e6*e}},{key:"getBandwidthEstimate",value:function(){if(this._overrideBitrate)return this._overrideBitrate;if(this._totalBytes<128e3)return this._currentBandwidth;var e=this._short.getEstimate(),t=this._long.getEstimate();return Math.min(e,t)}},{key:"sample",value:function(e,t){if(!(e<16e3)){var n=t/1e3,r=8*e/n;this._totalBytes+=e,this._short.sample(n,r),this._long.sample(n,r)}}},{key:"overrideBitrate",value:function(e){this._overrideBitrate=e<=0?0:e}}]),e}();function nr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return rr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.SHOWING="showing",e.HIDDEN="hidden"}(Xn||(Xn={}));var ir=Array.prototype.slice,ar="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){return ir.call(e)};function or(e,t){var n,r=nr(ar(e.getElementsByTagName(t)));try{for(r.s();!(n=r.n()).done;){var i=n.value;e.removeChild(i)}}catch(a){r.e(a)}finally{r.f()}}function sr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return cr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function ur(e){var t=e;return{id:t.id,text:t.text}}var dr="visible",pr="hidden",_r=/^[A-Za-z]{2,4}([_-][A-Za-z]{4})?([_-]([A-Za-z]{2}|[0-9]{3}))?$/,fr=function(e){m()(n,e);var t=lr(n);function n(e){var r;return _()(this,n),(r=t.call(this))._isVisible=!1,r._player=null,r._crossOrigin=null,r._currentVideoContent=null,r._unsubscribers=[],r._displayedCues=[],r._deactivateListeners=!1,r._activeLanguage=void 0,r._preferredLanguage=e.language.toLowerCase(),e.deactivateListeners&&(r._deactivateListeners=!0),r._onEnter=r._onEnter.bind(y()(r)),r._onExit=r._onExit.bind(y()(r)),r._onLoadedMetadata=r._onLoadedMetadata.bind(y()(r)),r.setPlayer(e.player),r}return h()(n,[{key:"_subscribeToCueEvents",value:function(e){var t,n=this,r=e.track;if(!r)throw new Error("No track");if(null===(t=r.cues)||void 0===t?void 0:t.length){r.mode=this._isVisible?Xn.SHOWING:Xn.HIDDEN,this._displayedCues=r.activeCues?Array.from(r.activeCues):[],this._emitDisplayedCues();for(var i=function(e){var t=r.cues[e];if(!t)return"continue";t.addEventListener("enter",n._onEnter),t.addEventListener("exit",n._onExit),n._unsubscribers.push((function(){t.removeEventListener("enter",n._onEnter),t.removeEventListener("exit",n._onExit)}))},a=0;a<r.cues.length;a++)i(a)}else{e.addEventListener("load",(function t(){n._subscribeToCueEvents(e),e.removeEventListener("load",t)}))}}},{key:"_unsubscribeFromCueEvents",value:function(){this._unsubscribers.forEach((function(e){return e()})),this._unsubscribers=[]}},{key:"_onEnter",value:function(e){var t=e.target;this._displayedCues.indexOf(t)>-1||(this._displayedCues.push(t),this._emitDisplayedCues())}},{key:"_onExit",value:function(e){var t=e.target,n=this._displayedCues.indexOf(t);n>-1&&(this._displayedCues.splice(n,1),this._emitDisplayedCues())}},{key:"_emitDisplayedCues",value:function(){this.emit(nt.PLAYER_DISPLAYED_CUES_CHANGED,{cues:this._displayedCues.map(ur)})}},{key:"_updateVisibleState",value:function(){var e,t,n=this;if(this._player){var r=this.getActiveLanguage();Array.from(null!==(t=null===(e=this._player)||void 0===e?void 0:e.querySelectorAll("track"))&&void 0!==t?t:[]).forEach((function(e){e.style.visibility=n._isVisible?dr:pr}));for(var i=this._player.textTracks,a=0,o=i.length;a<o;a++){var s=i[a];s&&(s.mode=this._isVisible&&s.language.toLowerCase()===r?Xn.SHOWING:Xn.HIDDEN)}}}},{key:"_updateTextTracks",value:function(){var e=this._player;e&&(e.readyState>=1?this._onLoadedMetadata():this._currentVideoContent&&e.addEventListener(nt.MEDIA_LOADEDMETADATA,this._onLoadedMetadata))}},{key:"_onLoadedMetadata",value:function(){var e=this._player;if(e&&(or(e,"track"),this._currentVideoContent)){e.crossOrigin="anonymous";var t,n=this._updateActiveLanguage(),r=sr(this._currentVideoContent.getSubtitles());try{for(r.s();!(t=r.n()).done;){var i=t.value,a=i.lang,o=i.url,s=a.toLowerCase()===n,c=document.createElement("track");c.label="".concat(a," subtitles"),c.kind="subtitles",c.srclang=a,c.src=o,c.default=s,c.style.visibility=this._isVisible?dr:pr,e.appendChild(c),s&&!this._deactivateListeners&&this._subscribeToCueEvents(c)}}catch(l){r.e(l)}finally{r.f()}}}},{key:"_updateActiveLanguage",value:function(){if(this._player&&this._currentVideoContent){var e,t=this._currentVideoContent.getSubtitleLanguages(),n=this._preferredLanguage.split("-")[0],r=null,i=sr(t);try{for(i.s();!(e=i.n()).done;){var a=e.value.toLowerCase();if(a===this._preferredLanguage)return this._activeLanguage=a,this._activeLanguage;a.split("-")[0]===n&&null===r&&(r=a)}}catch(o){i.e(o)}finally{i.f()}return this._activeLanguage=null!=r?r:"en-us",this._activeLanguage}this._activeLanguage=void 0}},{key:"getActiveLanguage",value:function(){if(this._player&&this._currentVideoContent)return this._activeLanguage}},{key:"setVideoContent",value:function(e){this._unsubscribeFromCueEvents(),this._displayedCues=[],this._currentVideoContent=e,e||this.clear(),this._updateTextTracks()}},{key:"setPlayer",value:function(e){var t,n="VIDEO"===(null==e?void 0:e.tagName)?e:null;this._player!==n&&this.clear(),this._player=n||null,this._crossOrigin=null!==(t=null==n?void 0:n.crossOrigin)&&void 0!==t?t:null,this._updateTextTracks()}},{key:"getAvailableLanguages",value:function(){var e,t;return null!==(t=null===(e=this._currentVideoContent)||void 0===e?void 0:e.getSubtitleLanguages())&&void 0!==t?t:[]}},{key:"setLanguage",value:function(e){if(!e.length)throw new TypeError("Argument `code` must be a non-empty string. Hide subtitles using `hideSubtitles()`.");if(!_r.test(e))throw new TypeError("Argument `code` must be a valid BCP 47 formatted language code");this._preferredLanguage=e.toLowerCase(),this._updateTextTracks()}},{key:"hide",value:function(){this._isVisible=!1,this._updateVisibleState()}},{key:"show",value:function(){this._isVisible=!0,this._updateVisibleState()}},{key:"deactivateListeners",value:function(){this._deactivateListeners||this._player&&(this._deactivateListeners=!0,this._unsubscribeFromCueEvents())}},{key:"activateListeners",value:function(){this._deactivateListeners&&(this._deactivateListeners=!1,this._updateTextTracks())}},{key:"areListenersActivated",value:function(){return!this._deactivateListeners}},{key:"clear",value:function(){var e=this._player;e&&(this._unsubscribeFromCueEvents(),this._currentVideoContent=null,this._displayedCues=[],or(e,"track"),e.removeEventListener(nt.MEDIA_LOADEDMETADATA,this._onLoadedMetadata),e.crossOrigin=this._crossOrigin)}},{key:"visible",value:function(){return this._isVisible}}]),n}(ce.vp);var hr,vr=function(){function e(t){_()(this,e),this.bandwidthEstimator=t.bandwidthEstimator}return h()(e,[{key:"getSample",value:function(e,t){var n,r,i=this.bandwidthEstimator.getBandwidthEstimate(),a=function(e,t){for(var n=e.length,r=0;r<n;r++)if(e.start(r)<=t&&t<=e.end(r))return 1e3*(e.end(r)-t);return 0}(e.buffered,e.currentTime);if(t instanceof Hn){var o=null===(r=null===(n=t.getFirstFragment())||void 0===n?void 0:n.bufferSet)||void 0===r?void 0:r.audio,s=null==o?void 0:o.bitrate;return{bandwidth:i,bufferAvailability:a,audio:{contentType:null==o?void 0:o.mimetype,bitrate:s}}}var c=t.getAudioProfile(),l=t.getVideoProfile(),u=t.getVideoProfiles(),d="getVideoPlaybackQuality"in e?e.getVideoPlaybackQuality():{creationTime:void 0,droppedVideoFrames:void 0,totalVideoFrames:void 0};return{bandwidth:i,bufferAvailability:a,video:{creationTime:d.creationTime,droppedVideoFrames:d.droppedVideoFrames,totalVideoFrames:d.totalVideoFrames,bitrate:null==l?void 0:l.video_bitrate,availableBitrates:u.map((function(e){return e.video_bitrate})),height:null==l?void 0:l.video_height,width:null==l?void 0:l.video_width,resolution:null==l?void 0:l.video_resolution,contentType:Nn(null!=l?l:void 0)},audio:{bitrate:null==c?void 0:c.audio_bitrate,contentType:Nn(null!=c?c:void 0)}}}}],[{key:"create",value:function(t){return new e(t)}}]),e}();function yr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function gr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Er=xe.P.forTag("playback.player"),br=/^blob:/,Sr=(hr={},i()(hr,at.MP4,!0),i()(hr,at.MP4_DUAL,!0),i()(hr,at.MP4_CBCS,!0),i()(hr,at.MP4_FLAC,!0),i()(hr,at.MP3,!1),i()(hr,at.MANIFEST_ID,!1),hr);function Rr(e){return Math.ceil(1e3*e)}function kr(e){return e/1e3}function Pr(e){return document.createElement(e)}var Tr=function(e){m()(n,e);var t=yr(n);function n(e){var r;return _()(this,n),(r=t.call(this))._cubicVolume=!1,r._player=null,r._emeManager=null,r._mediator=new ce.vp,r._currentContent=null,r._upcomingContent=null,r._preloadingTracks={},r._playId=0,r._loaded=!1,r._licenseRequested=!1,r._playerActivated=!1,r._pauseToken=0,r._syntheticEndedToken=0,r._activeCodecs=[],r._playerVolume=1,r._playerSpeed=1,r._fatalOnNextError=!1,r._canPreloadEmitted=!1,r._lastTimeUpdatePostion=0,r._buffering=!1,r._preferredBitrate=0,r._disableLicensePrefetch=!1,r._allowMixedAVC1Codecs=!1,r._disableBufferingBeforeLicense=!1,r._audioResolver=e.audioResolver,r._clearBufferOnSeek=!!e.clearBufferOnSeek,r._createPlayer=e.createPlayer||Pr,r._cubicVolume=e.cubicVolume,r._disableCache=!!e.disableCache,r._licenseURLResolver=e.licenseURLResolver,r._newBufferPerTrack=!!e.newBufferPerTrack,r._newElementPerTrack=!!e.newElementPerTrack,r._newMediaKeysPerTrack=!!e.newMediaKeysPerTrack,r._rebufferOnQuotaExceeded=!!e.rebufferOnQuotaExceeded,r._disableLicensePrefetch=!!e.disableLicensePrefetch,r._synthesizeEnded=!!e.synthesizeEnded,r._tracker=e.tracker,r._transport=e.transport,r._videoPlayerContainer=e.videoPlayerContainer,r._audioPlayerContainer=e.audioPlayerContainer,r._allowMixedAVC1Codecs=e.allowMixedAVC1Codecs,r._videoResolver=e.videoResolver,r._abrManager=new tr,r._emeManager=e.disallowProtectedTracks?null:e.emeManager||null,r._disallowProfile=e.disallowProfile,r._disableBufferingBeforeLicense=!!e.disableBufferingBeforeLicense,r._cache=new ct.z6(e.trackCacheSize||2),r._subtitleManager=new fr({language:e.preferredSubtitleLanguage||navigator.language,player:r._player}),r._videoResolution=e.videoResolution,Er.info("Setting Player track cache to:",e.trackCacheSize||2),r._buffer=Zn.create(r._tracker,void 0,{disableBufferAbort:!!e.disableBufferAbort,reinjectInitsOnAbort:!!e.reinjectInitsOnAbort,noInit:!0,customSourceBufferParams:e.customSourceBufferParams}),r._statistics=vr.create({bandwidthEstimator:r._abrManager}),r._onCanPlay=r._onCanPlay.bind(y()(r)),r._onCanPlayThrough=r._onCanPlayThrough.bind(y()(r)),r._onTimeUpdate=r._onTimeUpdate.bind(y()(r)),r._onDurationChange=r._onDurationChange.bind(y()(r)),r._onPlay=r._onPlay.bind(y()(r)),r._onPlaying=r._onPlaying.bind(y()(r)),r._onPause=r._onPause.bind(y()(r)),r._onSeeking=r._onSeeking.bind(y()(r)),r._onEncrypted=r._onEncrypted.bind(y()(r)),r._onEnded=r._onEnded.bind(y()(r)),r._onError=r._onError.bind(y()(r)),r._onRequiresDuration=r._onRequiresDuration.bind(y()(r)),r._onQuotaExceeded=r._onQuotaExceeded.bind(y()(r)),r._onLoadedMetadata=r._onLoadedMetadata.bind(y()(r)),r._onWaiting=r._onWaiting.bind(y()(r)),r._onFragmentFetched=r._onFragmentFetched.bind(y()(r)),r._onProfileChanged=r._onProfileChanged.bind(y()(r)),r._onPlayedThresholdReached=r._onPlayedThresholdReached.bind(y()(r)),r._onSyntheticEnded=r._onSyntheticEnded.bind(y()(r)),r._onLicenseRequestCapped=r._onLicenseRequestCapped.bind(y()(r)),r._onLicenseRequestError=r._onLicenseRequestError.bind(y()(r)),r._onNavigatorOffline=r._onNavigatorOffline.bind(y()(r)),r._onBufferError=r._onBufferError.bind(y()(r)),r._emitWarning=r._emitWarning.bind(y()(r)),r._handleLoadingComplete=r._handleLoadingComplete.bind(y()(r)),r._onRateChange=r._onRateChange.bind(y()(r)),r._onVideoResize=r._onVideoResize.bind(y()(r)),r._init(),r}return h()(n,[{key:"_init",value:function(){var e,t,n,r,a,o;(this._disableCache&&Er.info("Cache disabled."),this._transport.on(this._transport.EVENT_CONNECTION_OFFLINE,this._onNavigatorOffline),this.proxyEmitAllSync(this._tracker,(e={},i()(e,nt.TRACKER_TRACKING_DATA_CREATED,nt.PLAYER_TRACKING_DATA_CREATED),i()(e,nt.TRACKER_TRACKING_DATA_FINALIZED,nt.PLAYER_TRACKING_DATA_FINALIZED),i()(e,nt.TRACKER_PLAYBACK_START,nt.PLAYER_PLAYBACK_START),e)),this._tracker.on(nt.TRACKER_PLAYED_THRESHOLD_REACHED,this._onPlayedThresholdReached),this._emeManager)&&this._emeManager.addListeners((o={},i()(o,nt.EME_LICENSE_REQUEST_CAPPED,this._onLicenseRequestCapped),i()(o,nt.EME_LICENSE_REQUEST_ERROR,this._onLicenseRequestError),o));this._buffer.addListeners((t={},i()(t,nt.BUFFER_APPEND_ERROR,this._onBufferError),i()(t,nt.BUFFER_QUOTA_EXCEEDED,this._onQuotaExceeded),t)),this.proxyEmitAll(this._buffer,i()({},nt.BUFFER_STALLED,nt.PLAYER_BUFFER_STALLED)),this._mediator.addListeners((n={},i()(n,ot.FRAGMENT_FETCHED,this._onFragmentFetched),i()(n,ot.VIDEO_PROFILE_CHANGED,this._onProfileChanged),n)),this.proxyEmitAll(this._mediator,(r={},i()(r,ot.FRAGMENT_FETCH_ERROR,nt.PLAYER_FRAGMENT_FETCH_ERROR),i()(r,ot.SUBTITLE_LANGUAGES_LOADED,nt.PLAYER_SUBTITLE_LANGUAGES_LOADED),r)),this.proxyEmitSync(this._subtitleManager,nt.PLAYER_DISPLAYED_CUES_CHANGED,nt.PLAYER_DISPLAYED_CUES_CHANGED),this.proxyEmitAll(this._videoResolver,(a={},i()(a,nt.VIDEO_MANIFEST_RESOLVED,nt.PLAYER_VIDEO_MANIFEST_RESOLVED),i()(a,nt.VIDEO_MANIFEST_RESOLVE_FAILED,nt.PLAYER_VIDEO_MANIFEST_RESOLVE_FAILED),a))}},{key:"_onRateChange",value:function(){this._player&&(this._tracker.trackSpeedChanged(this._player.playbackRate),this.emit(nt.PLAYER_PLAYBACK_SPEED_CHANGED,{playback_speed:this._player.playbackRate}))}},{key:"_onLicenseRequestError",value:function(e){if(e.data.playId===this._playId){var t=this._currentContent;if(t){var n=e.data.error;n.shouldRefreshEndpoint&&this._licenseURLResolver.remove(t.getKeySystem(),t.getMediaType()),this._emitError(n,!n.unrecoverable,t.toLogJSON())}}}},{key:"_onFragmentFetched",value:function(e){var t=e.data;this._tracker.setBandwidth(t.bandwidth),this.emit(nt.PLAYER_FRAGMENT_FETCHED,t)}},{key:"_onProfileChanged",value:function(e){var t=e.data;this._tracker.setRenditionCount(t.profile.bitrate),this.emit(nt.PLAYER_VIDEO_PROFILE_CHANGED,t)}},{key:"_onLicenseRequestCapped",value:function(e){e.data.playId===this._playId&&(this._currentContent&&(this.pause(),this.emit(nt.PLAYER_CAPPED,null)))}},{key:"_shouldNextErrorBeFatal",value:function(){var e=this._currentContent;if(!e)return!1;if(e.isAd()||!e.isProtected())return!1;if(!this._player)return!1;var t=this._player.error;if(!(t&&t instanceof MediaError))return this._fatalOnNextError=!1,!1;switch(t.code){case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:case MediaError.MEDIA_ERR_DECODE:return!0;default:return!1}}},{key:"_onNavigatorOffline",value:function(){this._tracker.trackNavigatorOffline()}},{key:"_onBufferError",value:function(e){this._emitError(e.data.error,e.data.canPlayNext,e.data.track)}},{key:"_addPlayerEvents",value:function(e){e.addEventListener(nt.MEDIA_TIMEUPDATE,this._onTimeUpdate),e.addEventListener(nt.MEDIA_PLAY,this._onPlay),e.addEventListener(nt.MEDIA_PLAYING,this._onPlaying),e.addEventListener(nt.MEDIA_PAUSE,this._onPause),e.addEventListener(nt.MEDIA_SEEKING,this._onSeeking),e.addEventListener(nt.MEDIA_ENCRYPTED,this._onEncrypted),e.addEventListener(nt.MEDIA_ENDED,this._onEnded),e.addEventListener(nt.MEDIA_ERROR,this._onError),e.addEventListener(nt.MEDIA_LOADEDMETADATA,this._onLoadedMetadata),e.addEventListener(nt.MEDIA_DURATIONCHANGE,this._onDurationChange),e.addEventListener(nt.MEDIA_WAITING,this._onWaiting),e.addEventListener(nt.MEDIA_CANPLAY,this._onCanPlay),e.addEventListener(nt.MEDIA_CANPLAYTHROUGH,this._onCanPlayThrough),e.addEventListener(nt.MEDIA_RATECHANGE,this._onRateChange),e.addEventListener(nt.INTERNAL_MEDIA_REQUIRES_DURATION,this._onRequiresDuration),e.addEventListener(nt.MEDIA_RESIZE,this._onVideoResize)}},{key:"_removePlayerEvents",value:function(e){e.removeEventListener(nt.MEDIA_TIMEUPDATE,this._onTimeUpdate),e.removeEventListener(nt.MEDIA_PLAY,this._onPlay),e.removeEventListener(nt.MEDIA_PLAYING,this._onPlaying),e.removeEventListener(nt.MEDIA_PAUSE,this._onPause),e.removeEventListener(nt.MEDIA_SEEKING,this._onSeeking),e.removeEventListener(nt.MEDIA_ENCRYPTED,this._onEncrypted),e.removeEventListener(nt.MEDIA_ENDED,this._onEnded),e.removeEventListener(nt.MEDIA_ERROR,this._onError),e.removeEventListener(nt.MEDIA_WAITING,this._onWaiting),e.removeEventListener(nt.MEDIA_CANPLAY,this._onCanPlay),e.removeEventListener(nt.MEDIA_RATECHANGE,this._onRateChange),e.removeEventListener(nt.MEDIA_CANPLAYTHROUGH,this._onCanPlayThrough),e.removeEventListener(nt.MEDIA_LOADEDMETADATA,this._onLoadedMetadata),e.removeEventListener(nt.MEDIA_DURATIONCHANGE,this._onDurationChange),e.removeEventListener(nt.INTERNAL_MEDIA_REQUIRES_DURATION,this._onRequiresDuration),e.removeEventListener(nt.MEDIA_RESIZE,this._onVideoResize)}},{key:"_recreateMediaElement",value:function(e,t,n,r){if(t!==this._playId)return Er.info("Recreate player dropped: playId has changed."),Promise.resolve(!1);var i=this._player;if(i){if(!this._newElementPerTrack&&("AUDIO"!==i.tagName||"video"!==n)){var a,o=!0,s=gr(e);try{for(s.s();!(a=s.n()).done;){var c=a.value;if('audio/mp2t;codecs="mp4a.40.2"'!==c&&!i.canPlayType(c)){o=!1;break}}}catch(_){s.e(_)}finally{s.f()}if(o)return Er.info("Reusing media element."),e.join(",")===this._activeCodecs.join(",")&&!this._newBufferPerTrack||r||(Er.info("Recreating buffer."),this._buffer.recreate(e),this._activeCodecs=e),Promise.resolve(!0)}this._removePlayerEvents(i),i.pause(),this._emeManager&&this._emeManager.removeMediaKeys(i).catch((function(e){Er.warn("Failed to remove media keys.",e)})),this._player=null;var l=this._getContainerElement(this._videoPlayerContainer);l&&i.parentNode===l&&(l.removeChild(i),this.emit(nt.PLAYER_VIDEO_ELEMENT_REMOVED,null));var u=this._getContainerElement(this._audioPlayerContainer);u&&i.parentNode===u&&u.removeChild(i)}Er.info("Creating new media element.");var d=this._createPlayer(n),p=this._playerVolume;return d.volume=this._cubicVolume?p*p*p:p,d.autoplay=!1,d.loop=!1,"playsInline"in d&&(d.playsInline=!0),this._player=d,this._subtitleManager.setPlayer(d),this._playerActivated=!1,this._addPlayerEvents(d),r||this._buffer.recreate(e),this._activeCodecs=e,Promise.resolve(!0)}},{key:"_getContainerElement",value:function(e){return"string"==typeof e?document.querySelector(e):e||null}},{key:"_onVideoResize",value:function(){if(this._player instanceof HTMLVideoElement){var e=this._player,t=e.videoWidth,n=e.videoHeight;this.emit(nt.PLAYER_VIDEO_RESIZED,{width:t,height:n})}}},{key:"_onDurationChange",value:function(){var e=this,t=this._playId,n=function(){if(e._player)if(t===e._playId){var n=Rr(e._player.duration),r=Rr(e._player.currentTime);e._tracker.setActualDuration(n),e.emit(nt.PLAYER_DURATION_CHANGED,{timestamp:Date.now(),position:r,duration:n})}else Er.info("Duration changed drop: playId has changed.")};this._loaded?n():this.once(nt.PLAYER_LOAD,n)}},{key:"_onPlay",value:function(){var e;if(this._player&&this._currentContent){var t=Rr(this._player.currentTime);this._tracker.trackPlay(t,this._player.playbackRate),this.emit(nt.PLAYER_PLAY,{timestamp:Date.now(),position:t,logData:null!==(e=this._currentContent.getLogData())&&void 0!==e?e:null})}}},{key:"_onPlaying",value:function(){if(this._player){this._playerActivated=!0;var e=this._currentContent,t=Rr(this._player.currentTime);this._tracker.trackPlaying(t),this.emit(nt.PLAYER_PLAYING,{timestamp:Date.now(),position:t,logData:e?e.getLogData():null})}}},{key:"_onPause",value:function(){var e=this;if(this._player){var t=Rr(this._player.currentTime);this._tracker.trackPaused(t);var n=this._currentContent?this._currentContent.getLogData():null;this._pauseToken=setTimeout((function(){clearTimeout(e._syntheticEndedToken),e.emit(nt.PLAYER_PAUSED,{position:t,logData:n})}),10)}}},{key:"_onSeeking",value:function(){this.emit(nt.PLAYER_SEEKING,null),this._buffer.abort(this._clearBufferOnSeek),this._lastTimeUpdatePostion=0,this._onTimeUpdate()}},{key:"_onRequiresDuration",value:function(){this._currentContent&&this._currentContent.isProtected()&&this._player&&(this._player.duration=this._currentContent.getCalculatedDuration())}},{key:"_onQuotaExceeded",value:function(){this._player&&this._rebufferOnQuotaExceeded&&(Er.info("Exceeded quota: rebuffering current track."),this._buffer.abort(!0),this._player.currentTime=this._player.currentTime,this._onTimeUpdate())}},{key:"_onEncrypted",value:function(e){Er.info("Got Encrypted event"),this._currentContent&&this.emitSync(nt.INTERNAL_ENCRYPTED,{initData:e.initData,fromPolyfill:!!e.fromPolyfill})}},{key:"_onEnded",value:function(){!this._currentContent||this._synthesizeEnded&&this._currentContent.isProtected()||(Er.info("Native ended emitted."),this._emitEnded())}},{key:"_onSyntheticEnded",value:function(){this._synthesizeEnded&&this._currentContent&&this._currentContent.isProtected()&&(Er.info("Synthetic ended emitted."),this._emitEnded())}},{key:"_onError",value:function(){if(this._player){var e,t,n,r,i=this._player.error,a=!1,o=this._currentContent,s=!1;o&&(a=o.isProtected(),e=o.toLogJSON(),s=o.isAd(),o.clearCachedBuffers());var c=!0,l=!o||s||!this._fatalOnNextError,u=i&&i.msExtendedCode?"0x".concat((i.msExtendedCode>>>0).toString(16).toUpperCase()):null,d="data:".concat((null==e?void 0:e.fileId)||"unknown");if(i instanceof MediaError){switch(i.code){case MediaError.MEDIA_ERR_ABORTED:t=Q.MEDIA_ABORTED,n="Media aborted.";break;case MediaError.MEDIA_ERR_NETWORK:t=Q.MEDIA_NETWORK_ERROR,n="Network error.";break;case MediaError.MEDIA_ERR_DECODE:t=Q.MEDIA_DECODING_ERROR,n="Media decoding error.",c=l;break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:t=Q.MEDIA_NOT_SUPPORTED,n="Media not supported.",c=l;break;default:t=Q.PLAYER_MEDIA_ERROR,n="Media error.",r=!0}var p=i.message||u||d||i.toString();n+=" (".concat(p,")")}else t=Q.PLAYER_PLAYBACK_ERROR,n="Error message undefined",r=!0;this._buffer.abort(!0);var _=new ut(t,n);c||(_.unrecoverable=!0),_.listPlayerIgnore=s,_.debug.src_url=d,_.debug.protected=a,_.debug.extendedCode=u,_.debug.rawExCode=i&&i.msExtendedCode||null,r&&i&&(_.debug.nativeCode=i.code||null,_.debug.errorData=i),this._emitError(_,c,e)}}},{key:"_onLoadedMetadata",value:function(){this.emitSync(nt.INTERNAL_PLAYER_LOADED_METADATA,null)}},{key:"_onCanPlay",value:function(){this._buffering=!1,this.emitSync(nt.INTERNAL_PLAYER_CANPLAY,null),this.emit(nt.PLAYER_FIRST_BYTES,null)}},{key:"_onCanPlayThrough",value:function(){this.emitSync(nt.INTERNAL_PLAYER_CANPLAYTHROUGH,null)}},{key:"_onWaiting",value:function(){var e=this;clearTimeout(this._syntheticEndedToken);var t=this._player;if(t&&this._currentContent){var n=t.seeking;this._buffering=!0;var r=this._currentContent.canLowerBitrate(),i=this._tracker;this.emit(nt.PLAYER_BUFFERING_START,Object.assign({position:Rr(t.currentTime),msPlayed:this._tracker.getMSPlayed(),canLowerBitrate:r,seeking:n},i.getStallsInformation())),this._getBufferingLatency().then((function(a){n||e._tracker.trackMsStalled(a),e.emit(nt.PLAYER_BUFFERING_END,Object.assign({position:Rr(t.currentTime),msPlayed:e._tracker.getMSPlayed(),canLowerBitrate:r,msStalled:a,seeking:n},i.getStallsInformation()))}))}}},{key:"_onPlayedThresholdReached",value:function(e){this._currentContent&&this._player&&this.emit(nt.PLAYER_PLAYED_THRESHOLD_REACHED,{played:e.data.played,threshold:e.data.threshold,position:Rr(this._player.currentTime)})}},{key:"_emitEnded",value:function(){this._currentContent&&"video"===this._currentContent.getMediaType()&&this.emit(nt.PLAYER_ENDED_VIDEO,null),clearTimeout(this._pauseToken),this.emit(nt.PLAYER_ENDED,null)}},{key:"_emitError",value:function(e,t,n){Er.error("Player Error",e,n,t),this._tracker.setHadError(!0),!this._disableCache&&n&&n.fileId&&this._cache.remove(n.fileId),this.emit(nt.PLAYER_ERROR,{playId:this._playId,error:e,track:n,canPlayNext:t,position:this._player?Rr(this._player.currentTime):0})}},{key:"_emitWarning",value:function(e,t){Er.error("Player Warning",e,t,!0),this._tracker.trackWarning(),this.emit(nt.PLAYER_WARNING,{playId:this._playId,error:e,track:t,canPlayNext:!0,position:this._player?Rr(this._player.currentTime):0})}},{key:"_prepareMediaElement",value:function(e,t){var n=this;return t===this._playId&&this._upcomingContent?this._recreateMediaElement(this._upcomingContent.getPlayableCodecs(),t,this._upcomingContent.getMediaType(),this._upcomingContent.getKeySystem()===rt.FAIRPLAY).then((function(r){var i;if(!r||t!==n._playId)return Er.info("Loading content dropped after recreate: playId has changed."),Promise.resolve(!1);n._player.playbackRate=(null===(i=n._loadingOptions)||void 0===i?void 0:i.useDefaultPlaybackSpeed)?1:n._playerSpeed;var a=n._player;return"VIDEO"===(null==a?void 0:a.tagName)&&(e.poster?a.poster=e.poster:a.removeAttribute("poster")),a&&n._upcomingContent&&n._upcomingContent.isProtected()&&n._emeManager&&(!a.mediaKeys||a.mediaKeys.shouldRefreshPerTrack||n._newMediaKeysPerTrack)?(Er.info("Creating media keys"),n._emeManager.createMediaKeys(a).then((function(){return!0})).catch((function(e){return e.unrecoverable=!0,n._emitError(e,!1,n._upcomingContent?n._upcomingContent.toLogJSON():void 0),Promise.reject(e)}))):Promise.resolve(!0)})):(Er.info("Loading content dropped: playId has changed."),Promise.resolve(!1))}},{key:"_handleLoadingComplete",value:function(e){var t=this._currentContent&&this._currentContent.getMediaType(),n=this._getContainerElement("video"===t?this._videoPlayerContainer:this._audioPlayerContainer);return n&&this._player&&this._player.parentNode!==n&&(n.appendChild(this._player),"video"===t&&this.emit(nt.PLAYER_VIDEO_ELEMENT_APPENDED,null)),this._upcomingContent=null,e}},{key:"_handleLoadingError",value:function(e,t,n,r){if(this._upcomingContent=null,n!==this._playId)return Promise.resolve(!1);if(this._tracker.trackLoadFailed(),this.emit(nt.PLAYER_LOADING_FAILED,{uri:e,logData:t.logData}),r){var i=r.track||{uri:e,fileId:t.fileId,format:t.format,deviceId:t.logData.deviceId};this._emitError(r,"StorageError"!==r.name||!!r.canPlayNext,i)}return Promise.reject(r)}},{key:"_handleLoadedMetadata",value:function(e,t,n){var r=this;if(e===this._playId){this._loaded=!0;var i=this._player;if(i){this._buffer.dequeueUpdates();var a=n.position>i.duration?0:n.position;this._lastTimeUpdatePostion=0,i.currentTime<a&&(Er.info("Resetting initial position after metadata."),i.currentTime=a),this._tracker.trackLoadDone(Rr(i.currentTime)),this.emitSync(nt.PLAYER_LOAD,{autoplay:n.autoplay,position:Rr(a),logData:t}),Promise.resolve().then((function(){r._onTimeUpdate()}));var o=function(){i.currentTime<a&&(Er.info("Resetting initial position after playable."),i.currentTime=a)};n.autoplay&&!i.error&&(o=function(){(i.currentTime<a&&(Er.info("Resetting initial position after playable."),i.currentTime=a),r._playId===e)?new Promise((function(e){return e(r._player&&r._player.play())})).catch((function(e){if(e){if("NotSupportedError"===e.name)return Promise.reject(e);if("NotAllowedError"===e.name)return r.emit(nt.PLAYER_AUTOPLAY_FAILED,null),Promise.reject(e)}return r._player?r._player.play():Promise.resolve()})).catch((function(){r._onPause()})):Er.info("Play trigger dropped; different playId")}),i.readyState>2?(Er.info("Ready to play, triggering play."),o()):(Er.info("Waiting to be playable."),this.once(nt.INTERNAL_PLAYER_CANPLAY,o))}}else Er.info("LoadedMetadata operations dropped: playId has changed.")}},{key:"_handleCanPlayThrough",value:function(e){e===this._playId?this._tracker.trackCanPlayThrough():Er.info("CanPlayThrough operations dropped: playId has changed.")}},{key:"_loadContent",value:function(e,t){var n=this;if(t!==this._playId||!this._upcomingContent)return Er.info("Loading content dropped: playId has changed."),Promise.resolve(!1);if(!this._player)throw new ut(Q.PLAYER_INVALID_INTERNAL_STATE,"Cannot load content without an HTMLMediaElement");this._canPreloadEmitted=!1;var r=this._upcomingContent;this._upcomingContent=null,this._currentContent=r,this._subtitleManager.setVideoContent(r instanceof Fn?r:null);var i=e.callback;i&&this.once(nt.PLAYER_LOAD,(function(){n._playId&&t===n._playId?i():Er.info("Load content event dropped: playId has changed.")})),this.once(nt.INTERNAL_PLAYER_LOADED_METADATA,this._handleLoadedMetadata.bind(this,t,this._currentContent.getLogData(),e)),this.once(nt.INTERNAL_PLAYER_CANPLAYTHROUGH,this._handleCanPlayThrough.bind(this,t));var a=e.position,o=r.getCalculatedDuration();o&&a>o&&(a=e.position=0);try{this._player.currentTime=a}catch(c){Er.warn("Cannot set initial position before loading.",c)}var s=r.isProtected();return this._tracker.setProtected(s),r.getKeySystem()===rt.FAIRPLAY?r instanceof Hn&&!s?Promise.resolve(this._loadUnprotectedTrack()):Promise.resolve(this._loadHLSProtectedTrack(e,t)):r instanceof Fn?this._loadVideoTrack(e,t):s?this._loadProtectedTrack(e,t):Promise.resolve(this._loadUnprotectedTrack())}},{key:"_getBufferingLatency",value:function(){var e=this;return new Promise((function(t){if(e._player){var n=Date.now();e._player.addEventListener("canplaythrough",(function e(){this.removeEventListener("canplaythrough",e),t(Date.now()-n)}))}else t(0)}))}},{key:"_loadVideoTrack",value:function(e,t){var n=this;if(!(this._player&&this._currentContent&&this._currentContent instanceof Fn))return Promise.resolve(!1);var r=this._currentContent;Er.info("_loadVideoTrack");var i=function(){n._currentContent&&n._currentContent.isProtected()&&n._requestLicense(t).then((function(){n._playId===t&&(n._licenseRequested=!0,n._disableBufferingBeforeLicense&&n._onTimeUpdate())}))};this._disableLicensePrefetch?this.once(nt.INTERNAL_ENCRYPTED,i):this._buffer.once(nt.BUFFER_SOURCE_OPEN,i),this._player.src=URL.createObjectURL(this._buffer.getMediaSource());var a=r.getVideoProfile(),o=r.getAudioProfile();return o||a?(this._tracker.trackVideoLoadStart({bitrate:null==a?void 0:a.video_bitrate,audioProfile:null!=o?o:void 0,videoProfile:null!=a?a:void 0}),this._tracker.trackBufferLoadStart(),this._buffer.appendFragment(r,r.getInitFragment()).then((function(){return n._buffer.setDuration(r.getCalculatedDuration())})).then(this._onAppendedHeadSegment(t))):Promise.resolve(!1)}},{key:"_loadHLSProtectedTrack",value:function(e,t){var n=this;if(Er.info("Load HLS Protected Track"),!this._player||!this._currentContent)return!1;var r=this._currentContent.getResolvedURL();if(!r)throw new pt(Q.FILE_NOT_RESOLVED,"Cannot load HLS protected track: File not resolved.");this.on(nt.INTERNAL_ENCRYPTED,(function e(r){r.data.fromPolyfill&&(n.removeListener(nt.INTERNAL_ENCRYPTED,e),n._requestLicense(t,{initData:r.data.initData}))}));var i=this._currentContent;if(i instanceof Fn){var a=i.getVideoProfile(),o=i.getAudioProfile();this._tracker.trackVideoLoadStart({bitrate:null==a?void 0:a.video_bitrate,audioProfile:null!=o?o:void 0,videoProfile:null!=a?a:void 0})}this._tracker.trackBufferLoadStart(),this._tracker.trackBufferURL(r,{bandwidth:0});var s=document.createElement("source");return s.src=this._currentContent.getHLSURL(),s.type=hn,this._player.appendChild(s),this._player.load(),!0}},{key:"_loadUnprotectedTrack",value:function(){if(!this._player||!this._currentContent)return!1;var e=this._currentContent.getResolvedURL();return!!e&&(Er.info("_loadUnprotectedTrack",this._currentContent.getURI()),this._tracker.trackBufferLoadStart(),this._tracker.trackBufferURL(e,{bandwidth:0}),this._player.src=e,this._player.load(),!0)}},{key:"_onAppendedHeadSegment",value:function(e){var t=this;return function(){return e===t._playId&&(t._player&&t._player.spload&&t._player.spload(),Er.info("Head segment appended."),!0)}}},{key:"_loadProtectedTrack",value:function(e,t){var n=this;if(!(this._currentContent&&this._player&&this._currentContent instanceof Hn))return Promise.resolve(!1);var r=this._currentContent;Er.info("_loadProtectedTrack",r.getURI());var i=function(){return n._requestLicense(t).then((function(){n._playId===t&&(n._licenseRequested=!0,n._disableBufferingBeforeLicense&&n._onTimeUpdate())}))};this._disableLicensePrefetch?this.once(nt.INTERNAL_ENCRYPTED,i):this._buffer.once(nt.BUFFER_SOURCE_OPEN,i),this._player.src=URL.createObjectURL(this._buffer.getMediaSource()),this._tracker.trackBufferLoadStart();var a=r.getFragmentForTime(e.position),o=null;return a===r.getFirstFragment()?(Er.info("Appending combined init and playable fragment."),o=this._buffer.appendFragment(r,r.getHeadFragment())):(Er.info("Appending split init and playable fragment."),o=this._buffer.appendFragment(r,a)),o.then(this._onAppendedHeadSegment(t)).then((function(){return Promise.resolve(t===n._playId)}))}},{key:"_requestLicense",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this._playId){var r="Request license dropped: playId has changed.";return Er.info(r),Promise.resolve(!1)}if(!this._player||!this._currentContent||!this._emeManager)return Promise.resolve(!1);var i,a=Date.now(),o=this._player.mediaKeys,s=this._currentContent,c=s.getFileId(),l=s.getLogData(),u=s.toLogJSON(),d=s.getKeySystem(),p=s.getLicenseEndpoint();if(p)i=Promise.resolve(p);else{if(!c)return Promise.reject(new TypeError("Missing: fileId or licenseEndpoint"));i=this._licenseURLResolver.get(d,s.getMediaType()).then((function(e){return e.replace(/\{contentId\}/,c)}))}var _=this._emeManager,f=this._tracker;return f.setKeySystem(d),f.setKeySystemImpl(_.getKeySystemImpl()),Promise.all([i,s.getInitParams()]).then((function(t){var r=se()(t,2),i=r[0],s=r[1];f.setLicenseSessionLatency(Date.now()-a);var c=s.initDataType,l=n.initData||s.initData;if(o&&l&&c){var u=Object.assign(Object.assign({},s),{playId:e,initData:l,mediaKeys:o,licenseServer:i,initDataType:c});return _.createSessionWithParams(u)}return Promise.resolve(!1)})).then((function(n){if(e!==t._playId)return Er.info("License tracking dropped: playId has changed."),Promise.resolve(!1);"boolean"!=typeof n&&"elapsed"in n&&(f.setLicenseGenerationLatency(n.elapsed.generate),f.setLicenseRequestLatency(n.elapsed.request),f.setLicenseUpdateLatency(n.elapsed.update));var r=Date.now()-a;return f.setKeyLatency(r),t.emit(nt.PLAYER_KEY_RECEIVED,{requestTime:r,logData:l}),Er.info("License updated."),Promise.resolve(!0)})).catch((function(n){if(!n||e!==t._playId)return Promise.resolve(!1);var r=!n||!("canPlayNext"in n)||n.canPlayNext;return t._emitError(n,r,u),Promise.reject(n)}))}},{key:"_onTimeUpdate",value:function(){var e;if(this._loaded&&(null===(e=this._player)||void 0===e?void 0:e.readyState)&&this._currentContent){var t=this._currentContent,n=this._player.seeking,r=this._player.currentTime,i="video"===t.getMediaType();if(t.isProtected()&&this._disableBufferingBeforeLicense&&!this._licenseRequested)Er.log("Dropping time update event: buffering before license disabled.");else if(n||!this._lastTimeUpdatePostion||this._lastTimeUpdatePostion!==r){this._lastTimeUpdatePostion=n?0:r,t.getKeySystem()!==rt.FAIRPLAY&&(i||t.isProtected())&&this._buffer.progress(t,n,r);var a=this._player.duration,o=Rr(r),s=t.getLogData();n?(this._tracker.trackPositionChanged(o),this.emit(nt.PLAYER_POSITION_CHANGED,{position:o,logData:s})):(this._tracker.trackProgress(o,"getCurrentBitrate"in t?t.getCurrentBitrate():0),this.emit(nt.PLAYER_PROGRESS,{timestamp:Date.now(),position:o,played:this._tracker.getMSPlayed(),interval:500,logData:s})),!this._canPreloadEmitted&&a-r<=10?(this._canPreloadEmitted=!0,this.emit(nt.PLAYER_CAN_PRELOAD,null)):this._canPreloadEmitted=!1,clearTimeout(this._syntheticEndedToken),this._synthesizeEnded&&t.isProtected()&&this._isPlaying()&&(this._syntheticEndedToken=setTimeout(this._onSyntheticEnded,Rr(a-r)))}else Er.warn("Dropping duplicate time update.")}}},{key:"_isPlaying",value:function(){return!!this._player&&!this._player.paused}},{key:"_createAudioContent",value:function(e,t){var n=this,r={manifestLatency:0,resolveLatency:0};return(this._emeManager?this._emeManager.getKeySystemInfo():Promise.resolve({keySystem:rt.INVALID_SPOTIFY_KEY})).then((function(i){return Hn.create({abrManager:n._abrManager,mediator:n._mediator,keySystem:i.keySystem,licenseEndpoint:t.licenseEndpoint,transport:n._transport,resolver:n._audioResolver,uri:e,fileId:t.fileId,fileFormat:t.fileFormat,format:t.format,isAd:t.isAd,resolvedURL:t.resolvedURL,noManifest:t.noManifest,preloadedManifest:t.preloadedManifest,logData:t.logData,disableCache:n._disableCache,emitWarning:n._emitWarning}).load(r)})).then((function(e){var i=n._tracker;return i.setResolveLatency(r.resolveLatency),i.setManifestLatency(r.manifestLatency),e.isProtected()&&t.fileId&&!n._disableCache&&n._cache.set(t.fileId,e),e}))}},{key:"_createVideoContent",value:function(e,t){var n=this,r={manifestLatency:0,resolveLatency:0},i=t.fileId;return(this._emeManager?this._emeManager.getKeySystemInfo():this.getMediaConfig().then((function(e){return{keySystem:rt.INVALID_SPOTIFY_KEY,audioFormats:e.formatsInfo.audio,videoFormats:e.formatsInfo.video}}))).then((function(a){return Fn.create({uri:e,abrManager:n._abrManager,mediator:n._mediator,resolver:n._videoResolver,keySystem:a.keySystem,licenseEndpoint:t.licenseEndpoint,fileId:i,noAuth:t.noAuth,format:at.MANIFEST_ID,isAd:t.isAd,transport:n._transport,videoFormats:a.videoFormats,videoResolution:n._videoResolution,audioFormats:a.audioFormats,disableCache:n._disableCache,disallowProfile:n._disallowProfile,allowMixedAVC1Codecs:n._allowMixedAVC1Codecs}).load(r)})).then((function(e){var t=n._tracker;return t.setResolveLatency(r.resolveLatency),t.setManifestLatency(r.manifestLatency),e.isProtected()&&i&&!n._disableCache&&n._cache.set(i,e),e}))}},{key:"_preinitMediaElement",value:function(){var e=this;return this._player||!this._emeManager?Promise.resolve(this):this._emeManager.getKeySystemInfo().then((function(t){var n,r,i=[];return(null===(n=t.audioFormats)||void 0===n?void 0:n[0])&&i.push(t.audioFormats[0].contentType),(null===(r=t.videoFormats)||void 0===r?void 0:r[0])&&i.push(t.videoFormats[0].contentType),!!i.length&&e._recreateMediaElement(i,e._playId,i.length>1?"video":"audio",t.keySystem!==rt.FAIRPLAY)})).then((function(){return e}),(function(t){return Er.warn("Cannot precreate media element:",null==t?void 0:t.message),e}))}},{key:"getCodecInfo",value:function(){return{audiocodec:"mp3",bitrate:160}}},{key:"getMediaSource",value:function(){return this._buffer.getMediaSource()}},{key:"load",value:function(e,t,n){var r,i=this,a=function(e,t){return t&&t.hasOwnProperty(e)}(t.uriProperty,e)?t.uriProperty:"uri",o=e[a];if(Er.info("load",o),!o)return Promise.reject(new ut(Q.PLAYER_CANNOT_FIND_PLAYABLE_URI,"Cannot find a playable URI."));if(!e.logData)return Promise.reject(new Error("Invalid track: logging info not specified"));this.stop(e.logData,e.mediaType),this._loaded=!1,this._licenseRequested=!1,this._buffering=!0,this._currentContent=null,this._subtitleManager.setVideoContent(null);var s,c=++this._playId,l=this._tracker;l.trackLoadStart(o,e.fileId,c.toString(),e.logData,e.metadata),this.emit(nt.PLAYER_BEFORE_LOAD,{track:e,options:t,logData:e.logData,uri:o,timestamp:Date.now()}),this._buffer.setPlayId(c),this._loadingOptions={position:kr(t.position||0),autoplay:!("autoplay"in t)||t.autoplay,poster:e.poster,useDefaultPlaybackSpeed:!!(null===(r=e.options)||void 0===r?void 0:r.useDefaultPlaybackSpeed),callback:n},l.setPlayIntended(this._loadingOptions.autoplay),l.setPlayedThreshold(t.playedThreshold);var u=this._cache,d="video"===e.mediaType?this._createVideoContent.bind(this,o,e):this._createAudioContent.bind(this,o,e,c);if(e.fileId){var p=e.fileId,_=this._preloadingTracks[p],f=this._disableCache?null:u.get(p);_?(Er.info("Waiting for preloading track.",p),s=_.then((function(e){return Er.info("Preloading succeeded.",p),l.setResolveLatency(e.resolveLatency),l.setManifestLatency(e.manifestLatency),u.get(p)}),(function(){return Er.info("Preloading failed, creating new track",p),d()}))):f?(Er.info("Using cached track.",p,f),l.setMemoryCached(!0),s=Promise.resolve(f)):(Er.info("Creating new track from fileId",p),s=d())}else Er.info("Creating new track without fileId",e.resolvedURL),s=d();return s.then((function(t){return t.isProtected()&&!i._emeManager?Promise.reject(new ut(Q.DISALLOW_PROTECTED_TRACK_ERROR,"Protected tracks not supported")):(t.setLogData(e.logData),l.setCalculatedDuration(Rr(t.getCalculatedDuration())),i._upcomingContent=t,Promise.resolve())})).then(this._prepareMediaElement.bind(this,this._loadingOptions,c)).then(this._loadContent.bind(this,this._loadingOptions,c)).then(this._handleLoadingComplete,this._handleLoadingError.bind(this,o,e,c))}},{key:"preload",value:function(e){var t=this,n=!this._disableCache,r=e.uri,i=e.fileId,a=this._cache;if(!n||!i||!this._emeManager)return Promise.resolve(null);var o="video"===e.mediaType;if(!(Sr[e.format]&&!o)||a.get(i))return Promise.resolve(null);var s=this._preloadingTracks,c=s[i];if(c)return c;Er.info("Preloading track",i);var l={manifestLatency:0,resolveLatency:0},u=this._emeManager.getKeySystemInfo().then((function(n){return Hn.create({abrManager:t._abrManager,keySystem:n.keySystem,licenseEndpoint:e.licenseEndpoint,transport:t._transport,resolver:t._audioResolver,uri:r,fileId:i,format:e.format,fileFormat:e.fileFormat,isAd:e.isAd,resolvedURL:e.resolvedURL,noManifest:e.noManifest,preloadedManifest:e.preloadedManifest,logData:e.logData,disableCache:t._disableCache,emitWarning:t._emitWarning}).load(l)})).then((function(t){return Promise.all([t,"MP4_CBCS"!==e.format?t.getBufferForFragment(t.getHeadFragment()):null])})).then((function(e){var t=se()(e,1)[0];return a.set(i,t),delete s[i],Er.info("Cached",i),l})).catch((function(e){return delete s[i],Er.warn("Preloading error",e),t.emit(nt.PLAYER_PRELOADING_ERROR,{error:e,track:e.track||null,canPlayNext:!("canPlayNext"in e)||e.canPlayNext,preloading:!0}),Promise.reject(e)}));return s[i]=u,u}},{key:"togglePlay",value:function(){return this._isPlaying()?this.pause():this.resume()}},{key:"setSubtitleLanguage",value:function(e){this._subtitleManager.setLanguage(e)}},{key:"getSubtitleLanguages",value:function(){return this._subtitleManager.getAvailableLanguages()}},{key:"getActiveSubtitleLanguage",value:function(){return this._subtitleManager.getActiveLanguage()}},{key:"deactivateCueEvents",value:function(){this._subtitleManager.deactivateListeners()}},{key:"activateCueEvents",value:function(){this._subtitleManager.activateListeners()}},{key:"setVolume",value:function(e,t){if(!this.emitSync(nt.PLAYER_BEFORE_VOLUME_CHANGE,{volume:e,options:t}).defaultPrevented){if(e<0||e>1)throw new ut(Q.PLAYER_ATTEMPTED_VOLUME_OUT_OF_RANGE,"Volume should be in range [0, 1]");this._playerVolume=e,this._player&&(this._player.volume=this._cubicVolume?e*e*e:e)}}},{key:"getVolume",value:function(){return this._playerVolume}},{key:"getPlayerState",value:function(){var e,t,n,r=this._player,i=this._currentContent,a={src:(null==r?void 0:r.src)?"data:".concat((null==i?void 0:i.getFileId())||"unknown"):void 0,height:(null==r?void 0:r.clientWidth)||0,width:(null==r?void 0:r.clientHeight)||0},o={};if(i){var s=i.getPlayableCodecs(),c=se()(s,2),l=c[0],u=c[1];o.audio_format=l,o.video_format=u,i instanceof Fn&&r instanceof HTMLVideoElement&&(o.video_height=r.videoHeight,o.video_width=r.videoWidth,a.poster=r.poster)}return{playing:null!==(e=!(null==r?void 0:r.paused))&&void 0!==e&&e,position:r?Rr(r.currentTime):0,duration:r?Rr(r.duration):0,volume:null!==(t=this._playerVolume)&&void 0!==t?t:1,playback_speed:null!==(n=null==r?void 0:r.playbackRate)&&void 0!==n?n:0,buffering:this._buffering,media_type:(null==i?void 0:i.getMediaType())||null,media_info:o,player_element:a}}},{key:"getPlayerPosition",value:function(){return this._player?Rr(this._player.currentTime):0}},{key:"seek",value:function(e){var t=this;if(this._player){var n=this._playId,r=function(){if(t._player&&n===t._playId){var r=kr(e);r<0?r=0:r>=t._player.duration&&(r=t._player.duration),t._player.currentTime=r}else Er.info("Seek dropped: playId has changed.")};this._loaded?r():this.once(nt.PLAYER_LOAD,r),this._getBufferingLatency().then((function(e){t._tracker.trackSeekRebuffering(e)}))}}},{key:"pause",value:function(){var e=this;return new Promise((function(t){e._player&&e._isPlaying()?t(e._player&&e._player.pause()):t()}))}},{key:"resume",value:function(){var e=this;return new Promise((function(t){e._player&&!e._isPlaying()?t(e._player&&e._player.play()):t()}))}},{key:"stop",value:function(e,t){var n,r=[],i=e||{};this.emit(nt.PLAYER_BEFORE_STOP,{timestamp:Date.now(),logData:i}),this._tracker.trackStopped(this._player?Rr(this._player.currentTime):-1,e,this.getStatistics()||void 0),this._buffer.abort(!0),this._emeManager&&r.push(this._emeManager.destroySessions());var a=this._player;if(a){this._subtitleManager.clear(),this._fatalOnNextError=this._shouldNextErrorBeFatal(),this._fatalOnNextError&&Er.warn("MediaError detected: next immediate media error will be fatal.");var o=a.src;if(o)br.test(o)&&URL.revokeObjectURL(o),a.removeAttribute("src");else{var s=ar(a.getElementsByTagName("source"));Er.info("HTMLSourceElements to removed: ".concat(s.length));var c,l=gr(s);try{for(l.s();!(c=l.n()).done;){var u=c.value;a.removeChild(u)}}catch(_){l.e(_)}finally{l.f()}Er.info("Releasing HLS URLs"),null===(n=this._currentContent)||void 0===n||n.releaseHLSURL()}a.load()}if(this._currentContent&&this._disableCache&&this._currentContent.clearCachedBuffers(),a&&this._currentContent&&"video"===this._currentContent.getMediaType()){var d=this._getContainerElement(this._videoPlayerContainer);d&&a.parentNode===d&&(this._newElementPerTrack||"video"!==t)&&(this._subtitleManager.setPlayer(null),d.removeChild(a),this.emit(nt.PLAYER_VIDEO_ELEMENT_REMOVED,null))}else if(a&&this._currentContent&&"audio"===this._currentContent.getMediaType()){var p=this._getContainerElement(this._audioPlayerContainer);p&&a.parentNode===p&&(this._newElementPerTrack||"audio"!==t)&&p.removeChild(a)}return this.emit(nt.PLAYER_STOPPED,null),Promise.all(r).then((function(){return!0}))}},{key:"hideSubtitles",value:function(){this._subtitleManager.hide()}},{key:"showSubtitles",value:function(){this._subtitleManager.show()}},{key:"areSubtitlesShown",value:function(){return this._subtitleManager.visible()}},{key:"getKeySystemInfo",value:function(){return this._emeManager?this._emeManager.getKeySystemInfo():Promise.resolve(null)}},{key:"getVideoVariants",value:function(){if(!(this._currentContent&&this._currentContent instanceof Fn))return[];var e,t=[],n=gr(this._currentContent.getVideoProfiles());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push({width:r.video_width,height:r.video_height,bitrate:r.video_bitrate})}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"setPreferredBitrate",value:function(e){return"number"!=typeof e?Promise.resolve(it.INVALID):(this._preferredBitrate=e,this._currentContent&&"video"===this._currentContent.getMediaType()&&e>0&&this._buffer.abort(!0),this._abrManager.overrideBitrate(e),Promise.resolve(it.SUCCESS))}},{key:"getCurrentBandwidth",value:function(){return this._abrManager.getBandwidthEstimate()}},{key:"setBackgrounded",value:function(e){this._abrManager.overrideBitrate(e?1e-32:this._preferredBitrate)}},{key:"setVideoResolution",value:function(e){this._videoResolution=Object.assign(Object.assign({},this._videoResolution),e),this._currentContent instanceof Fn&&this._currentContent.setVideoResolution(this._videoResolution)}},{key:"activateElement",value:function(){return!(this._playerActivated||!this._player||this._player.src)&&(this._player.load(),this._playerActivated=!0,!0)}},{key:"getMediaConfig",value:function(){var e=this;return void 0===this._mediaConfig?function(e,t){var n=t||document.createElement("video"),r=function(e){n.canPlayType("audio/mp3")&&(e.formats.audio.push("audio/mp3"),e.formatsInfo.audio.push({mimeType:"audio/mp3",codec:"mp3",contentType:'audio/mp3; codecs="mp3"'}),e.supports.unprotected_audio=!0)};if(e)return e.getKeySystemInfo().then((function(e){var t=e.audioFormats,n=e.videoFormats,i={supports:{protected_audio:!!t.length,unprotected_audio:!0,protected_video:!!n.length,unprotected_video:!0},formats:{audio:t.map((function(e){return e.contentType})),video:n.map((function(e){return e.contentType}))},formatsInfo:{audio:be()(t),video:be()(n)}};return i.keysystem=e.keySystem,i.keysystem_impl=e.keySystemImpl,r(i),i}));var i="undefined"!=typeof window&&window.MediaSource?function(e){return MediaSource.isTypeSupported(e)}:function(e){return"probably"===n.canPlayType(e)||"probably"===n.canPlayType(e.split(";")[0])},a=Xt([zt[0]],i),o=[],s=[],c=[],l=[];if(a){var u,d=a.audioCapabilities,p=a.videoCapabilities,_=gr(d);try{for(_.s();!(u=_.n()).done;){var f=u.value;o.push(f.contentType),c.push(Jt(f.contentType))}}catch(m){_.e(m)}finally{_.f()}var h,v=gr(p);try{for(v.s();!(h=v.n()).done;){var y=h.value;s.push(y.contentType),l.push(Jt(y.contentType))}}catch(m){v.e(m)}finally{v.f()}}var g={supports:{protected_audio:!1,unprotected_audio:!!o.length,protected_video:!1,unprotected_video:!!s.length},formats:{audio:o,video:s},formatsInfo:{audio:c,video:l}};return r(g),Promise.resolve(g)}(this._emeManager,this._player).then((function(t){return e._mediaConfig=t,e._mediaConfig})):Promise.resolve(this._mediaConfig)}},{key:"setPlaybackSpeed",value:function(e){var t;return!(!Number.isFinite(e)||e<=0)&&(!(null===(t=this._loadingOptions)||void 0===t?void 0:t.useDefaultPlaybackSpeed)&&(this._playerSpeed=null!=e?e:1,this._player&&(this._player.playbackRate=this._playerSpeed,this._tracker.trackSpeedChanged(this._playerSpeed)),!0))}},{key:"getStatistics",value:function(){return this._player&&this._currentContent?this._statistics.getSample(this._player,this._currentContent):null}}],[{key:"create",value:function(e){var t=Object.assign({},e);return e.disallowProtectedTracks?n.createWithOptions(t):ln.create({transport:e.transport,disallowRobustnessValues:e.disallowRobustnessValues,disallowCodecs:e.disallowCodecs,noServerCertificate:e.noServerCertificate,precacheServerCertificate:e.precacheServerCertificate,unauthServerCertificateBase:e.unauthServerCertificateBase,preferredKeySystems:e.preferredKeySystems}).then((function(e){t.emeManager=e;var r=new n(t);return t.preinitMediaElement?r._preinitMediaElement():r})).catch((function(r){if(e.enableWithoutEME)return n.createWithOptions(t);throw r}))}},{key:"createWithOptions",value:function(e){return new Promise((function(t){var r=new n(e);t(e.preinitMediaElement?r._preinitMediaElement():r)}))}}]),n}(ce.vp);function Ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Cr=function(e){m()(n,e);var t=Ar(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).debug={},i.name="LoggingError",i.message=r,i.code=e,i}return h()(n)}(ve()(Error));const wr="7.18.1-5339452",Ir="7.18.1";function Lr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Or(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Or(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Or(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Nr=xe.P.forTag("playback.logger"),Mr=function(e){m()(n,e);var t=Dr(n);function n(e){var r;return _()(this,n),(r=t.call(this))._currentTrackingData=null,r._sequenceId=0,r._sequenceSessionStorage={},r._sessionId="0",r._transport=e.transport,r._logSender=e.logSender,r._player=e.player,r._init(),r}return h()(n,[{key:"_init",value:function(){var e=this._player;e.on(nt.PLAYER_LOAD,this._onPlayerLoad.bind(this)),e.on(nt.PLAYER_ERROR,this._onError.bind(this,!1)),e.on(nt.PLAYER_WARNING,this._onError.bind(this,!0)),e.on(nt.PLAYER_PRELOADING_ERROR,this._onError.bind(this,!1)),e.on(nt.PLAYER_TRACKING_DATA_CREATED,this._onTrackingDataCreated.bind(this)),e.on(nt.PLAYER_TRACKING_DATA_FINALIZED,this._onTrackingDataFinalized.bind(this)),e.on(nt.PLAYER_PLAYBACK_START,this._onPlaybackStart.bind(this))}},{key:"_emitError",value:function(e,t){this.emit(nt.LOGGER_ERROR,{error:e,trackingData:t})}},{key:"_onError",value:function(e,t){var n,r,i,a=t.data,o=this._currentTrackingData;if(o&&!o.noLog){var s=a.error,c=null!==(n=null==s?void 0:s.debug)&&void 0!==n?n:{};c.position="position"in a?a.position:0;var l={track:a.track||{},debug:c,preloading:"preloading"in a&&!!a.preloading,session_id:this._sessionId,playback_id:o.playbackId||null,player_play_id:"playId"in a?a.playId:null,http_status_code:null!==(r=null==s?void 0:s.status)&&void 0!==r?r:null,license_server:null!==(i=null==s?void 0:s.licenseServer)&&void 0!==i?i:null};this._logError(s.code||Q.UNKNOWN,s,l,o,e)}}},{key:"_onPlayerLoad",value:function(e){var t=e.data.logData;if(t)if(t.impressionURLs){var n,r=Lr(t.impressionURLs);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._logImpression(i)}}catch(a){r.e(a)}finally{r.f()}}else t.impressionURL&&this._logImpression(t.impressionURL)}},{key:"_onPlaybackStart",value:function(e){var t=e.data.trackingData;t.noLog||t.noStats||this._logPlaybackStart(t)}},{key:"_onTrackingDataCreated",value:function(e){var t=e.data.trackingData;t.noLog?this._currentTrackingData=null:(this._currentTrackingData=t,this._setSessionId(),t.noTSV||this._setSequenceId())}},{key:"_setSessionId",value:function(){this._sessionId=this._transport.getInitTime().toString()}},{key:"_setSequenceId",value:function(){this._sessionId&&(this._sequenceId=this._getSequenceId(this._sessionId))}},{key:"_onTrackingDataFinalized",value:function(e){var t=e.data.trackingData;if(!t.noLog){var n=this._sessionId!==this._transport.getInitTime().toString();if(n&&this._setSessionId(),t.playbackId&&!t.noTSV){if(n&&this._setSequenceId(),!t.playIntended&&!t.played)return void this._rollbackSequenceId(this._sessionId);this._logTrackStreamVerification(t)}t.noStats||this._logPlaybackStats(t)}}},{key:"_logTrackStreamVerification",value:function(e){var t=this,n={play_track:e.currentTrackUri,playback_id:e.playbackId,ms_played:e.msPlayed,ms_nominal_played:e.msNominalPlayed,session_id:this._sessionId,sequence_id:this._sequenceId,next_playback_id:e.nextPlaybackId};Nr.debug("Logged TrackStreamVerification",n),this._logSender.logTrackStreamVerification(n).catch((function(r){var i=new Cr(Q.TSV_SENDING_FAILED,r.message||"Unknown reason.");t._logError(i.code,r,n,e,!1),t._emitError(i,e)}))}},{key:"_logPlaybackStats",value:function(e){var t=this,n={play_track:e.currentTrackUri,file_id:e.fileId,playback_id:e.playbackId,internal_play_id:e.internalPlayId,memory_cached:e.memoryCached,persistent_cached:e.persistentCached,audio_format:e.audiocodec||"",video_format:e.videocodec||"",manifest_id:e.fileId,protected:!1,key_system:e.keySystem,key_system_impl:e.keySystemImpl,urls_json:JSON.stringify(e.urls),start_time:e.loadTime,end_time:e.stopTime,external_start_time:e.externalLoadTime,ms_play_latency:e.msPlayLatency,ms_init_latency:e.msInitLatency,ms_head_latency:e.msHeadLatency,ms_manifest_latency:e.msManifestLatency,ms_resolve_latency:e.msResolveLatency,ms_license_session_latency:e.msLicenseSessionLatency,ms_license_generation_latency:e.msLicenseGenerationLatency,ms_license_request_latency:e.msLicenseRequestLatency,ms_license_update_latency:e.msLicenseUpdateLatency,ms_played:e.msPlayed,ms_nominal_played:e.msNominalPlayed,ms_file_duration:e.msFileDuration,ms_actual_duration:e.msActualDuration,ms_start_position:e.startPosition,ms_end_position:e.position,ms_seek_rebuffer:e.msSeekRebuffering,ms_seek_rebuffer_longest:e.maxMsSeekRebuffering,ms_stall_rebuffer:e.msStalled,ms_stall_rebuffer_longest:e.maxMsStalled,n_stalls:e.nStalls,n_rendition_upgrade:e.nRenditionUpgrade,n_rendition_downgrade:e.nRenditionDowngrade,bps_bandwidth_max:e.bpsBandwidthMax,bps_bandwidth_min:e.bpsBandwidthMin,bps_bandwidth_avg:e.bpsBandwidthAvg,n_seekback:e.nSeeksBackward,n_seekforward:e.nSeeksForward,start_bitrate:e.startBitrate||e.bitrate||0,audio_quality:e.audioQuality,time_weighted_bitrate:e.timeWeightedBitrate,reason_start:e.reasonStart,reason_end:e.reasonEnd,initially_paused:!e.playIntended,had_error:e.hadError,n_warnings:e.nWarnings,n_navigator_offline:e.nOffline,session_id:this._sessionId,sequence_id:this._sequenceId,client_id:e.clientId,correlation_id:e.correlationId,n_dropped_video_frames:e.droppedVideoFrames,n_total_video_frames:e.totalVideoFrames};Nr.info("Logging PlaybackStats"),this._logSender.logJSSDKPlaybackStats(n).catch((function(r){var i=new Cr(Q.PLAYBACK_STATS_SENDING_FAILED,r.message||"Unknown reason.");t._logError(i.code,r,n,e,!1),t._emitError(i,e)}))}},{key:"_logPlaybackStart",value:function(e){var t=this,n={play_track:e.currentTrackUri,file_id:e.fileId,playback_id:e.playbackId,session_id:this._sessionId,ms_start_position:e.startPosition,initially_paused:!e.playIntended,client_id:e.clientId,correlation_id:e.correlationId};Nr.info("Logging PlaybackStart"),this._logSender.logJSSDKPlaybackStart(n).catch((function(r){var i=new Cr(Q.PLAYBACK_START_SENDING_FAILED,r.message||"Unknown reason.");t._logError(i.code,r,n,e,!1),t._emitError(i,e)}))}},{key:"_getSequenceId",value:function(e){var t=this._sequenceSessionStorage[e];return t||(t=0),t+1>=9007199254740991&&(t=0),this._sequenceSessionStorage[e]=t+1,t}},{key:"_rollbackSequenceId",value:function(e){var t=this._sequenceSessionStorage[e];t&&(this._sequenceSessionStorage[e]=Math.max(t-1,0))}},{key:"_logImpression",value:function(e){this._transport.request(e,{forget:!0}).catch((function(e){Nr.warn("Unable to send impression request",e)}))}},{key:"_logError",value:function(e,t,n,r,i){var a="";t&&((a=t.stack||"")||(a=t.toString()));var o={source:"playback",source_version:wr||je.eV.UNKNOWN,type:e||je.eV.UNKNOWN,message:t&&t.message||je.eV.EMPTY,stack:JSON.stringify(a),json_data:JSON.stringify(n||{}),json_data_version:"1.0.0",client_id:r.clientId,correlation_id:r.correlationId};i?this._logSender.logJSSDKWarning(o).catch((function(e){return Nr.warn("Failed to log warning",o,e)})):this._logSender.logJSSDKError(o).catch((function(e){return Nr.warn("Failed to log error",o,e)}))}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp);function Ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var xr=function(e){m()(n,e);var t=Ur(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q.STORAGE_ERROR,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Storage Error";return _()(this,n),(e=t.call(this,i)).status=-1,e.fileId="",e.debug={},e.canPlayNext=!0,e.code=r,e.message=i,e.name="StorageError",e}return h()(n)}(ve()(Error)),Fr=xe.P.forTag("playback.storage_resolve"),jr=function(){function e(t){_()(this,e),this._transport=t}return h()(e,[{key:"_parseResponse",value:function(e,t){var n,r;if(200!==t.status)return(r=new xr(Q.STORAGE_FAILED_WITH_STATUS,"Storage Resolve responded with ".concat(t.status))).status=t.status,r.fileId=e,Promise.reject(r);var i=t.body;if(!(null===(n=null==i?void 0:i.cdnurl)||void 0===n?void 0:n.length))return(r=new xr(Q.STORAGE_RETURNED_NO_TRACKS,"Storage Resolve returned no tracks for fileId ".concat(e))).fileId=e,Promise.reject(r);var a={uri:i.cdnurl[0],uris:i.cdnurl,protection:"cenc"};return Promise.resolve(a)}},{key:"getCDNURL",value:function(e,t){Fr.info("Requesting CDN URL for ",e);var n="files/audio/interactive",r=t?"v2/".concat(n,"/").concat(t,"/").concat(e):"".concat(n,"/").concat(e),i="@webgate/storage-resolve/".concat(r,"?").concat("version=10000000&product=9&platform=39&alt=json");return this._transport.request(i,{responseType:"json",retry:{condition:function(e,t){return e.getStatusFamily()!==t.SUCCESS}}}).then(this._parseResponse.bind(this,e))}},{key:"getManifest",value:function(e){var t="".concat("https://seektables.scdn.co/seektable","/").concat(e,".json");return Fr.info("Requesting JSON manifest for ",e),this._transport.request(t,{responseType:"json",retry:{condition:function(e,t){return e.getStatusFamily()!==t.SUCCESS}}}).then((function(t){var n;return 200!==t.status?((n=new xr(Q.STORAGE_TRACK_MANIFEST_FAILED,"Track manifest request failed with status code ".concat(t.status))).debug.file_id=e,n.status=t.status,Promise.reject(n)):t.body?t.body:((n=new xr(Q.STORAGE_TRACK_MANIFEST_EMPTY,"Received empty manifest.")).debug.file_id=e,n.status=t.status,Promise.reject(n))}))}}]),e}();function Br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Yr=function(e){m()(n,e);var t=Br(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).debug={},i.name="TrackingError",i.message=r,i.code=e,i}return h()(n)}(ve()(Error)),Vr=(n(4678),n(6977),function(){function e(){_()(this,e),this._version="1.0.0",this._map={}}return h()(e,[{key:"clear",value:function(){this._map={}}},{key:"track",value:function(e,t){var n=this._map[e];n||(n={url:e,segments:0,bandwidths:[],totalBandwidth:0},this._map[e]=n),n.segments+=1,n.bandwidths.push(t.bandwidth),n.totalBandwidth+=t.bandwidth}},{key:"toJSON",value:function(){var e=[];for(var t in this._map)if(this._map[t]){var n=this._map[t];n&&e.push({url:t,segments:n.segments,avg_bw:parseFloat((n.totalBandwidth/n.bandwidths.length).toFixed(7))})}return{version:this._version,urls:e}}}]),e}()),Kr=function(){function e(){_()(this,e),this._bitrates={},this._isFinalized=!1,this._needsEndSegment=!1,this._segments=[],this._cdnURLTracker=new Vr,this._currentSpeed=1,this.audiocodec=null,this.bitrate=0,this.audioQuality=void 0,this.bufferingPercentage=0,this.bufferLoadStartTime=0,this.urls={},this.currentTrackUri="",this.displayTrack="",this.externalLoadTime=0,this.fileId="",this.gaiaDevId="none",this.hadError=!1,this.internalPlayId="",this.isProtected=!1,this.keySystem="",this.keySystemImpl="",this.lastPlayPosition=-1,this.loadTime=0,this.localTimeMs=-1,this.maxContinuous=0,this.maxMsSeekRebuffering=0,this.maxMsStalled=0,this.memoryCached=!1,this.msActualDuration=0,this.msFileDuration=0,this.msHeadLatency=0,this.msInitLatency=0,this.msKeyLatency=0,this.msLicenseGenerationLatency=0,this.msLicenseRequestLatency=0,this.msLicenseSessionLatency=0,this.msLicenseUpdateLatency=0,this.msManifestLatency=0,this.msPlayed=0,this.msNominalPlayed=0,this.msPlayedUnion=0,this.msPlayLatency=0,this.msResolveLatency=0,this.msSeekRebuffering=0,this.msSeeksBackward=0,this.msSeeksForward=0,this.nextPlaybackId="",this.nOffline=0,this.noLog=!1,this.noTSV=!1,this.noStats=!1,this.nWarnings=0,this.msStalled=0,this.nSeeksBackward=0,this.nSeeksForward=0,this.nSpeedChanges=!1,this.nStalls=0,this.nRenditionUpgrade=0,this.nRenditionDowngrade=0,this.bpsBandwidthMax=0,this.bpsBandwidthMin=0,this.bpsBandwidthAvg=0,this.nBandwidthSamples=0,this.totalBandwidth=0,this.lastVideoProfileBitrate=0,this.persistentCached=!1,this.playbackId="",this.playContext="",this.played=!1,this.position=0,this.reasonEnd="unknown",this.reasonStart="unknown",this.referrer="unknown",this.referrerVendor="unknown",this.referrerVersion="unknown",this.sourceEnd="unknown",this.sourceStart="unknown",this.startPosition=0,this.stopTime=0,this.streamingRule="none",this.timeWeightedBitrate=0,this.totalBytes=0,this.playIntended=!1,this.videocodec=null,this.clientId="unknown",this.correlationId="unknown",this.droppedVideoFrames=0,this.totalVideoFrames=0}return h()(e,[{key:"_calculateUnion",value:function(){for(var e=this._segments.slice(0),t=0,n=0,r=0,i=0,a=0,o=0,s=this.maxContinuous;a<e.length;a++)a%2!=0&&void 0!==e[a-1]&&"start"===e[a-1].type&&(s=(o=e[a].time-e[a-1].time)>s?o:s);for(this.maxContinuous=s,e.sort((function(e,t){return e.time-t.time}));i<e.length;i++)"start"===e[i].type&&(0===n&&(r=i),++n),"end"===e[i].type&&0===--n&&(t+=e[i].time-e[r].time);return t}},{key:"_calculateWeightedBitrate",value:function(e){var t=this._bitrates,n=0;for(var r in t)r&&t.hasOwnProperty(r)&&e>0&&(n+=parseInt(r,10)*t[r]/e);return Math.round(n)}},{key:"registerVideoVariant",value:function(e){var t=e.bitrate;t&&(this._bitrates[t]=this._bitrates[t]||0,this.startBitrate||(this.startBitrate=t)),e.audioProfile&&e.audioProfile.audio_codec&&(this.audiocodec=e.audioProfile.audio_codec),e.videoProfile&&e.videoProfile.video_codec&&(this.lastVideoProfileBitrate=e.videoProfile.video_bitrate,this.videocodec=e.videoProfile.video_codec)}},{key:"addStartSegment",value:function(){this._segments.push({type:"start",time:this.position}),this._needsEndSegment=!0}},{key:"addEndSegment",value:function(){this._needsEndSegment&&(this._segments.push({type:"end",time:this.position}),this._needsEndSegment=!1)}},{key:"addMSPlayed",value:function(e){if(e){if(e<0)throw new TypeError("Cannot add negative msPlayed value: ".concat(e));this.msPlayed+=e/this._currentSpeed,this.msNominalPlayed+=e}}},{key:"addSpeedChange",value:function(e){this.nSpeedChanges=!0,this._currentSpeed=e}},{key:"trackBitrate",value:function(e,t){var n=e||"dummy";this._bitrates[n]=this._bitrates[n]||0,this._bitrates[n]+=t}},{key:"trackBufferURL",value:function(e,t){this._cdnURLTracker.track(e,t)}},{key:"finalize",value:function(){var e;if(this._isFinalized)throw new Yr(Q.TRACK_DATA_ALREADY_FINALIZED,"TrackData already finalized.");this.msPlayedUnion=this._calculateUnion(),this.nSeeksBackward||this.nSeeksForward||this.nSpeedChanges||(this.msNominalPlayed=this.maxContinuous=this.msPlayedUnion,this.msPlayed=this.msNominalPlayed/this._currentSpeed,this.nSpeedChanges=!1);var t=this.msPlayed;return this.timeWeightedBitrate=this._calculateWeightedBitrate(t),this.bufferingPercentage=this.msStalled/t,this.startBitrate||(this.startBitrate=this.bitrate),this.bpsBandwidthAvg=null!==(e=this.totalBandwidth/this.nBandwidthSamples)&&void 0!==e?e:0,this.urls=this._cdnURLTracker.toJSON(),this._isFinalized=!0,!0}},{key:"getURLsJSON",value:function(){var e,t;return null!==(t=null===(e=this._cdnURLTracker.toJSON().urls)||void 0===e?void 0:e.map((function(e){return e.url})))&&void 0!==t?t:[]}},{key:"getPlaybackStats",value:function(){var e;switch(this.keySystem){case rt.WIDEVINE:e="widevine";break;case rt.PLAYREADY:case rt.PLAYREADY_HARDWARE:e="playready";break;default:e="none"}return{ms_total_est:this.msActualDuration,ms_manifest_latency:this.msManifestLatency,ms_latency:this.msPlayLatency,start_offset_ms:this.startPosition,ms_initial_buffering:this.msPlayLatency,ms_seek_rebuffering:this.msSeekRebuffering,ms_stalled:this.msStalled,max_ms_seek_rebuffering:this.maxMsSeekRebuffering,max_ms_stalled:this.maxMsStalled,n_stalls:this.nStalls,n_rendition_upgrade:this.nRenditionUpgrade,n_rendition_downgrade:this.nRenditionDowngrade,bps_bandwidth_max:this.bpsBandwidthMax,bps_bandwidth_min:this.bpsBandwidthMin,bps_bandwidth_avg:this.bpsBandwidthAvg,audiocodec:this.audiocodec?this.audiocodec.toLowerCase():void 0,videocodec:this.videocodec?this.videocodec.toLowerCase():void 0,start_bitrate:this.startBitrate||this.bitrate||void 0,full_screen:void 0,time_weighted_bitrate:this.timeWeightedBitrate,buffering_percentage:void 0,prefetched_bytes:void 0,prefetched_bytes_loaded:void 0,prefetched_initial_bitrate:void 0,key_system:e,ms_key_latency:this.msKeyLatency,total_bytes:this.totalBytes,local_time_ms:this.localTimeMs,ms_played_background:void 0,n_dropped_video_frames:this.droppedVideoFrames,n_total_video_frames:this.totalVideoFrames}}},{key:"isFinalized",value:function(){return this._isFinalized}}],[{key:"create",value:function(){return new e}}]),e}();function Hr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Gr=xe.P.forTag("playback.tracker"),qr=31e3,Wr=function(e){m()(n,e);var t=Hr(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _()(this,n),(e=t.call(this))._playedThreshold=qr,e._playedThresholdReached=!1,e._trackingData=null,e._playedThreshold=r.playerThreshold||qr,e}return h()(n,[{key:"_checkPlayedThreshold",value:function(){var e=this._trackingData;!e||!this._playedThreshold||this._playedThresholdReached||e.msPlayed<this._playedThreshold||(this._playedThresholdReached=!0,this.emit(nt.TRACKER_PLAYED_THRESHOLD_REACHED,{played:e&&e.msPlayed||0,threshold:this._playedThreshold}))}},{key:"getMSPlayed",value:function(){return this._trackingData?this._trackingData.msPlayed:0}},{key:"getStallsInformation",value:function(){return this._trackingData?{nStalls:this._trackingData.nStalls,msTotalStalled:this._trackingData.msStalled}:{nStalls:0,msTotalStalled:0}}},{key:"trackLoadStart",value:function(e,t,n,r,i){var a=Kr.create();this._trackingData=a,this._playedThresholdReached=!1,a.fileId=null!=t?t:"",a.currentTrackUri=e,a.loadTime=Date.now(),a.internalPlayId=n,a.externalLoadTime=r.externalLoadTime||0,a.displayTrack=r.displayTrack||"",a.playbackId=r.playbackId||"",a.playContext=r.playContext||"",a.reasonStart=r.reason||"unknown",a.sourceStart=r.source||"unknown",a.clientId=r.clientId||"",a.correlationId=r.correlationId||"";var o=r.referrer||{};a.referrer=void 0!==o.name?o.name:"unknown",a.referrerVersion=void 0!==o.version?o.version:"unknown",a.referrerVendor=void 0!==o.vendor?o.vendor:"unknown";var s=r.format||{};s.codec&&(a.audiocodec=s.codec.toLowerCase()),s.bitrate&&(a.bitrate=s.bitrate),s.audioQuality&&(a.audioQuality=s.audioQuality),a.gaiaDevId=r.deviceId||"none",a.noLog=r.noLog||!1,a.noTSV=r.noTSV||!1,a.noStats=r.noStats||!1,a.contentMetadata=i,this.emit(nt.TRACKER_TRACKING_DATA_CREATED,{trackingData:a})}},{key:"trackBufferLoadStart",value:function(){var e=this._trackingData;e&&(e.bufferLoadStartTime=Date.now())}},{key:"trackBytesDownloaded",value:function(e){var t=this._trackingData;t&&(t.totalBytes+=e)}},{key:"trackLoadDone",value:function(e){var t=this._trackingData;if(t){var n=Date.now();t.msInitLatency=n-t.bufferLoadStartTime,t.localTimeMs=n,t.position=e,t.addStartSegment()}}},{key:"trackPlay",value:function(e,t){var n=this._trackingData;n&&(n.played||this.emit(nt.TRACKER_PLAYBACK_START,{trackingData:n}),n.played=!0,n.position=e,n.startPosition=e,n.addSpeedChange(t||1))}},{key:"trackCanPlayThrough",value:function(){var e=this._trackingData;if(e&&!e.msPlayLatency){var t=Date.now();e.msPlayLatency=t-e.loadTime,e.msHeadLatency=t-e.bufferLoadStartTime}}},{key:"trackBufferURL",value:function(e,t){var n=this._trackingData;n&&n.trackBufferURL(e,t)}},{key:"trackNavigatorOffline",value:function(){var e=this._trackingData;e&&(e.nOffline+=1)}},{key:"trackSeekRebuffering",value:function(e){var t=this._trackingData;t&&(e>t.maxMsSeekRebuffering&&(t.maxMsSeekRebuffering=e),t.msSeekRebuffering+=e)}},{key:"trackMsStalled",value:function(e){var t=this._trackingData;t&&(e>t.maxMsStalled&&(t.maxMsStalled=e),t.msStalled+=e,t.nStalls++)}},{key:"trackLoadFailed",value:function(){var e=this._trackingData;e&&(e.msPlayLatency=Date.now()-e.loadTime,e.position=0,e.addStartSegment())}},{key:"trackStopped",value:function(e,t,n){var r,i,a,o,s=this._trackingData;if(s&&!s.isFinalized()){var c=Date.now();if(s.stopTime=c,s.lastPlayPosition>=0&&e>=0&&s.lastPlayPosition<e){var l=e-s.lastPlayPosition;s.addMSPlayed(l)}s.addEndSegment(),s.sourceEnd=t.source||"unknown",s.reasonEnd=t.reason||"unknown",s.nextPlaybackId=t.playbackId||"",s.droppedVideoFrames=null!==(i=null===(r=null==n?void 0:n.video)||void 0===r?void 0:r.droppedVideoFrames)&&void 0!==i?i:0,s.totalVideoFrames=null!==(o=null===(a=null==n?void 0:n.video)||void 0===a?void 0:a.totalVideoFrames)&&void 0!==o?o:0,s.finalize(),Gr.info("Tracker data finalized.");var u=s.getPlaybackStats();this.emit(nt.TRACKER_TRACKING_DATA_FINALIZED,{trackingData:s,playbackStats:u})}}},{key:"trackPositionChanged",value:function(e){var t=this._trackingData;if(t){var n=t.position;e!==n&&(t.addEndSegment(),e>n?(t.nSeeksForward++,t.msSeeksForward+=e-n):e<n&&(t.nSeeksBackward++,t.msSeeksBackward+=n-e),t.position=e,t.lastPlayPosition=-1,t.addStartSegment())}}},{key:"trackPlaying",value:function(e){var t=this._trackingData;if(t){if(t.lastPlayPosition>=0&&t.lastPlayPosition<e){var n=e-t.lastPlayPosition;t.addMSPlayed(n)}t.position=e,t.lastPlayPosition=e}}},{key:"trackPaused",value:function(e){var t=this._trackingData;if(t){if(t.lastPlayPosition>=0&&t.lastPlayPosition<e){var n=e-t.lastPlayPosition;t.addMSPlayed(n)}t.position=e,t.lastPlayPosition=e}}},{key:"trackProgress",value:function(e,t){var n=this._trackingData;if(null==n?void 0:n.played){var r=0;if(n.lastPlayPosition>=0){if((r=e-n.lastPlayPosition)<0)return void Gr.warn("Skipping msPlayed calculation: late progress event.");n.addMSPlayed(r)}this._checkPlayedThreshold(),n.position=e,n.lastPlayPosition=e,t&&n.trackBitrate(t,r)}}},{key:"trackSpeedChanged",value:function(e){var t=this._trackingData;t&&t.addSpeedChange(e)}},{key:"trackVideoLoadStart",value:function(e){var t=this._trackingData;t&&t.registerVideoVariant(e)}},{key:"trackWarning",value:function(){var e=this._trackingData;e&&e.nWarnings++}},{key:"trackOffline",value:function(){var e=this._trackingData;e&&e.nOffline++}},{key:"setActualDuration",value:function(e){var t=this._trackingData;t&&(t.msActualDuration=e)}},{key:"setKeySystem",value:function(e){var t=this._trackingData;t&&(t.keySystem=e)}},{key:"setKeySystemImpl",value:function(e){var t=this._trackingData;t&&(t.keySystemImpl=e)}},{key:"setManifestLatency",value:function(e){var t=this._trackingData;t&&(t.msManifestLatency=e)}},{key:"setPlayIntended",value:function(e){var t=this._trackingData;t&&(t.playIntended=e)}},{key:"setKeyLatency",value:function(e){var t=this._trackingData;t&&(t.msKeyLatency=e)}},{key:"setMemoryCached",value:function(e){var t=this._trackingData;t&&(t.memoryCached=e)}},{key:"setPersistentCached",value:function(e){var t=this._trackingData;t&&(t.persistentCached=e)}},{key:"setProtected",value:function(e){var t=this._trackingData;t&&(t.isProtected=e)}},{key:"setHadError",value:function(e){var t=this._trackingData;t&&(t.hadError=e)}},{key:"setLicenseSessionLatency",value:function(e){var t=this._trackingData;t&&(t.msLicenseSessionLatency=e)}},{key:"setLicenseGenerationLatency",value:function(e){var t=this._trackingData;t&&(t.msLicenseGenerationLatency=e)}},{key:"setLicenseRequestLatency",value:function(e){var t=this._trackingData;t&&(t.msLicenseRequestLatency=e)}},{key:"setLicenseUpdateLatency",value:function(e){var t=this._trackingData;t&&(t.msLicenseUpdateLatency=e)}},{key:"setResolveLatency",value:function(e){var t=this._trackingData;t&&(t.msResolveLatency=e)}},{key:"setCalculatedDuration",value:function(e){var t=this._trackingData;t&&(t.msFileDuration=e)}},{key:"setPlayedThreshold",value:function(e){this._playedThreshold=e}},{key:"setBandwidth",value:function(e){var t=this._trackingData;t&&((e<t.bpsBandwidthMin||!t.bpsBandwidthMin)&&(t.bpsBandwidthMin=e),e>t.bpsBandwidthMax&&(t.bpsBandwidthMax=e),t.totalBandwidth+=e,t.nBandwidthSamples++)}},{key:"setRenditionCount",value:function(e){var t=this._trackingData;t&&(e<t.lastVideoProfileBitrate&&t.nRenditionDowngrade++,e>t.lastVideoProfileBitrate&&t.nRenditionUpgrade++,t.lastVideoProfileBitrate=e)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp);function zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Qr=function(e){m()(n,e);var t=zr(n);function n(e){var r;return _()(this,n),(r=t.call(this))._transport=e,r._parseManifestResponse=r._parseManifestResponse.bind(y()(r)),r}return h()(n,[{key:"_parseManifestResponse",value:function(e){var t,n=e.metadata.startTime;if(200!==e.status){var r=new xr(Q.STORAGE_VIDEO_MANIFEST_FAILED,"Video manifest request failed with status ".concat(e.status));return r.status=e.status,this.emit(nt.VIDEO_MANIFEST_RESOLVE_FAILED,{url:e.url,error:r,start_time:n}),Promise.reject(r)}var i=e.body,a=null===(t=e.headers)||void 0===t?void 0:t.get("content-length");return this.emit(nt.VIDEO_MANIFEST_RESOLVED,{url:e.url,manifest_size:a?parseInt(a,10):JSON.stringify(i).length,start_time:n,end_time:Date.now()}),Promise.resolve(i)}},{key:"getInitSegmentURLs",value:function(e,t,n,r){var i="";n&&(i=e+t.replace("{{profile_id}}",n.id.toString(10)).replace("{{file_type}}",n.file_type));var a="";return r&&(a=e+t.replace("{{profile_id}}",r.id.toString(10)).replace("{{file_type}}",r.file_type)),{audio:i,video:a,audioLogging:i,videoLogging:a}}},{key:"getSegmentURLs",value:function(e,t,n,r,i){var a="";r&&(a=e+t.replace("{{profile_id}}",r.id.toString(10)).replace("{{file_type}}",r.file_type));var o="";return i&&(o=e+t.replace("{{profile_id}}",i.id.toString(10)).replace("{{file_type}}",i.file_type)),{audio:a.replace("{{segment_timestamp}}",n.toString()),video:o.replace("{{segment_timestamp}}",n.toString()),audioLogging:a,videoLogging:o}}},{key:"getManifest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?"@webgate/manifests/v8/unauth/json/sources":"@webgate/manifests/v7/json/sources",r="".concat(n,"/").concat(e,"/options/supports_drm");return this._transport.request(r,{authorize:!t,responseType:"json",parseResponseHeaders:!0,retry:{condition:function(e,t){return e.getStatusFamily()!==t.SUCCESS}},metadata:{startTime:Date.now()}}).then(this._parseManifestResponse)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp);function $r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Xr,Zr,Jr=function(e){m()(n,e);var t=$r(n);function n(e,r){var i;return _()(this,n),(i=t.call(this)).status=-1,i.debug={},i.canPlayNext=!0,i.unrecoverable=!1,i.name="LicenseError",i.code=e,i.message=r,i}return h()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r.canPlayNext=!1,r}}]),n}(ve()(Error)),ei=function(){function e(t){var n=this;_()(this,e),this._sdk={name:"",version:""},this._securityLevel=null,this._urls={},t.sdk&&(this._sdk=t.sdk),t.securityLevel&&(this._securityLevel=t.securityLevel),this._transport=t.transport,this._useTestLicenseServer=!!t.useTestLicenseServer,this._transport.on(this._transport.EVENT_CONNECTION_ID,(function(){n._urls={}}))}return h()(e,[{key:"get",value:function(e,t){var n=this,r="".concat(e,":").concat(t),i=this._urls[r];if(i&&i.expires>Date.now()+6e4)return Promise.resolve(i.uri);var a=this._useTestLicenseServer?"&use_test_license_server=true":"",o="".concat("@webgate/melody/v1/license_url","?keysystem=").concat(e,"&mediatype=").concat(t,"&sdk_name=").concat(this._sdk.name,"&sdk_version=").concat(this._sdk.version).concat(a);return this._transport.request(o,{responseType:"json",retry:{condition:function(e,t){var n=e.getStatusFamily();return n===t.SERVER_ERROR||n===t.CONNECTION_ERROR}}}).then((function(e){var t,i=e.body;return i&&200===e.status?(i.expires*=1e3,i.uri="@webgate/".concat(i.uri),n._securityLevel&&(i.uri+=[-1!==i.uri.indexOf("?")?"&":"?","sl=",n._securityLevel].join("")),n._urls[r]=i,i.uri):((t=i?400===e.status&&i&&"deprecated-version"===i.code?Jr.fatal(Q.LICENSE_RESOLVER_DEPRECATED_VERSION,"This version of the SDK is no longer supported. Please upgrade"):new Jr(Q.LICENSE_RESOLVER_CANT_RESOLVE_URL,"License URL endpoint responded with status ".concat(e.status)):Jr.fatal(Q.LICENSE_RESOLVE_INVALID_RESPONSE,"License URL endpoint responded with invalid response")).status=e.status,Promise.reject(t))}))}},{key:"remove",value:function(e,t){this._urls["".concat(e,":").concat(t)]=null}}]),e}(),ti=function(){function e(t){_()(this,e),this._melodyLogger=new je.Hx(t)}return h()(e,[{key:"logTrackStreamVerification",value:function(e){return this._melodyLogger.sendLog("/v1/msg/batch",{type:"track_stream_verification",message:e},{batch:!0})}},{key:"logJSSDKPlaybackStats",value:function(e){return this._melodyLogger.sendLog("/v1/msg/batch",{type:"jssdk_playback_stats",message:e},{batch:!0})}},{key:"logJSSDKPlaybackStart",value:function(e){return this._melodyLogger.sendLog("/v1/msg/batch",{type:"jssdk_playback_start",message:e},{batch:!0})}},{key:"logJSSDKError",value:function(e){return this._melodyLogger.sendLog("/v1/msg/batch",{type:"jssdk_error",message:e},{batch:!0})}},{key:"logJSSDKWarning",value:function(e){return this._melodyLogger.sendLog("/v1/msg/batch",{type:"jssdk_warning",message:e},{batch:!0})}}]),e}();!function(e){e[e.ABORTED=101]="ABORTED",e[e.NETWORK=102]="NETWORK",e[e.MEDIA_DECODING=103]="MEDIA_DECODING",e[e.SRC_NOT_SUPPORTED=104]="SRC_NOT_SUPPORTED",e[e.EME=105]="EME",e[e.GENERIC=100]="GENERIC"}(Zr||(Zr={}));var ni,ri=(Xr={},i()(Xr,Q.MEDIA_ABORTED,Zr.ABORTED),i()(Xr,Q.MEDIA_DECODING_ERROR,Zr.MEDIA_DECODING),i()(Xr,Q.MEDIA_NOT_SUPPORTED,Zr.SRC_NOT_SUPPORTED),i()(Xr,Q.MEDIA_NETWORK_ERROR,Zr.NETWORK),Xr);function ii(e){var t=ri[e];return/_REQUEST_|_RESPONSE$/.test(e)?t=Zr.NETWORK:t||(t=/^EME_/.test(e)?Zr.EME:Zr.GENERIC),t}function ai(e){var t,n=e.match(/^https?:\/\/([^\/]+@)?([^\/?#]+)/);return null!==(t=null==n?void 0:n[2])&&void 0!==t?t:""}!function(e){e.READY="playerready",e.VIDEO_CHANGE="videochange",e.PLAY="play",e.PLAYING="playing",e.PAUSE="pause",e.TIMEUPDATE="timeupdate",e.SEEKING="seeking",e.SEEKED="seeked",e.ERROR="error",e.ENDED="ended",e.RENDITION_CHANGE="renditionchange",e.REQUEST_COMPLETED="requestcompleted",e.REQUEST_FAILED="requestfailed",e.REQUEST_CANCELED="requestcanceled"}(ni||(ni={}));var oi,si,ci,li,ui,di,pi={player_is_paused:!0,player_width:0,player_height:0,video_source_height:0,video_source_width:0,player_is_fullscreen:void 0,player_autoplay_on:void 0,player_preload_on:void 0,video_source_url:void 0,video_source_mime_type:void 0,video_source_duration:void 0,video_poster_url:void 0,player_language_code:void 0},_i=function(){function e(t){_()(this,e),this._playerId="spotify-playback-".concat(Date.now()),this._currentContentInfo=null,this._readyDeferred=(0,pe.$)(),this._isMuxInitialized=!1,this._muxInitData=null,this._player=t.player,this._mux=t.mux,this._getPlayheadTime=this._getPlayheadTime.bind(this),this._getStateData=this._getStateData.bind(this),this._init(t)}return h()(e,[{key:"_init",value:function(e){var t=this;Promise.all([Promise.resolve(e.deviceInfo)]).then((function(n){var r,a,o=se()(n,1)[0];t._muxInitData={data:Object.assign({env_key:e.envKey||"2qbjhhcl4u87btjbo7dh8vi2n",player_name:null!==(a=null==o?void 0:o.platform_name)&&void 0!==a?a:null==o?void 0:o.platform,player_version:null==o?void 0:o.version,viewer_device_manufacturer:null==o?void 0:o.brand,viewer_device_category:null==o?void 0:o.type,viewer_device_name:null==o?void 0:o.model,player_software_name:e.sdk||"spotify-playback",player_software_version:e.sdkVersion||Ir,player_mux_plugin_name:"spotify-playback-mux-reporter",player_mux_plugin_version:Ir},e.muxCustomDimensions),getPlayheadTime:t._getPlayheadTime,getStateData:t._getStateData},t._player.addListeners((r={},i()(r,nt.PLAYER_BEFORE_LOAD,t._onBeforeLoad.bind(t)),i()(r,nt.PLAYER_PLAY,t._onPlay.bind(t)),i()(r,nt.PLAYER_PLAYING,t._onPlaying.bind(t)),i()(r,nt.PLAYER_PAUSED,t._onPause.bind(t)),i()(r,nt.PLAYER_PROGRESS,t._onProgress.bind(t)),i()(r,nt.PLAYER_SEEKING,t._onSeeking.bind(t)),i()(r,nt.PLAYER_POSITION_CHANGED,t._onPositionChanged.bind(t)),i()(r,nt.PLAYER_ERROR,t._onError.bind(t)),i()(r,nt.PLAYER_ENDED,t._onEnded.bind(t)),i()(r,nt.PLAYER_DURATION_CHANGED,t._onDurationChanged.bind(t)),i()(r,nt.PLAYER_VIDEO_RESIZED,t._onVideoResized.bind(t)),i()(r,nt.PLAYER_VIDEO_PROFILE_CHANGED,t._onVideoProfileChanged.bind(t)),i()(r,nt.PLAYER_FRAGMENT_FETCHED,t._onFragmentFetched.bind(t)),i()(r,nt.PLAYER_FRAGMENT_FETCH_ERROR,t._onFragmentFetchError.bind(t)),i()(r,nt.PLAYER_VIDEO_MANIFEST_RESOLVED,t._onVideoManifestResolved.bind(t)),i()(r,nt.PLAYER_VIDEO_MANIFEST_RESOLVE_FAILED,t._onVideoManifestResolveFailed.bind(t)),r))})).then(this._readyDeferred.resolve,this._readyDeferred.reject)}},{key:"_getPlayheadTime",value:function(){return this._player.getPlayerPosition()}},{key:"_getStateData",value:function(){return this._currentContentInfo?Object.assign(Object.assign({},this._currentContentInfo.stateData),{player_language_code:this._player.getActiveSubtitleLanguage()}):null}},{key:"_onDurationChanged",value:function(e){this._currentContentInfo&&(this._currentContentInfo.stateData.video_source_duration=e.data.duration)}},{key:"_onVideoResized",value:function(e){this._currentContentInfo&&(this._currentContentInfo.stateData.player_width=e.data.width,this._currentContentInfo.stateData.player_height=e.data.height)}},{key:"_onBeforeLoad",value:function(e){var t=e.data,n=t.track,r=t.options,i=t.logData,a=!!this._currentContentInfo;if("video"!==n.mediaType||(null==i?void 0:i.noLog)||(null==i?void 0:i.noMuxEvents))return a&&this._mux.emit(this._playerId,ni.VIDEO_CHANGE,{}),void(this._currentContentInfo=null);var o={video_id:n.fileId,video_title:(null==i?void 0:i.displayTitle)||void 0,video_series:(null==i?void 0:i.displayGroup)||void 0,video_duration:(null==i?void 0:i.displayDuration)||void 0},s=Object.assign({},pi);this._currentContentInfo={track:n,options:r,videoData:o,stateData:s},!this._isMuxInitialized&&this._muxInitData?(this._mux.init(this._playerId,this._muxInitData),this._mux.emit(this._playerId,ni.READY),this._isMuxInitialized=!0):a&&this._mux.emit(this._playerId,ni.VIDEO_CHANGE,o)}},{key:"_onPlay",value:function(){var e,t;if(this._currentContentInfo){var n=this._currentContentInfo.stateData,r=this._player.getPlayerState(),i=r.media_info,a=(null===(t=null===(e=this._currentContentInfo)||void 0===e?void 0:e.options)||void 0===t?void 0:t.autoplay)||!1,o=r.player_element,s=o.width,c=o.height,l=o.src,u=o.poster;n.player_is_paused=!r.playing,n.player_width=s||0,n.player_height=c||0,n.video_source_height=i.video_height||0,n.video_source_width=i.video_width||0,n.player_autoplay_on=a,n.video_source_url=l,n.video_source_mime_type=i.video_format,n.video_source_duration=r.duration,n.video_poster_url=u,this._mux.emit(this._playerId,ni.PLAY,this._currentContentInfo.videoData)}}},{key:"_onPlaying",value:function(){this._currentContentInfo&&(this._currentContentInfo.stateData.player_is_paused=!1,this._mux.emit(this._playerId,ni.PLAYING))}},{key:"_onPause",value:function(){this._currentContentInfo&&(this._currentContentInfo.stateData.player_is_paused=!0,this._mux.emit(this._playerId,ni.PAUSE))}},{key:"_onProgress",value:function(e){this._currentContentInfo&&this._mux.emit(this._playerId,ni.TIMEUPDATE,{player_playhead_time:e.data.position})}},{key:"_onSeeking",value:function(){this._currentContentInfo&&this._mux.emit(this._playerId,ni.SEEKING)}},{key:"_onPositionChanged",value:function(){this._currentContentInfo&&this._mux.emit(this._playerId,ni.SEEKED)}},{key:"_onError",value:function(e){var t,n,r=null===(n=null===(t=e.data)||void 0===t?void 0:t.error)||void 0===n?void 0:n.code;this._currentContentInfo&&r&&this._mux.emit(this._playerId,ni.ERROR,{player_error_code:ii(r),player_error_message:r})}},{key:"_onEnded",value:function(){this._currentContentInfo&&this._mux.emit(this._playerId,ni.ENDED)}},{key:"_onVideoProfileChanged",value:function(e){if(this._currentContentInfo){var t=e.data.profile,n=this._currentContentInfo.stateData;n.video_source_height=t.height||0,n.video_source_width=t.width||0,n.video_source_mime_type=t.mimeType,this._mux.emit(this._playerId,ni.RENDITION_CHANGE,{video_source_bitrate:t.bitrate,video_source_width:t.width,video_source_height:t.height})}}},{key:"_onFragmentFetched",value:function(e){var t=e.data;if(this._currentContentInfo||"video"===t.media_type){var n="".concat(t.segment_type).concat(t.init?"_init":"");this._mux.emit(this._playerId,ni.REQUEST_COMPLETED,{request_type:n,request_hostname:ai(t.url),request_start:t.start_time,request_response_end:t.end_time,request_bytes_loaded:t.byte_length})}}},{key:"_onFragmentFetchError",value:function(e){var t=e.data;if(this._currentContentInfo||"video"===t.media_type){var n="".concat(t.segment_type).concat(t.init?"_init":"");this._mux.emit(this._playerId,ni.REQUEST_FAILED,{request_type:n,request_hostname:ai(t.url),request_start:t.start_time,request_error:t.error.code,request_error_code:t.error.status,request_error_text:""})}}},{key:"_onVideoManifestResolved",value:function(e){var t=e.data;this._currentContentInfo&&this._mux.emit(this._playerId,ni.REQUEST_COMPLETED,{request_type:"manifest",request_hostname:ai(t.url),request_start:t.start_time,request_response_end:t.end_time,request_bytes_loaded:t.manifest_size})}},{key:"_onVideoManifestResolveFailed",value:function(e){var t=e.data;this._currentContentInfo&&this._mux.emit(this._playerId,ni.REQUEST_FAILED,{request_type:"manifest",request_hostname:ai(t.url),request_start:t.start_time,request_error:t.error.code,request_error_code:t.error.status,request_error_text:""})}},{key:"ready",value:function(){return this._readyDeferred.promise}}],[{key:"create",value:function(t){return new e(t)}}]),e}();function fi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}!function(e){e.NULL_VALUE="NULL_VALUE",e.LIST_START="LIST_START",e.LIST_END="LIST_END",e.FORBIDDEN="FORBIDDEN",e.IGNORE="IGNORE",e.PAUSE="PAUSE"}(oi||(oi={})),function(e){e.MP4_AUDIO="audio/mp4",e.MP4_VIDEO="video/mp4",e.MTS_VIDEO="video/mp2t",e.WEBM_AUDIO="audio/webm",e.WEBM_VIDEO="video/webm"}(si||(si={})),function(e){e.AAC_LC="mp4a.40.2",e.FLAC="flac",e.OPUS="opus",e.VP9="vp9",e.VP8="vp8",e.H264_31="avc1.4d401f"}(ci||(ci={})),function(e){e.UNKNOWN="UNKNOWN",e.DEFAULT="DEFAULT",e.LOW="LOW",e.NORMAL="NORMAL",e.HIGH="HIGH",e.VERY_HIGH="VERY_HIGH",e.HIFI="HIFI"}(li||(li={})),function(e){e.NONE="NONE",e.CONTEXT="CONTEXT",e.TRACK="TRACK"}(ui||(ui={})),function(e){e.EMPTY="EMPTY",e.SW_CRYPTO="SW_CRYPTO",e.SW_DECODE="SW_DECODE",e.HW_CRYPTO="HW_CRYPTO",e.HW_DECODE="HW_DECODE",e.HW_ALL="HW_ALL"}(di||(di={}));var hi=function(e){m()(n,e);var t=fi(n);function n(e,r){var i;return _()(this,n),(i=t.call(this)).unrecoverable=!1,i.listPlayerIgnore=!1,i.debug={},i.name="PlaybackError",i.code=e,i.message=r,i}return h()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(ve()(Error));function vi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function yi(e){return"uri"in e}var gi=function(e){m()(n,e);var t=vi(n);function n(e){var r;if(_()(this,n),(r=t.call(this))._trackPlayerPromise=(0,pe.$)(),r._maxListErrors=5,r._uid=0,r._loadedList=null,r._loadedOptions=null,r._currentTrack=null,r._currentTrackOptions=null,r._listPlayCount=0,r._listErrorCount=0,r._shuffled=!1,r._repeatMode=ui.NONE,r._currentSeqId=0,!e.trackPlayer)throw new TypeError("Argument `options.trackPlayerManager` not found.");return e.maxListErrors&&(r._maxListErrors=e.maxListErrors),r._setListOptions=r._setListOptions.bind(y()(r)),r._replaceCurrentList=r._replaceCurrentList.bind(y()(r)),r._handleCapped=r._handleCapped.bind(y()(r)),r._handlePlaying=r._handlePlaying.bind(y()(r)),r._handlePaused=r._handlePaused.bind(y()(r)),r._handleEnded=r._handleEnded.bind(y()(r)),r._handleCanPreload=r._handleCanPreload.bind(y()(r)),r._handleError=r._handleError.bind(y()(r)),r._handlePositionChanged=r._handlePositionChanged.bind(y()(r)),r._handleDurationChanged=r._handleDurationChanged.bind(y()(r)),r._handleTimeout=r._handleTimeout.bind(y()(r)),r._handlePlayerInitError=r._handlePlayerInitError.bind(y()(r)),r._handleProgress=r._handleProgress.bind(y()(r)),r._handlePlayedThresholdReached=r._handlePlayedThresholdReached.bind(y()(r)),r._handleBeforeLoad=r._handleBeforeLoad.bind(y()(r)),r._init(e.trackPlayer),r}return h()(n,[{key:"_init",value:function(e){var t=this;this._trackPlayerPromise.promise.catch((function(){})),Promise.resolve(e).then((function(e){t._attachPlayerEvents(e),t._trackPlayerPromise.resolve(e)})).catch(this._handlePlayerInitError)}},{key:"_attachPlayerEvents",value:function(e){var t,n,r;e.addListeners((t={},i()(t,nt.PLAYER_CAN_PRELOAD,this._handleCanPreload),i()(t,nt.PLAYER_CAPPED,this._handleCapped),i()(t,nt.PLAYER_ENDED,this._handleEnded),i()(t,nt.PLAYER_ERROR,this._handleError),i()(t,nt.PLAYER_PAUSED,this._handlePaused),i()(t,nt.PLAYER_PLAYING,this._handlePlaying),i()(t,nt.PLAYER_TIMEOUT,this._handleTimeout),i()(t,nt.PLAYER_POSITION_CHANGED,this._handlePositionChanged),i()(t,nt.PLAYER_DURATION_CHANGED,this._handleDurationChanged),i()(t,nt.PLAYER_PROGRESS,this._handleProgress),i()(t,nt.PLAYER_BEFORE_LOAD,this._handleBeforeLoad),i()(t,nt.PLAYER_PLAYED_THRESHOLD_REACHED,this._handlePlayedThresholdReached),t)),this.proxyEmitAllSync(e,(n={},i()(n,nt.PLAYER_BEFORE_VOLUME_CHANGE,nt.LIST_PLAYER_BEFORE_VOLUME_CHANGE),i()(n,nt.PLAYER_LOAD,nt.LIST_PLAYER_PLAYER_LOAD),n)),this.proxyEmitAll(e,(r={},i()(r,nt.PLAYER_AUTOPLAY_FAILED,nt.LIST_PLAYER_AUTOPLAY_FAILED),i()(r,nt.PLAYER_TRACKING_DATA_CREATED,nt.LIST_PLAYER_TRACKING_DATA_CREATED),i()(r,nt.PLAYER_TRACKING_DATA_FINALIZED,nt.LIST_PLAYER_TRACKING_DATA_FINALIZED),i()(r,nt.PLAYER_BUFFER_STALLED,nt.LIST_PLAYER_BUFFER_STALLED),i()(r,nt.PLAYER_BUFFERING_START,nt.LIST_PLAYER_BUFFERING_START),i()(r,nt.PLAYER_BUFFERING_END,nt.LIST_PLAYER_BUFFERING_END),i()(r,nt.PLAYER_VIDEO_ELEMENT_APPENDED,nt.LIST_PLAYER_VIDEO_ELEMENT_APPENDED),i()(r,nt.PLAYER_VIDEO_ELEMENT_REMOVED,nt.LIST_PLAYER_VIDEO_ELEMENT_REMOVED),i()(r,nt.PLAYER_DISPLAYED_CUES_CHANGED,nt.LIST_PLAYER_DISPLAYED_CUES_CHANGED),i()(r,nt.LIST_PLAYER_VIDEO_PROFILE_CHANGED,nt.PLAYER_VIDEO_PROFILE_CHANGED),i()(r,nt.LIST_PLAYER_PLAYBACK_SPEED_CHANGED,nt.PLAYER_PLAYBACK_SPEED_CHANGED),i()(r,nt.LIST_PLAYER_SUBTITLE_LANGUAGES_LOADED,nt.PLAYER_SUBTITLE_LANGUAGES_LOADED),r))}},{key:"_translatePosition",value:function(e){var t,n,r;return null!==(r=null===(n=null===(t=this._loadedList)||void 0===t?void 0:t.translatePosition)||void 0===n?void 0:n.call(t,e))&&void 0!==r?r:e}},{key:"_translateDuration",value:function(e){var t,n,r;return null!==(r=null===(n=null===(t=this._loadedList)||void 0===t?void 0:t.translateDuration)||void 0===n?void 0:n.call(t,e))&&void 0!==r?r:e}},{key:"_handleProgress",value:function(e){var t=e.data;this.emit(nt.LIST_PLAYER_PROGRESS,Object.assign(Object.assign({},t),{position:this._translatePosition(t.position)}))}},{key:"_handleBeforeLoad",value:function(e){var t=e.data;this.emit(nt.LIST_PLAYER_BEFORE_PLAYER_LOAD,Object.assign(Object.assign({},t),{options:Object.assign(Object.assign({},t.options),{position:this._translatePosition(t.options.position)})}))}},{key:"_handlePlayerInitError",value:function(e){this._trackPlayerPromise.reject(new hi(Q.LIST_PLAYER_NO_TRACK_PLAYER,e.message||"Track player promise was rejected."))}},{key:"_handleCapped",value:function(){var e=this._currentTrack;e&&this.emit(nt.LIST_PLAYER_CAPPED,{uid:this._uid,track:e,options:this._currentTrackOptions,list:this._loadedList})}},{key:"_handlePlaying",value:function(e){var t=this._currentTrack;t&&this.emit(nt.LIST_PLAYER_PLAYING,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position)})}},{key:"_handlePaused",value:function(e){var t=this._currentTrack;t&&this.emit(nt.LIST_PLAYER_PAUSED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position)})}},{key:"_handleCanPreload",value:function(){this._preloadUpcomingTrack().catch((function(){}))}},{key:"_handleEnded",value:function(){var e=this._currentTrack;e&&(this.emit(nt.LIST_PLAYER_TRACK_ENDED,{uid:this._uid,track:e,options:this._currentTrackOptions,list:this._loadedList}),this.next(ae.TRACK_DONE))}},{key:"_handleTimeout",value:function(){var e=this._currentTrack;e&&(this.emit(nt.LIST_PLAYER_TRACK_TIMEOUT,{uid:this._uid,track:e,options:this._currentTrackOptions,list:this._loadedList}),this.next(ae.TRACK_ERROR))}},{key:"_handlePositionChanged",value:function(e){var t=this._currentTrack;t&&this.emit(nt.LIST_PLAYER_POSITION_CHANGED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position)})}},{key:"_handleDurationChanged",value:function(e){var t=this._currentTrack;t&&this.emit(nt.LIST_PLAYER_DURATION_CHANGED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,position:this._translatePosition(e.data.position),duration:this._translateDuration(e.data.duration)})}},{key:"_handlePlayedThresholdReached",value:function(e){var t=this._currentTrack;t&&this.emit(nt.LIST_PLAYER_PLAYED_THRESHOLD_REACHED,{uid:this._uid,track:t,options:this._currentTrackOptions,list:this._loadedList,threshold:e.data.threshold,position:this._translatePosition(e.data.position)})}},{key:"_handleError",value:function(e){var t=this._currentTrack,n=e.data;if(t){n.position=this._translatePosition(e.data.position),this.emit(nt.LIST_PLAYER_ERROR,n),this.emitSync(nt.LIST_PLAYER_ERROR_SYNC,n);var r=!!n.error&&n.error.listPlayerIgnore;r||this._listErrorCount++,n.canPlayNext&&(r||this._listErrorCount<=this._maxListErrors?this.next(ae.TRACK_ERROR):this.emit(nt.LIST_PLAYER_MAX_LIST_ERRORS_REACHED,{count:this._listErrorCount,threshold:this._maxListErrors}))}}},{key:"_handleTrackLoaded",value:function(e){this.emitSync(nt.LIST_PLAYER_TRACK_LOADED,e)}},{key:"_incrementSeqId",value:function(){return this._currentSeqId>=9007199254740991?this._currentSeqId=0:this._currentSeqId+=1,this._currentSeqId}},{key:"_getTrackPlayer",value:function(){return this._trackPlayerPromise.promise}},{key:"_setListIndex",value:function(e,t){var n=t.index&&-1!==t.index?t.index:0;return Promise.all([e,t,e.startAt(n)])}},{key:"_setListOptions",value:function(e){var t=se()(e,3),n=t[0],r=t[1];t[2];return Promise.all([n.setShuffle(!!this._shuffled),n.setRepeatMode(this._repeatMode)]).then((function(){return[n,r]}))}},{key:"_replaceCurrentList",value:function(e){var t=se()(e,2),n=t[0],r=t[1];return this.emitSync(nt.LIST_PLAYER_BEFORE_LIST_CHANGE,{newList:n,newOptions:r,oldList:this._loadedList,oldOptions:this._loadedOptions}),this._loadedList=n,this._loadedOptions=r,this._listPlayCount=0,this._listErrorCount=0,this.emit(nt.LIST_PLAYER_LIST_CHANGED,{list:n,options:r}),it.SUCCESS}},{key:"_preloadTrack",value:function(e){return this._getTrackPlayer().then((function(t){return t.preload(e).catch((function(){})),it.SUCCESS}))}},{key:"_changeTrack",value:function(e,t,n){var r=this;if(this._currentSeqId!==n)return Promise.resolve(it.CANCELLED);this.emitSync(nt.LIST_PLAYER_BEFORE_TRACK_LOAD,{list:this._loadedList,newTrack:e,oldTrack:this._currentTrack}),this._uid++;var i=++this._listPlayCount,a=this._loadedOptions,o=!0,s=0,c=3e4;a&&(1===i?(o=!a.paused,s=a.initialPosition||a.position||0):s=a.position||0);var l=t===ae.TRACK_DONE;if(e.options){var u=e.options;void 0!==u.paused&&(o=!u.paused),void 0!==u.position&&(s=u.position),void 0!==u.playedThreshold&&(c=u.playedThreshold)}this._currentTrack=e,this._currentTrackOptions={reason:t,paused:!o,position:s,playedThreshold:c};var d=this._handleTrackLoaded.bind(this,{uid:this._uid,track:this._currentTrack,options:this._currentTrackOptions,list:this._loadedList});return this._getTrackPlayer().then((function(t){return r._currentSeqId!==n?it.CANCELLED:(Promise.resolve(t.load(e,{uriProperty:"playableURI",autoplay:o,position:s,playedThreshold:c,continuePrevious:l},d)).catch((function(){})),it.SUCCESS)}))}},{key:"_preloadUpcomingTrack",value:function(){var e=this,t=this._loadedList;if(!t)return Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));var n={reason:ae.TRACK_DONE,listConstants:oi};return t.peekNext(n).then((function(t){return t===oi.FORBIDDEN?it.FORBIDDEN:t===oi.NULL_VALUE?e._preloadUpcomingTrack():t===oi.LIST_END?it.LIST_END:yi(t)&&t.playable?e._preloadTrack(t):it.INVALID}))}},{key:"activateElement",value:function(){return this._getTrackPlayer().then((function(e){return e.activateElement(),it.SUCCESS}))}},{key:"load",value:function(e,t){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={index:-1,position:0,initialPosition:0,duration:-1,paused:!1,reason:ae.UNKNOWN};return void 0!==e.index&&(t.index=e.index),void 0!==e.position&&(t.position=e.position),void 0!==e.initialPosition&&(t.initialPosition=e.initialPosition),void 0!==e.duration&&(t.duration=e.duration),void 0!==e.paused&&(t.paused=e.paused),void 0!==e.reason&&(t.reason=e.reason),t}(t||this._loadedOptions||{});return this._setListIndex(e,n).then(this._setListOptions).then(this._replaceCurrentList)}},{key:"play",value:function(e,t){var n=this;return this.load(e,t).then((function(){if(n._loadedList!==e)return it.CANCELLED;var t=n._loadedOptions?n._loadedOptions.reason:ae.UNKNOWN;return n.next(t)}))}},{key:"canChangeTrack",value:function(){return this._loadedList?this._loadedList.peekNext({reason:ae.FORWARD_BUTTON,listConstants:oi}).then((function(e){return e!==oi.FORBIDDEN})):Promise.resolve(!0)}},{key:"next",value:function(e){var t=this;if(!e)return Promise.reject(new hi(Q.LIST_PLAYER_INVALID_ARGUMENT,"The argument `reason` is required."));var n=this._loadedList;if(!n)return Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));this.emitSync(nt.LIST_PLAYER_BEFORE_NEXT,{list:n,reason:e});var r=this._incrementSeqId(),i={reason:e,listConstants:oi};return n.next(i).then((function(i){return t._currentSeqId!==r?it.CANCELLED:i===oi.FORBIDDEN?it.FORBIDDEN:i===oi.NULL_VALUE?t.next(e):i===oi.LIST_END?(t.emit(nt.LIST_PLAYER_LIST_ENDED,{list:n,reason:ae.END_PLAY}),t.clear(e),it.LIST_END):yi(i)?i.playable?t._changeTrack(i,e,r):(t.emit(nt.LIST_PLAYER_TRACK_UNPLAYABLE,{track:i,list:n}),t.next(e)):it.INVALID}))}},{key:"previous",value:function(e){var t=this;if(!e)return Promise.reject(new hi(Q.LIST_PLAYER_INVALID_ARGUMENT,"The argument `reason` is required."));var n=this._loadedList;if(!n)return Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));this.emitSync(nt.LIST_PLAYER_BEFORE_PREVIOUS,{list:n,reason:e});var r=this._incrementSeqId(),i={reason:e,listConstants:oi};return n.previous(i).then((function(i){return t._currentSeqId!==r?it.CANCELLED:i===oi.FORBIDDEN?it.FORBIDDEN:i===oi.NULL_VALUE?t.previous(e):i===oi.LIST_START?(t.emit(nt.LIST_PLAYER_LIST_ENDED,{list:n,reason:ae.END_PLAY}),t.clear(e),it.LIST_END):yi(i)?i.playable?t._changeTrack(i,e,r):(t.emit(nt.LIST_PLAYER_TRACK_UNPLAYABLE,{track:i,list:n}),t.previous(e)):it.INVALID}))}},{key:"pause",value:function(){return this._loadedList?this._currentTrack?this._getTrackPlayer().then((function(e){return e.pause().then((function(){return it.SUCCESS})).catch((function(e){return"AbortError"===(null==e?void 0:e.name)?it.CANCELLED:it.FORBIDDEN}))})):Promise.resolve(it.SUCCESS):Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."))}},{key:"resume",value:function(){return this._loadedList?this._currentTrack?this._getTrackPlayer().then((function(e){return e.resume().then((function(){return it.SUCCESS})).catch((function(e){return"AbortError"===(null==e?void 0:e.name)?it.CANCELLED:it.FORBIDDEN}))})):Promise.resolve(it.SUCCESS):Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."))}},{key:"togglePlay",value:function(){return this._loadedList?this._currentTrack?this._getTrackPlayer().then((function(e){return e.togglePlay().then((function(){return it.SUCCESS})).catch((function(e){return"AbortError"===(null==e?void 0:e.name)?it.CANCELLED:it.FORBIDDEN}))})):Promise.resolve(it.SUCCESS):Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."))}},{key:"stop",value:function(e){var t=this,n={reason:e||ae.UNKNOWN},r=this._currentTrack;return r&&r.logData&&(n.source=r.logData.source),this._incrementSeqId(),this._getTrackPlayer().then((function(e){return e.stop(n),t.emit(nt.LIST_PLAYER_STOPPED,{uid:t._uid,options:t._currentTrackOptions,list:t._loadedList}),it.SUCCESS}))}},{key:"clear",value:function(e){var t=this;return this.stop(e).then((function(){return t._loadedList=null,t._loadedOptions=null,t._currentTrack=null,t._currentTrackOptions=null,t.emit(nt.LIST_PLAYER_CLEARED,null),it.SUCCESS}))}},{key:"setShuffle",value:function(e){var t=!!e;if(this._shuffled!==t){this._shuffled=t,this.emit(nt.LIST_PLAYER_SHUFFLE_CHANGED,{player:this,shuffled:t});var n=this._loadedList;n&&n.setShuffle(this._shuffled)}return Promise.resolve(it.SUCCESS)}},{key:"setRepeatMode",value:function(e){if(!(e in ui))return Promise.reject(new hi(Q.LIST_PLAYER_INVALID_ARGUMENT,"The value of repeat mode is not a correct RepeatMode enum value"));if(this._repeatMode!==e){this._repeatMode=e,this.emit(nt.LIST_PLAYER_REPEAT_MODE_CHANGED,{player:this,repeatMode:e});var t=this._loadedList;t&&t.setRepeatMode(this._repeatMode)}return Promise.resolve(it.SUCCESS)}},{key:"getVolume",value:function(){return this._getTrackPlayer().then((function(e){return e.getVolume()}))}},{key:"setVolume",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._getTrackPlayer().then((function(r){return r.setVolume(e,{commandId:null!=n?n:void 0}),t.emit(nt.LIST_PLAYER_VOLUME_CHANGED,{volume:e,commandId:n}),it.SUCCESS}))}},{key:"seek",value:function(e){var t,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae.SEEK,a=this._loadedList;if(!a)return Promise.reject(new hi(Q.LIST_PLAYER_NO_LIST,"Cannot perform operation; no list was loaded."));if("function"==typeof a.allowSeeking&&!a.allowSeeking())return Promise.reject(new hi(Q.LIST_PLAYER_FORBIDDEN,"The operation is not allowed."));var o=null!==(n=null===(t=a.handleSeek)||void 0===t?void 0:t.call(a,e,{reason:i,listConstants:oi}))&&void 0!==n?n:e;return o===oi.PAUSE?this.pause().then((function(t){return r.emit(nt.LIST_PLAYER_SEEK_HANDLED,{position:e,reason:o}),t})):o===oi.IGNORE?(this.emit(nt.LIST_PLAYER_SEEK_HANDLED,{position:e,reason:o}),Promise.resolve(it.SUCCESS)):this._currentTrack?this._getTrackPlayer().then((function(e){return e.seek(o),it.SUCCESS})):Promise.resolve(it.SUCCESS)}},{key:"getListConstants",value:function(){return oi}},{key:"getLoadedList",value:function(){return this._loadedList}},{key:"getLoadedOptions",value:function(){return this._loadedOptions}},{key:"getPlayerState",value:function(){var e=this;return this._getTrackPlayer().then((function(t){var n=t.getPlayerState();return Object.assign(Object.assign({},n),{position:e._translatePosition(n.position),duration:e._translateDuration(n.duration)})}))}},{key:"getState",value:function(){var e=this;return this.getPlayerState().then((function(t){return{playbackState:t,track:e._currentTrack,list:e._loadedList,options:e._loadedOptions}}))}},{key:"getMediaConfig",value:function(){return this._getTrackPlayer().then((function(e){return e.getMediaConfig()}))}},{key:"hideSubtitles",value:function(){return this._getTrackPlayer().then((function(e){return e.hideSubtitles()})).then((function(){return it.SUCCESS}))}},{key:"showSubtitles",value:function(){return this._getTrackPlayer().then((function(e){return e.showSubtitles()})).then((function(){return it.SUCCESS}))}},{key:"areSubtitlesShown",value:function(){return this._getTrackPlayer().then((function(e){return e.areSubtitlesShown()}))}},{key:"getSubtitleLanguages",value:function(){return this._getTrackPlayer().then((function(e){return e.getSubtitleLanguages()}))}},{key:"getActiveSubtitleLanguage",value:function(){return this._getTrackPlayer().then((function(e){var t;return null!==(t=e.getActiveSubtitleLanguage())&&void 0!==t?t:null}))}},{key:"deactivateCueEvents",value:function(){return this._getTrackPlayer().then((function(e){return e.deactivateCueEvents()})).then((function(){return it.SUCCESS}))}},{key:"activateCueEvents",value:function(){return this._getTrackPlayer().then((function(e){return e.activateCueEvents()})).then((function(){return it.SUCCESS}))}},{key:"getCurrentBandwidth",value:function(){return this._getTrackPlayer().then((function(e){return e.getCurrentBandwidth()}))}},{key:"setSubtitleLanguage",value:function(e){return this._getTrackPlayer().then((function(t){return t.setSubtitleLanguage(e)})).then((function(){return it.SUCCESS}))}},{key:"setPlaybackSpeed",value:function(e){return this._getTrackPlayer().then((function(t){return t.setPlaybackSpeed(e)})).then((function(e){return e?it.SUCCESS:it.FORBIDDEN}))}},{key:"getStatistics",value:function(){return this._getTrackPlayer().then((function(e){return e.getStatistics()}))}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp),mi=xe.P.forTag("playback.init");function Ei(e){return new Promise((function(t,n){var r,i,a,o,s,c,l;if(e.transport){if("undefined"!=typeof window)("boolean"==typeof window.isSecureContext?window.isSecureContext:function(){if("undefined"==typeof window||!window.location)return!1;var e=window.location;if("https"===e.protocol||"file"===e.protocol)return!0;var t=e.hostname;return!!/^127(\.[0-255]){3}$|^locahost\.?$|\.localhost\.?$/.test(t)}())||null===(r=window.console)||void 0===r||r.warn("%cDRM might not be available from unsecure contexts","background: #222; color: #bada55; font-size: 40px");var u=e.transport,d=(e.sdkId||"").split(":"),p=se()(d,2),_=p[0],f=void 0===_?"":_,h=p[1],v=void 0===h?"":h,y=Object.assign(Object.assign({},e),{tracker:Wr.create(),audioResolver:new jr(u),videoResolver:new Qr(u),licenseURLResolver:new ei({transport:u,sdk:{name:f,version:v},securityLevel:e.securityLevel,useTestLicenseServer:e.useTestLicenseServer}),newBufferPerTrack:null===(i=e.newBufferPerTrack)||void 0===i||i,preinitMediaElement:null===(a=e.preinitMediaElement)||void 0===a||a});e.unauthenticatedLogs&&!(null===(o=e.loggerOptions)||void 0===o?void 0:o.endpoint)&&(e.loggerOptions=Object.assign(Object.assign({},e.loggerOptions),{endpoint:"https://spclient.wg.spotify.com/melody/unauth"})),(null===(s=null==e?void 0:e.loggerOptions)||void 0===s?void 0:s.deviceInfo)||Promise.all([null===(c=e.loggerOptions)||void 0===c?void 0:c.platform,null===(l=e.loggerOptions)||void 0===l?void 0:l.clientVersion]).then((function(t){var n=se()(t,2),r=n[0],i=n[1];e.loggerOptions=Object.assign(Object.assign({},e.loggerOptions),{deviceInfo:{platform:r,version:i}})})),Tr.create(y).then((function(t){var n=Object.assign({disableMux:!0},e.loggerOptions),r=function(e){return new ti(e)}(Object.assign(Object.assign({},n),{transport:u,sdkId:e.sdkId,platform:Promise.resolve(n.deviceInfo).then((function(e){var t;return null!==(t=null==e?void 0:e.platform)&&void 0!==t?t:""})),clientVersion:Promise.resolve(n.deviceInfo).then((function(e){var t;return null!==(t=null==e?void 0:e.version)&&void 0!==t?t:""}))})),i=Mr.create({transport:u,player:t,logSender:r});return n.disableMux||_i.create({player:t,mux:st,envKey:null==n?void 0:n.muxEnvKey,sdk:f,sdkVersion:v,deviceInfo:n.deviceInfo,muxCustomDimensions:n.muxCustomDimensions}).ready().then((function(){return mi.info("MuxReporter ready")}),(function(e){return mi.error("Failed to instantiate MuxReporter",null==e?void 0:e.message)})),{player:t,logger:i}})).then(t,n)}else n(new TypeError("Argument transport is required."))}))}function bi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Si=function(e){m()(n,e);var t=bi(n);function n(e){var r;return _()(this,n),(r=t.call(this))._client=e.client,r._initialVolume=e.initialVolume,r._listPlayer=e.listPlayer,r._playerPromise=e.playerPromise,r._playbackServiceClient=e.playbackServiceClient,r._playbackStateObserver=e.playbackStateObserver,r._stopOnBackground=e.stopOnBackground,r._init(),r}return h()(n,[{key:"_init",value:function(){var e,t,n,r,a,o=this;this._client.addListeners((e={},i()(e,"before_disconnect",this._onClientBeforeDisconnect.bind(this)),i()(e,"before_offline_disconnect",this._onClientBeforeOfflineDisconnect.bind(this)),e));var s=this._listPlayer;s.addListeners((t={},i()(t,nt.LIST_PLAYER_CAPPED,this._onCapped.bind(this)),i()(t,nt.LIST_PLAYER_TRACK_ENDED,this._onTrackEnded.bind(this)),i()(t,nt.LIST_PLAYER_BEFORE_VOLUME_CHANGE,this._onBeforeVolumeChange.bind(this)),i()(t,nt.LIST_PLAYER_VOLUME_CHANGED,this._onVolumeChanged.bind(this)),i()(t,nt.LIST_PLAYER_ERROR,(function(e){o._onError(e,ue.PLAYBACK)})),t)),this.proxyEmitAll(s,(n={},i()(n,nt.LIST_PLAYER_AUTOPLAY_FAILED,"autoplay_failed"),i()(n,nt.LIST_PLAYER_TRACK_LOADED,"track_loaded"),i()(n,nt.LIST_PLAYER_DURATION_CHANGED,"duration_changed"),i()(n,nt.LIST_PLAYER_POSITION_CHANGED,"position_changed"),i()(n,nt.LIST_PLAYER_PROGRESS,"progress"),i()(n,nt.LIST_PLAYER_BUFFER_STALLED,"stalled"),i()(n,nt.LIST_PLAYER_BUFFERING_END,"buffering_end"),i()(n,nt.LIST_PLAYER_BUFFERING_START,"buffering_start"),i()(n,nt.LIST_PLAYER_MAX_LIST_ERRORS_REACHED,"max_list_errors_reached"),i()(n,nt.LIST_PLAYER_VIDEO_ELEMENT_APPENDED,"video_element_appended"),i()(n,nt.LIST_PLAYER_VIDEO_ELEMENT_REMOVED,"video_element_removed"),i()(n,nt.LIST_PLAYER_LIST_ENDED,"context_ended"),i()(n,nt.LIST_PLAYER_SEEK_HANDLED,"streamer_seek_handled"),i()(n,nt.LIST_PLAYER_DISPLAYED_CUES_CHANGED,"displayed_cues_changed"),i()(n,nt.LIST_PLAYER_SUBTITLE_LANGUAGES_LOADED,"subtitle_languages_loaded"),i()(n,nt.LIST_PLAYER_PLAYBACK_SPEED_CHANGED,"speed_changed"),n));var c=this._playbackServiceClient;c.addListeners((r={},i()(r,"logout",this._onPlaybackClientLogout.bind(this)),i()(r,"error",(function(e){o._onError(e,e.data.source)})),r)),this.proxyEmitAll(c,(a={},i()(a,"max_subscriptions_reached","max_subscriptions_reached"),i()(a,"deregistered","deregistered"),i()(a,"registered","registered"),i()(a,"registration_aborted","registration_aborted"),i()(a,"internal_endcontent","internal_endcontent"),a)),this.proxyEmit(this._playbackStateObserver,"state_changed","state_changed"),this._stopOnBackground&&document.addEventListener&&document.addEventListener("visibilitychange",(function(){document.hidden&&o.stop()&&o.emitSync("stopped_on_background",null)})),this._playerPromise.then((function(e){e.setVolume(o._initialVolume),o.emit("player_initialization_done",null)}),(function(e){o.emit("player_initialization_failed",{reason:e.message,error:e})}))}},{key:"_assertOperationSuccess",value:function(e){return e===it.SUCCESS}},{key:"_onTrackEnded",value:function(){this.emit("track_ended",null)}},{key:"_onClientBeforeDisconnect",value:function(e){e.data.awaitPromise(this.deregister().catch((function(){})))}},{key:"_onClientBeforeOfflineDisconnect",value:function(e){e.data.awaitPromise(this.pause().catch((function(){})))}},{key:"_onBeforeVolumeChange",value:function(e){var t;this.emitSync("before_volume_change",{volume:e.data.volume,remote:!!(null===(t=e.data.options)||void 0===t?void 0:t.commandId)}).defaultPrevented&&e.preventDefault()}},{key:"_onVolumeChanged",value:function(e){this.emit("volume_changed",{volume:e.data.volume,remote:!!e.data.commandId})}},{key:"_onCapped",value:function(){this.emit("playback_capped",null)}},{key:"_onError",value:function(e,t){var n=e.data.error;n&&(n&&"registration"in n&&n.registration&&t===ue.TRACK_PLAYBACK&&this.emit("registration_error",{error:n}),this.emit("error",{source:t,error:n}),this._client.notifyError(t,n))}},{key:"_onPlaybackClientLogout",value:function(){this.emit("logged_out",null)}},{key:"stop",value:function(){return this._playbackServiceClient.stop()}},{key:"register",value:function(){return this._playbackServiceClient.register()}},{key:"deregister",value:function(){return this._playbackServiceClient.deregister()}},{key:"resume",value:function(){return this._listPlayer.resume().then(this._assertOperationSuccess)}},{key:"pause",value:function(){return this._listPlayer.pause().then(this._assertOperationSuccess)}},{key:"nextTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae.FORWARD_BUTTON;return this._listPlayer.next(e).then(this._assertOperationSuccess)}},{key:"canChangeTrack",value:function(){return this._listPlayer.canChangeTrack()}},{key:"previousTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae.BACK_BUTTON;return this._listPlayer.previous(e).then(this._assertOperationSuccess)}},{key:"togglePlay",value:function(){return this._listPlayer.togglePlay().then(this._assertOperationSuccess)}},{key:"setVolume",value:function(e){return this._listPlayer.setVolume(e).then(this._assertOperationSuccess)}},{key:"getVolume",value:function(){return this._listPlayer.getVolume()}},{key:"seek",value:function(e){return this._listPlayer.seek(e).then(this._assertOperationSuccess)}},{key:"getCurrentState",value:function(){return this._playbackStateObserver.getCurrentState()}},{key:"getVideoVariants",value:function(){return this._playerPromise.then((function(e){return e.getVideoVariants()}))}},{key:"setPreferredBitrate",value:function(e){var t=this;return this._playerPromise.then((function(n){return n.setPreferredBitrate(e).then(t._assertOperationSuccess)}))}},{key:"setVideoResolution",value:function(e){return this._playerPromise.then((function(t){return t.setVideoResolution(e)}))}},{key:"setBackgrounded",value:function(e){return this._playerPromise.then((function(t){return t.setBackgrounded(e)}))}},{key:"activateElement",value:function(){return this._playerPromise.then((function(e){return e.activateElement()}))}},{key:"hideSubtitles",value:function(){return this._listPlayer.hideSubtitles().then(this._assertOperationSuccess)}},{key:"showSubtitles",value:function(){return this._listPlayer.showSubtitles().then(this._assertOperationSuccess)}},{key:"areSubtitlesShown",value:function(){return this._listPlayer.areSubtitlesShown()}},{key:"getSubtitleLanguages",value:function(){return this._listPlayer.getSubtitleLanguages()}},{key:"getActiveSubtitleLanguage",value:function(){return this._listPlayer.getActiveSubtitleLanguage()}},{key:"setSubtitleLanguage",value:function(e){return this._listPlayer.setSubtitleLanguage(e).then(this._assertOperationSuccess)}},{key:"getMediaConfig",value:function(){return this._listPlayer.getMediaConfig()}},{key:"setPlaybackSpeed",value:function(e){return this._listPlayer.setPlaybackSpeed(e).then(this._assertOperationSuccess)}},{key:"deactivateSubtitleEvents",value:function(){return this._listPlayer.deactivateCueEvents().then(this._assertOperationSuccess)}},{key:"activateSubtitleEvents",value:function(){return this._listPlayer.activateCueEvents().then(this._assertOperationSuccess)}}]),n}(ce.vp);function Ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var ki,Pi=function(e){m()(n,e);var t=Ri(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).status=-1,i.maxedSubscriptions=!1,i.unrecoverable=!1,i.debug={},i.registration=!1,i.code=e,i.name="TrackPlayerAPIClientError",i}return h()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(ve()(Error)),Ti=function(){function e(t,n){_()(this,e),this._stateMachine=null,this._currentState=null,this._currentStateIndex=null,this._pausedState=!1,this._initialPlaybackPosition=null,this._uri=t,this._manifestTrackResolver=n}return h()(e,[{key:"setPaused",value:function(e){this._pausedState=e}},{key:"isPaused",value:function(){return this._currentStateIndex&&this._currentStateIndex<0&&this._currentState&&this._currentState.transitions.advance?!!this._currentState.transitions.advance.paused:this._pausedState}},{key:"setInitialPosition",value:function(e){this._initialPlaybackPosition=e}},{key:"setStateMachine",value:function(e){this._stateMachine=e}},{key:"setDeviceId",value:function(e){this._deviceId=e}},{key:"startAtState",value:function(e){var t=this._stateMachine&&this._stateMachine.states[e.state_index];if(!t)throw new Pi(ne.TP_MISSING_INITIAL_STATE,"Invalid state reference.");var n=t.transitions;this._currentStateIndex=-1,this._currentState={decoy:!0,paused:!!e.paused,track:-1,state_id:null,transitions:{advance:e,show_next:n.show_next,show_prev:n.show_prev,skip_next:e,skip_prev:n.skip_prev},duration_override:t.duration_override,position_offset:t.position_offset}}},{key:"setCurrentState",value:function(e){var t=e.state_index;this._currentStateIndex=t,this._currentState=this._stateMachine&&this._stateMachine.states[t]}},{key:"getStateMachine",value:function(){return this._stateMachine}},{key:"getInternalStateRef",value:function(){var e=this._pausedState,t=this._currentStateIndex;if(!t)return null;if(t&&t<0){var n=this._currentState&&this._currentState.transitions.advance;n&&(t=n.state_index,e=!!n.paused)}return{paused:e,state_index:t}}},{key:"getStateRef",value:function(){var e,t,n=this._stateMachine;if(!n||null===this._currentStateIndex)return null;if(this._currentStateIndex<0){var r=this._currentState&&this._currentState.transitions.advance;r&&(e=n.states[r.state_index],t=r.paused)}else e=n.states[this._currentStateIndex],t=this._pausedState;return e?{state_machine_id:n.state_machine_id,state_id:e.state_id,paused:!!t}:null}},{key:"getCurrentTrack",value:function(){var e,t=this._stateMachine;if(!t||null===this._currentStateIndex)return null;if(this._currentStateIndex<0){var n=this._currentState&&this._currentState.transitions.advance;n&&(e=t.states[n.state_index])}else e=t.states[this._currentStateIndex];return e?t.tracks[e.track]:null}},{key:"startAt",value:function(){return Promise.resolve(it.SUCCESS)}},{key:"setShuffle",value:function(){return Promise.resolve(it.SUCCESS)}},{key:"setRepeatMode",value:function(){return Promise.resolve(it.SUCCESS)}},{key:"next",value:function(e){var t=this._currentState,n=null;if(t){var r=t.transitions;if(e.reason===ae.FORWARD_BUTTON)"skip_next"in r&&(n=r.skip_next);else"advance"in r&&(n=r.advance)}return this._transitionTo(e,n,!1)}},{key:"peekNext",value:function(e){var t=this._currentState,n=null;if(t){var r=t.transitions;if(e.reason===ae.FORWARD_BUTTON)"skip_next"in r&&(n=r.skip_next);else"advance"in r&&(n=r.advance)}return this._transitionTo(e,n,!0)}},{key:"previous",value:function(e){var t=this._currentState,n=null;t&&(n=t.transitions.skip_prev);return this._transitionTo(e,n,!1)}},{key:"translatePosition",value:function(e){var t,n;return(null!==(n=null===(t=this._currentState)||void 0===t?void 0:t.position_offset)&&void 0!==n?n:0)+e}},{key:"translateDuration",value:function(e){var t,n;return null!==(n=null===(t=this._currentState)||void 0===t?void 0:t.duration_override)&&void 0!==n?n:e}},{key:"handleSeek",value:function(e,t){var n;return(null===(n=this._currentState)||void 0===n?void 0:n.duration_override)&&t.reason!==ae.REMOTE?t.listConstants.IGNORE:e}},{key:"allowSeeking",value:function(){return!!this._currentState&&!this._currentState.disallow_seeking}},{key:"_transitionTo",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i){var a,o=e.reason,s=e.listConstants;if(!t)return i(s.FORBIDDEN);var c=n._stateMachine;if(!c)return i(s.NULL_VALUE);var l=c.states[t.state_index];if(!l)return i(s.NULL_VALUE);var u=c.tracks[l.track];if(!(null===(a=null==u?void 0:u.metadata)||void 0===a?void 0:a.uri))return i(s.NULL_VALUE);if(!n._currentState)return i(s.NULL_VALUE);var d=n._currentState,p=d.decoy?!!d.paused:t.paused;r||(n._currentState=l,n._currentStateIndex=t.state_index,n._pausedState=!!p);var _=0;return r||null===n._initialPlaybackPosition?"initial_playback_position"in l&&(_=l.initial_playback_position||0):(_=n._initialPlaybackPosition,n._initialPlaybackPosition=null),n._manifestTrackResolver.resolveFromStateTrack(u).then((function(e){if(!e)return i(s.NULL_VALUE);var t=n._uri;u.metadata&&u.metadata.context_uri&&(t=u.metadata.context_uri);var r=o,a=u.ms_played_until_update,c={playbackQuality:e.playbackQuality,hifiStatus:e.hifi_status},d={uri:e.uri,playableURI:e.uri,fileId:e.fileId,resolvedURL:e.resolvedURL,playable:e.playable,isAd:e.isAd,format:e.format,fileFormat:e.fileFormat,mediaType:e.mediaType,noManifest:e.noManifest,metadata:c,options:{position:_,paused:p,playedThreshold:a},logData:{noLog:!!e.noLog,noTSV:!!e.noTSV,noStats:!!e.noStats,deviceId:n._deviceId,playbackId:l.state_id?l.state_id:void 0,reason:r,displayTrack:e.uri,playContext:t,impressionURL:e.impressionURL,impressionURLs:e.impressionURLs,format:{codec:e.format,bitrate:e.bitrate},uriType:e.uriType,displayTitle:u.metadata.name,displayGroup:u.metadata.group_name,displayDuration:u.metadata.duration},stateId:l.state_id?l.state_id:void 0};return i(d)}))}))}},{key:"getCurrentState",value:function(){return this._currentState}}],[{key:"create",value:function(t,n){return new e(t,n)}}]),e}();!function(e){e.ON="ON",e.OFF="OFF",e.NONE="NONE"}(ki||(ki={}));var Ai=/^disallow_([^]+)_reasons$/;function Ci(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var wi,Ii=xe.P.forTag("tp.stream.PlaybackStateObserver"),Li=function(e){m()(n,e);var t=Ci(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _()(this,n),(r=t.call(this))._tpApiClient=e,r._numPreviousTracks=i.numPrevious||2,r._numNextTracks=i.numNextTracks||2,r._currentState=null,r._init(),r}return h()(n,[{key:"_init",value:function(){this._tpApiClient.on("state_changed",this._onStateChanged.bind(this)),this._tpApiClient.on("state_cleared",this._onStateCleared.bind(this))}},{key:"_onStateChanged",value:function(e){var t,n,r,i,a,o,s,c,l,u=e.data,d=u.stateMachine,p=u.stateRef,_=u.position,f=u.paused,h=u.loading,v=u.currentTrackInfo,y=null==d?void 0:d.states;if(d&&(null==y?void 0:y.length)&&p){var g=y[p.state_index],m=d.tracks[null==g?void 0:g.track];if(g&&m){var E=null!==(t=v.duration)&&void 0!==t?t:0,b=this._createTrackWindow(d,g,E);E||(E=null!==(r=null===(n=b.current_track)||void 0===n?void 0:n.duration_ms)&&void 0!==r?r:0);var S=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&"disallow_resuming_reasons"!==r&&"disallow_pausing_reasons"!==r&&(n[r]=e[r]);return t?n.disallow_pausing_reasons=["already_paused"]:n.disallow_resuming_reasons=["not_paused"],n}(g.restrictions||{},f),R=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],i=!(!r||!r.length);t[n.replace(Ai,"$1")]=i}return t}(S),k={timestamp:Date.now(),context:{uri:null!==(a=null===(i=m.metadata)||void 0===i?void 0:i.context_uri)&&void 0!==a?a:null,metadata:{}},position:_,duration:E,paused:f,playback_quality:null!==(o=v.playbackQuality)&&void 0!==o?o:li.UNKNOWN,playback_features:{hifi_status:null!==(s=v.hifiStatus)&&void 0!==s?s:ki.NONE,change_playback_speed:null!==(c=v.changePlaybackSpeed)&&void 0!==c&&c},shuffle:this._getShuffleSetting(d),repeat_mode:this._getRepeatSetting(d),track_window:b,restrictions:S,disallows:R,loading:h,playback_speed:v.playbackSpeed,playback_id:g.state_id};(null===(l=m.metadata)||void 0===l?void 0:l.context_description)&&(k.context.metadata.context_description=m.metadata.context_description),this._currentState=k,this.emit("state_changed",{state:k?Object.assign({},k):null})}else Ii.warn("_onStateChanged called with no current state or track",e)}else Ii.warn("_onStateChanged called with no current state",e)}},{key:"_createTrackWindow",value:function(e,t,n){var r=this,i=e.states;return{current_track:this._getTrackMetadata(e,t,n),next_tracks:this._getNextStates(t,i).map((function(t){return r._getTrackMetadata(e,t,null)})).filter((function(e){return!!e})),previous_tracks:this._getPreviousStates(t,i).map((function(t){return r._getTrackMetadata(e,t,null)})).filter((function(e){return!!e}))}}},{key:"_onStateCleared",value:function(){this._currentState=null,this.emit("state_changed",{state:null})}},{key:"_getRepeatSetting",value:function(e){var t=e.attributes.options;return t.repeating_track?de.TRACK:t.repeating_context?de.CONTEXT:de.OFF}},{key:"_getShuffleSetting",value:function(e){return e.attributes.options.shuffling_context}},{key:"_getNextStates",value:function(e,t){for(var n=this._numNextTracks,r=[],i=e;i&&"show_next"in i.transitions&&i.transitions.show_next;){var a=t[i.transitions.show_next.state_index];if(a&&r.push(a),i=a,r.length>=n)break}return r}},{key:"_getPreviousStates",value:function(e,t){for(var n=this._numPreviousTracks,r=[],i=e;i&&"show_prev"in i.transitions&&i.transitions.show_prev;){var a=t[i.transitions.show_prev.state_index];if(a&&r.unshift(a),i=a,r.length>=n)break}return r}},{key:"_getTrackMetadata",value:function(e,t,n){var r=null==e?void 0:e.tracks[t.track];if(!(null==r?void 0:r.metadata))return null;var i=r.metadata,a=r.manifest&&"manifest_ids_video"in r.manifest,o=r.track_type.toLowerCase(),s=D.from(i.uri),c=i.linked_from_uri?D.from(i.linked_from_uri):null;return{id:s?D.hexToId(s.id):null,uri:i.uri,type:(null==s?void 0:s.type)||"unknown",uid:t.track_uid,linked_from:{uri:i.linked_from_uri||null,id:c?D.hexToId(c.id):null},media_type:a?"video":"audio",track_type:o,name:i.name,duration_ms:n||i.duration,artists:i.authors,album:{uri:i.group_uri,name:i.group_name,images:i.images},is_playable:!0}}},{key:"getCurrentState",value:function(){var e=this._currentState;if(e&&!e.paused){var t=Date.now(),n=e.position+(t-e.timestamp);e.position=n,e.timestamp=t}return Promise.resolve(this._currentState?Object.assign({},this._currentState):null)}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}(ce.vp);function Oi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Di(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Di(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Di(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ni,Mi=/^https:\/\//,Ui=(wi={},i()(wi,De.FILE_URLS_MP3,at.MP3),i()(wi,De.FILE_URLS_EXTERNAL,at.MP3),i()(wi,De.FILE_IDS_MP3,at.MP3),i()(wi,De.FILE_IDS_MP4,at.MP4),i()(wi,De.FILE_IDS_MP4_DUAL,at.MP4),i()(wi,De.FILE_IDS_CBCS,at.MP4_CBCS),i()(wi,De.FILE_IDS_MP4FLAC,at.MP4_FLAC),i()(wi,De.MANIFEST_IDS_VIDEO,at.MANIFEST_ID),wi),xi=function(){function e(t){_()(this,e),this._descriptor=t.descriptor,this._listPlayer=t.listPlayer}return h()(e,[{key:"_resolveFromStateTrack",value:function(e,t,n){var r,i,a,o,s,c=e.manifest,l=e.metadata.uri,u=D.from(l),d=null,p=Oi(n);try{for(p.s();!(s=p.n()).done;){var _=s.value,f=c[_];if(f){var h,v=Oi(f);try{for(v.s();!(h=v.n()).done;){var y=h.value;if(y.file_id||Mi.test(null!==(r=y.file_url)&&void 0!==r?r:"")){var g=!(!u||u.type!==D.Type.AD&&u.type!==D.Type.INTERRUPTION);if(_!==De.FILE_IDS_MP3||g){var m=void 0;m=y.track_type?y.track_type.toLowerCase():_===De.MANIFEST_IDS_VIDEO?"video":"audio";var E=void 0;if(y.format){var b=parseInt(y.format,10);Mn[b]&&(E=b)}var S=null!==(i=y.bitrate)&&void 0!==i?i:_===De.FILE_IDS_MP4FLAC?1411200:128e3,R=null!==(a=y.bitrate)&&void 0!==a?a:_===De.FILE_IDS_MP4FLAC?7e5:128e3,k=Ui[_];if(d={uri:l,uriType:u&&u.type?u.type:void 0,fileId:null!==(o=y.file_id)&&void 0!==o?o:"",resolvedURL:y.file_url,mediaType:m,format:k,bitrate:R,fileFormat:null!=E?E:void 0,playbackQuality:y.audio_quality,hifi_status:y.hifi_status,impressionURL:y.impression_url,impressionURLs:y.impression_urls,isAd:g,noLog:!1,noTSV:g,noStats:g,noManifest:k===at.MP3,playable:!0},_===De.MANIFEST_IDS_VIDEO||S<=t)return d}}}}catch(P){v.e(P)}finally{v.f()}}}}catch(P){p.e(P)}finally{p.f()}return d}},{key:"resolveFromStateTrack",value:function(e){var t=this;return Promise.all([Promise.resolve(this._descriptor),this._listPlayer.getCurrentBandwidth()]).then((function(n){var r=se()(n,2),i=r[0],a=r[1];return t._resolveFromStateTrack(e,a,i.getManifestFormats())}))}}],[{key:"create",value:function(t){return new e(t)}}]),e}(),Fi=n(75);function ji(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}!function(e){e.TRACK_DATA_FINALIZED="track_data_finalized",e.DEREGISTER="deregister",e.REGISTER="register",e.BEFORE_TRACK_LOAD="before_track_load",e.CAPPED="capped",e.ERROR="error",e.PAUSE="pause",e.RESUME="resume",e.PLAYED_THRESHOLD_REACHED="played_threshold_reached",e.POSITION_CHANGED="position_changed",e.SPEED_CHANGED="speed_changed",e.STARTED_PLAYING="started_playing",e.PROGRESS="progress",e.PING="ping",e.MODIFY_CURRENT_STATE="modify_current_state",e.STATE_CLEAR="state_clear"}(Ni||(Ni={}));var Bi=xe.P.forTag("tpapiclient"),Yi=xe.P.forTag("tpapiclient.endsong"),Vi=xe.P.forTag("tpapiclient.endsongs"),Ki=/^hm:\/\/track-playback\/v1/,Hi=/^hm:\/\/play-token\/lost/,Gi=function(e,t){var n=e.getStatusFamily();return n===t.SERVER_ERROR||n===t.CONNECTION_ERROR},qi={condition:Gi,maxRetries:8},Wi={condition:Gi,maxRetries:2},zi=function(e){m()(n,e);var t=ji(n);function n(e){var r;return _()(this,n),(r=t.call(this))._deviceId=null,r._sequenceNumber=0,r._currentContext=null,r._loading=!1,r._lastSentStateUpdatePayload=null,r._isSendingConflict=!1,r._queuedRejectedStates=[],r._isSendingUpdate=!1,r._queueSendUpdate=[],r._currentTrackInfo={},r._registered=!1,r._isDeregistering=!1,r._waitingForTrackingData=(0,pe.$)(),r._lastProcessedStateId=null,r._limitStateUpdates=!1,r._lastUpdateStateTime=0,r._initialUpdateSent=!1,r._startedPlayingUpdateSent=!1,r._nextFinalizedDataPayload=null,r._switchingContext=!1,r._connectionId=null,r._transport=e.transport,r._logger=e.logger,r._endpoint=e.endpoint||"http://@webgate/track-playback",r._listPlayer=e.listPlayer,r._ListClass=e.ListClass,r._currentGaiaVolume=e.initialVolume*fe,r._clientVersion=e.clientVersion,r._manifestTrackResolver=e.manifestTrackResolver,r._descriptorPromise=Promise.resolve(e.descriptor),r._init(),r._performCommand=r._performCommand.bind(y()(r)),r._handleRegisterResponse=r._handleRegisterResponse.bind(y()(r)),r._handleStateConflictResponse=r._handleStateConflictResponse.bind(y()(r)),r.register=r.register.bind(y()(r)),r._parseDescriptor=r._parseDescriptor.bind(y()(r)),r._volumeDebouncer=new Fi.d(r._sendVolume.bind(y()(r)),{blockInitial:!0}),r}return h()(n,[{key:"_init",value:function(){var e,t=this;this._waitingForTrackingData=(0,pe.$)(),this._waitingForTrackingData.resolve(!0),this._transport.on(this._transport.EVENT_CONNECTION_ID,this._onConnectionId.bind(this)),this._transport.matchMessages(Hi,this._onPlayTokenLost.bind(this)),this._transport.matchMessages(Ki,this._onTrackPlaybackMessage.bind(this)),this._listPlayer.addListeners((e={},i()(e,nt.LIST_PLAYER_CAPPED,this._onCapped.bind(this)),i()(e,nt.LIST_PLAYER_ERROR_SYNC,this._onError.bind(this)),i()(e,nt.LIST_PLAYER_BEFORE_NEXT,this._onBeforeTrackChange.bind(this)),i()(e,nt.LIST_PLAYER_BEFORE_PREVIOUS,this._onBeforeTrackChange.bind(this)),i()(e,nt.LIST_PLAYER_BEFORE_PLAYER_LOAD,this._onBeforePlayerLoad.bind(this)),i()(e,nt.LIST_PLAYER_PLAYER_LOAD,this._onListPlayerLoad.bind(this)),i()(e,nt.LIST_PLAYER_BEFORE_TRACK_LOAD,this._onBeforeTrackLoad.bind(this)),i()(e,nt.LIST_PLAYER_POSITION_CHANGED,this._onPositionChanged.bind(this)),i()(e,nt.LIST_PLAYER_DURATION_CHANGED,this._onDurationChanged.bind(this)),i()(e,nt.LIST_PLAYER_VOLUME_CHANGED,this._onVolumeChanged.bind(this)),i()(e,nt.LIST_PLAYER_PLAYBACK_SPEED_CHANGED,this._onSpeedChanged.bind(this)),i()(e,nt.LIST_PLAYER_PAUSED,this._onPlayPause.bind(this,!0)),i()(e,nt.LIST_PLAYER_PLAYING,this._onPlayPause.bind(this,!1)),i()(e,nt.LIST_PLAYER_PLAYED_THRESHOLD_REACHED,this._onPlayThresholdReached.bind(this)),i()(e,nt.LIST_PLAYER_PROGRESS,this._onProgress.bind(this)),i()(e,nt.LIST_PLAYER_TRACKING_DATA_CREATED,this._onTrackDataCreatedEvent.bind(this)),i()(e,nt.LIST_PLAYER_TRACKING_DATA_FINALIZED,this._onTrackDataFinalizedEvent.bind(this)),e)),this._descriptorPromise.then((function(e){e.on("descriptor_changed",(function(){t._parseDescriptor(e),t._updateDeviceInfo()}))}))}},{key:"_onBeforeTrackChange",value:function(){var e,t;if(!this._nextFinalizedDataPayload&&!this._switchingContext){var n=null!==(t=null===(e=this._currentContext)||void 0===e?void 0:e.getStateRef())&&void 0!==t?t:null,r=this._generateStatePayload(n,Ni.TRACK_DATA_FINALIZED);this._setSequenceNumber(r),this._nextFinalizedDataPayload=r}}},{key:"_onBeforeTrackLoad",value:function(e){var t;this._loading=!0,this._switchingContext=!1,this._currentTrackInfo.duration=void 0,this._stateEventPositionOverride=null===(t=e.data.newTrack.options)||void 0===t?void 0:t.position}},{key:"_onBeforePlayerLoad",value:function(e){var t,n,r,i,a,o,s,c,l=this._currentContext;if(l){var u=l.getCurrentTrack(),d=null===(t=l.getCurrentState)||void 0===t?void 0:t.call(l),p=null!==(r=null!==(n=null==d?void 0:d.duration_override)&&void 0!==n?n:null==u?void 0:u.metadata.duration)&&void 0!==r?r:0,_=e.data,f=_.track.metadata||{},h=this._currentTrackInfo.playbackSpeed||1;this._currentTrackInfo={duration:p,mediaType:_.track.mediaType.toUpperCase(),fileFormat:_.track.fileFormat,bitrate:null===(a=null===(i=_.logData)||void 0===i?void 0:i.format)||void 0===a?void 0:a.bitrate,playbackQuality:f.playbackQuality,hifiStatus:f.hifiStatus,changePlaybackSpeed:null!==(s=!(null===(o=_.track.options)||void 0===o?void 0:o.useDefaultPlaybackSpeed))&&void 0!==s&&s,playbackSpeed:(null===(c=e.data.track.options)||void 0===c?void 0:c.useDefaultPlaybackSpeed)?1:h};var v=_.options;l.setPaused(!v.autoplay),this._setCurrentTrackPosition(v&&v.position||0),this._updateState(Ni.BEFORE_TRACK_LOAD),this._startedPlayingUpdateSent=!1,this._initialUpdateSent=!1}}},{key:"_onCapped",value:function(){this._listPlayer.clear(ae.CAPPED),this._currentContext=null,this._updateState(Ni.CAPPED),this._setCurrentTrackPosition(void 0),this._lastProcessedStateId=null,this.emit("state_cleared",null)}},{key:"_onConnectionId",value:function(e){var t=this;this._connectionId=e.data.id,this._isDeregistering||(this._registered=!1,Promise.all([this._listPlayer.getVolume(),this._descriptorPromise.then(this._parseDescriptor)]).then(this.register,(function(e){Bi.info("Skipping registration due to error",e),t.emit("registration_aborted",{reason_error:e,source:ue.TRACK_PLAYBACK})})).catch((function(){})))}},{key:"_onDurationChanged",value:function(e){var t,n=null===(t=this._currentContext)||void 0===t?void 0:t.getCurrentTrack();(null==n?void 0:n.metadata.uri)===e.data.track.uri&&(this._currentTrackInfo.duration=e.data.duration,this._emitStateChanged())}},{key:"_onError",value:function(e){"position"in e.data&&(this._setCurrentTrackPosition(e.data.position),this._updateState(Ni.ERROR))}},{key:"_onSpeedChanged",value:function(e){this._currentTrackInfo.playbackSpeed=e.data.playback_speed,this._updateState(Ni.SPEED_CHANGED)}},{key:"_onPlayPause",value:function(e,t){var n=this._currentContext;n&&(n.setPaused(e),"position"in t.data&&this._setAllTrackPositions(t.data.position),t.data.track.stateId&&this._shouldSendUpdateForEvent(t.data.track.stateId)?this._updateState(e?Ni.PAUSE:Ni.RESUME):(this._lastProcessedStateId=null,this._emitStateChanged()))}},{key:"_onPlayThresholdReached",value:function(e){this._initialUpdateSent=!0,this._setAllTrackPositions(e.data.position),this._updateState(Ni.PLAYED_THRESHOLD_REACHED)}},{key:"_onPlayTokenLost",value:function(){this._listPlayer.pause().catch((function(){}))}},{key:"_onPositionChanged",value:function(e){this._loading||(this._setCurrentTrackPosition(e.data.position),e.data.track&&this._shouldSendUpdateForEvent(e.data.track.stateId)?this._updateState(Ni.POSITION_CHANGED):(this._lastProcessedStateId=null,this._emitStateChanged()))}},{key:"_onProgress",value:function(e){if(!this._loading&&this._currentContext&&(this._setAllTrackPositions(e.data.position),!this._startedPlayingUpdateSent&&e.data.played>1e3&&(this._startedPlayingUpdateSent=!0,this._updateState(Ni.STARTED_PLAYING)),e.data.logData)){var t=this._currentContext.getCurrentTrack(),n=t&&"number"==typeof t.ms_playing_update_interval?t.ms_playing_update_interval:null;this._initialUpdateSent&&null!==n&&n>0&&Date.now()-this._lastUpdateStateTime>n&&this._updateState(Ni.PROGRESS)}}},{key:"_onTrackDataCreatedEvent",value:function(){this._waitingForTrackingData=(0,pe.$)()}},{key:"_onTrackDataFinalizedEvent",value:function(e){var t=this._nextFinalizedDataPayload;t&&(t.playback_stats=e.data.playbackStats,this._updateState(Ni.TRACK_DATA_FINALIZED,t)),this._nextFinalizedDataPayload=null,this._waitingForTrackingData&&this._waitingForTrackingData.resolve(!0)}},{key:"_onListPlayerLoad",value:function(e){this._loading=!1;var t=this._currentContext;t&&(t.setPaused(!e.data.autoplay),this._setCurrentTrackPosition(e.data.position||0))}},{key:"_onTrackPlaybackMessage",value:function(e){var t=e.payloads;Array.isArray(t)&&t.length&&this._performCommand(t[0])}},{key:"_onVolumeChanged",value:function(e){var t;if(this._currentGaiaVolume=e.data.volume*fe,this._registered){var n=null!==(t=e.data.commandId)&&void 0!==t?t:"",r={seq_num:void 0,volume:this._currentGaiaVolume,command_id:n};this._volumeDebouncer.async(r)}}},{key:"_clearSessionData",value:function(){this._connectionId=null,this._sequenceNumber=0,this._currentContext=null,this._lastSentStateUpdatePayload=null,this._isSendingConflict=!1,this._isSendingUpdate=!1,this._queueSendUpdate=[],this._previousTrackPosition=void 0,this._currentTrackPosition=void 0,this._currentTrackInfo={},this._lastProcessedStateId=null,this.emit("state_cleared",null)}},{key:"_createStateRef",value:function(e,t){if(!t)return null;var n=e.states[t.state_index];if(!n)throw new Pi(ne.TP_CANNOT_CREATE_STATE_REF,"Invalid state reference.");return{state_machine_id:e.state_machine_id,state_id:n.state_id,paused:t.paused}}},{key:"_deregisterFromService",value:function(e){var t=this,n=null,r=this._currentContext;r&&(e&&(r.setPaused(!e.playing),this._setAllTrackPositions(e.position)),n=r.getStateRef());var i=this._generateStatePayload(n,Ni.DEREGISTER);this._setSequenceNumber(i);var a="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId);return this._transport.request(a,{authorize:!0,method:"DELETE",payload:JSON.stringify(i),responseType:"json",retry:Wi}).then((function(e){if(200!==e.status&&204!==e.status)return t._registered=!0,!1;var n=e.body;return n&&(n.endsong&&Yi.log(n.endsong),n.endsongs&&(Vi.log(n.endsongs),t.emit("internal_endcontent",{endcontents:n.endsongs}))),t._clearSessionData(),t.emit("deregistered",null),!0}))}},{key:"_emitError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._logger.logJSSDKError({source:"tpapi-client",source_version:ze.tagged,type:e.code,message:e&&e.message,stack:e&&e.stack,json_data:t,json_data_version:"1.0.0"},"object").catch((function(e){Bi.error("Track-Playback Logging Error",e)})),this.emit("error",{error:e,source:ue.TRACK_PLAYBACK})}},{key:"_emitStateChanged",value:function(){var e=this._currentContext;if(e){var t=this._currentTrackPosition||0;void 0!==this._stateEventPositionOverride&&(t=this._stateEventPositionOverride,this._stateEventPositionOverride=void 0),this.emit("state_changed",{position:t,currentTrackInfo:this._currentTrackInfo,stateMachine:e.getStateMachine(),stateRef:e.getInternalStateRef(),paused:e.isPaused(),loading:this._loading})}}},{key:"_generateStatePayload",value:function(e,t){var n=this._currentTrackInfo;return{seq_num:void 0,seq_nums:void 0,state_ref:e,sub_state:{playback_speed:(null==e?void 0:e.paused)?0:this._currentTrackInfo.playbackSpeed||1,position:this._currentTrackPosition,duration:n.duration||void 0,media_type:n.mediaType,bitrate:n.bitrate,audio_quality:n.playbackQuality,format:n.fileFormat},previous_position:this._previousTrackPosition,playback_stats:void 0,rejected_state_refs:void 0,debug_source:t}}},{key:"_handleRegisterResponse",value:function(e){var t;if(429===e.status)return(t=Pi.fatal(ne.TP_MAX_SUBSCRIPTIONS_REACHED,"Max connections reached")).maxedSubscriptions=!0,t.status=e.status,this.emit("max_subscriptions_reached",{error:t}),Promise.reject(t);if(403===e.status&&e.body&&"PREMIUM_REQUIRED"===e.body.error_type?t=Pi.fatal(ne.TP_REGISTRATION_FAILED_NON_PREMIUM,"Cannot register to Track Playback with non-premium user."):200!==e.status?t=Pi.fatal(ne.TP_REGISTRATION_FAILED_WITH_STATUS,"track-playback service responded with status ".concat(e.status," when registering device")):e.body||(t=Pi.fatal(ne.TP_NO_RESPONSE_BODY,"Unexpected empty response body from registration request.")),t)return t.status=e.status,Promise.reject(t);var n=e.body;return n.endsong&&Yi.log(n.endsong),n.endsongs&&(Vi.log(n.endsongs),this.emit("internal_endcontent",{endcontents:n.endsongs})),this._sequenceNumber=n.initial_seq_num,this._registered=!0,this.emit("registered",{deviceId:this._deviceId}),Promise.resolve(!0)}},{key:"_handleStateConflictResponse",value:function(e){var t;if(e.status>=200&&e.status<300){var n=null===(t=e.body)||void 0===t?void 0:t.commands;if(!n||!n.length)return;for(var r=0,i=n.length;r<i;r++)this._performCommand(n[r])}else{var a=new Pi(ne.TP_CONFLICT_REQUEST_FAILED_WITH_STATUS,"Track-Playback service responded with ".concat(e.status));a.status=e.status,this._emitError(a)}}},{key:"_handleStateUpdateResponse",value:function(e,t){var n;if(200!==t.status)return(n=new Pi(ne.TP_PARSE_STATE_UPDATE_FAILED_WITH_STATUS,"Service responded with status ".concat(t.status))).status=t.status,Promise.reject(n);if(!t.body)return(n=new Pi(ne.TP_UPDATE_REQUEST_EMPTY_RESPONSE,"Unexpected empty response body from state update request.")).status=t.status,Promise.reject(n);var r=t.body;r.endsong&&Yi.log(r.endsong),r.endsongs&&(Vi.log(r.endsongs),this.emit("internal_endcontent",{endcontents:r.endsongs}));var i=this._currentContext;if(!i)return Promise.resolve();var a=r.state_machine,o=r.updated_state_ref;return this._isCurrentStateRef(e)?(i.setStateMachine(a),i.setCurrentState(o),this._emitStateChanged(),Promise.resolve()):Promise.resolve()}},{key:"_isCurrentStateRef",value:function(e){var t=this._currentContext?this._currentContext.getStateRef():null;return!t&&!e||!(!t||!e)&&(t.state_machine_id===e.state_machine_id&&t.state_id===e.state_id&&t.paused===e.paused)}},{key:"_logUnsentStateUpdate",value:function(e){Bi.info("Unsent state update.",e),this._logger.logClientEvent({source:"tpapi-client",source_version:ze.tagged,source_vendor:"spotify",event:"unsent-state-update",event_version:"1.0.0",json_data:e},"object").catch((function(e){Bi.error("Track-Playback Logging Error",e)}))}},{key:"_logout",value:function(){var e=this;this._listPlayer.pause().catch((function(){})),this.emit("state_cleared",null),this.deregister().then((function(t){e._currentContext=null,e._setCurrentTrackPosition(void 0),t&&e.emit("logout",null)}))}},{key:"_parseDescriptor",value:function(e){return this._deviceId=e.getId(),this._deviceInfo=e.toTrackPlaybackDeviceInfo(),!0}},{key:"_performCommand",value:function(e){switch(e.type){case"set_volume":this._setVolume(e);break;case"log_out":this._logout();break;case"replace_state":this._replaceState(e);break;case"ping":this._updateState(Ni.PING);break;default:this._emitError(new Pi(ne.TP_UNKNOWN_COMMAND,"Received unknown command."),{command:e})}}},{key:"_rejectState",value:function(e){var t=this,n=this._queuedRejectedStates;if(void 0!==e&&n.push(e),this._registered&&!this._isSendingConflict&&n.length){this._isSendingConflict=!0;var r=n.splice(0,5),i=this._currentContext?this._currentContext.getStateRef():null,a=this._generateStatePayload(i);a.rejected_state_refs=r,this._setSequenceNumbers(a,r.length);var o=function(){t._isSendingConflict=!1,t._rejectState()},s="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId,"/state_conflict");this._transport.request(s,{authorize:!0,method:"POST",headers:{"Content-Type":"application/json"},responseType:"json",payload:JSON.stringify(a),retry:Wi}).then(this._handleStateConflictResponse).then(o,o)}}},{key:"_replaceState",value:function(e){var t,n,r,i=this._listPlayer,a=e.state_machine,o=e.state_ref,s=this._createStateRef(a,o);if(this._isCurrentStateRef(e.prev_state_ref))if(o){var c=null!==(n=null===(t=this._currentContext)||void 0===t?void 0:t.getStateRef())&&void 0!==n?n:null;if(function(e,t){if(!e)throw new Error("Assertion failed: ".concat(t))}(null!==s,"New state reference is null"),this._currentContext&&(null==c?void 0:c.state_id)===s.state_id){var l=this._currentContext;l.setStateMachine(a),l.setCurrentState(o);var u=!1;l.isPaused()!==o.paused&&(u=!0),o.paused?(l.setPaused(!0),i.pause()):(l.setPaused(!1),i.resume());var d=parseInt(e.seek_to,10);l.allowSeeking()&&!isNaN(d)&&(i.seek(d,ae.REMOTE),this._setCurrentTrackPosition(d),u=!0),u?this._emitStateChanged():(this._lastProcessedStateId=null,this._updateState(Ni.MODIFY_CURRENT_STATE))}else{this._lastProcessedStateId=null!==(r=s.state_id)&&void 0!==r?r:null,this._currentContext&&this._onBeforeTrackChange();var p=this._ListClass.create("spotify:app:jsspeaker",this._manifestTrackResolver);p.setStateMachine(a),p.startAtState(o),this._deviceId&&p.setDeviceId(this._deviceId),this._currentContext=p;var _=e.seek_to||0;p.setInitialPosition(_),this._loading=!0,this._switchingContext=!0,i.play(p,{reason:ae.REMOTE})}}else this._clearContextAndState();else this._rejectState(s)}},{key:"_clearContextAndState",value:function(){var e=this._listPlayer;e.pause().catch((function(){})),e.clear(ae.REMOTE),this._currentContext=null,this._updateState(Ni.STATE_CLEAR),this._setAllTrackPositions(void 0),this._lastProcessedStateId=null,this.emit("state_cleared",null),this._loading=!0}},{key:"_sendDevicesRequest",value:function(e,t){var n="".concat(this._endpoint,"/v1/devices");return"PUT"===e&&(n="".concat(n,"/").concat(this._deviceId)),this._transport.request(n,{authorize:!0,method:e||"POST",headers:{"Content-Type":"application/json"},responseType:"json",payload:JSON.stringify(t),retry:qi})}},{key:"_sendVolume",value:function(e){var t="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId,"/volume");return this._setSequenceNumber(e),this._transport.request(t,{authorize:!0,method:"PUT",headers:{"Content-Type":"application/json"},payload:JSON.stringify(e)})}},{key:"_setAllTrackPositions",value:function(e){this._previousTrackPosition=e,this._currentTrackPosition=e}},{key:"_setCurrentTrackPosition",value:function(e){this._previousTrackPosition=this._currentTrackPosition,this._currentTrackPosition=e}},{key:"_setSequenceNumber",value:function(e){return void 0===e.seq_num&&(e.seq_num=++this._sequenceNumber),e}},{key:"_setSequenceNumbers",value:function(e,t){e.seq_nums=[];for(var n=0;n<t;n++)e.seq_nums.push(++this._sequenceNumber);return e}},{key:"_setVolume",value:function(e){var t,n=e.volume/fe;this._listPlayer.setVolume(n,null!==(t=e.command_id)&&void 0!==t?t:"tpcommand-".concat(Date.now()))}},{key:"_shouldSendUpdateForEvent",value:function(e){return!(!e||e===this._lastProcessedStateId)}},{key:"_updateDeviceInfo",value:function(){var e=this;this._registered&&this._deviceInfo&&this._sendDevicesRequest("PUT",this._deviceInfo).then((function(t){204===t.status&&e.emit("registration_updated",null)}))}},{key:"_updateState",value:function(e,t){var n,r,i,a,o=this;if(this._registered)if(t?(i=t.state_ref,a=t):(i=null!==(r=null===(n=this._currentContext)||void 0===n?void 0:n.getStateRef())&&void 0!==r?r:null,a=this._generateStatePayload(i,e)),this._wasStatePayloadSentRecently(a)){if(this._emitStateChanged(),this._isSendingUpdate&&this._limitStateUpdates)return this._logUnsentStateUpdate(a),void this._queueSendUpdate.push(e);this._isSendingUpdate=!0,this._queueSendUpdate=[],this._setSequenceNumber(a),this._lastSentStateUpdatePayload=a;var s=function(){o._isSendingUpdate=!1,o._queueSendUpdate.length&&o._updateState(o._queueSendUpdate[o._queueSendUpdate.length-1]),Bi.info("State update sent.",e,a)},c="".concat(this._endpoint,"/v1/devices/").concat(this._deviceId,"/state");this._lastUpdateStateTime=Date.now(),this._transport.request(c,{authorize:!0,method:"PUT",headers:{"Content-Type":"application/json"},responseType:"json",payload:JSON.stringify(a),retry:qi}).then(this._handleStateUpdateResponse.bind(this,i)).then(s,(function(e){o._emitError(e),s()}))}else Bi.info("State update ignored (duplicate).",a)}},{key:"_wasStatePayloadSentRecently",value:function(e){var t=this._lastSentStateUpdatePayload;if(!t||!t.state_ref||!e.state_ref)return!0;var n=e.state_ref,r=t.state_ref;if(n.paused!==r.paused||n.state_id!==r.state_id||n.state_machine_id!==r.state_machine_id)return!0;var i=e.sub_state,a=t.sub_state;return i.playback_speed!==a.playback_speed||i.position!==a.position||i.duration!==a.duration||e.previous_position!==t.previous_position}},{key:"stop",value:function(){return!(!this._registered||!this._currentContext)&&(this._clearContextAndState(),!0)}},{key:"deregister",value:function(){var e=this;return this._registered?(this._isDeregistering=!0,this._registered=!1,this._listPlayer.getPlayerState().then((function(t){return Promise.all([e._deregisterFromService(t),e._waitingForTrackingData.promise,e._listPlayer.stop().catch((function(){}))]).then((function(t){var n=se()(t,1)[0];return e._isDeregistering=!1,n}))}),(function(){return e._isDeregistering=!1,e._registered=!0,!1}))):Promise.resolve(!1)}},{key:"register",value:function(){var e,t=this;if(this._registered)return Promise.resolve(!1);if(!this._deviceInfo)return Promise.reject(new Error("Need DeviceInfo for device registration."));if(!this._connectionId)return Promise.reject(new Error("Need connection-id for device registration"));var n=this._currentContext;return n&&(e=this._generateStatePayload(n.getStateRef(),Ni.REGISTER),this._setSequenceNumber(e)),this._sendDevicesRequest("POST",{device:this._deviceInfo,outro_endcontent_snooping:"true"==={NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,PRODUCT_NAME:"unknown"}.OUTRO_SNOOPING,connection_id:this._connectionId,client_version:this._clientVersion,previous_session_state:e,volume:this._currentGaiaVolume}).then(this._handleRegisterResponse).catch((function(e){return e&&!e.maxedSubscriptions&&(e.registration=!0,t._emitError(e)),!1}))}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp);function Qi(e,t){var n,r,i,a,o,s,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=e.getSDKId(),u=e.getPublicTransport(),d=e.getLogger(),p=e.getDeviceDescriptor(),_="initialVolume"in c&&void 0!==c.initialVolume?c.initialVolume:1,f=Object.assign(Object.assign({},c),{transport:u,sdkId:e.getUntaggedSDKId(),loggerOptions:{disableMux:null===(i=null!==(r=null===(n=null==c?void 0:c.mux)||void 0===n?void 0:n.disable)&&void 0!==r?r:null==c?void 0:c.disableMux)||void 0===i||i,muxEnvKey:null!==(o=null===(a=null==c?void 0:c.mux)||void 0===a?void 0:a.envKey)&&void 0!==o?o:null==c?void 0:c.muxEnvKey,deviceInfo:p.then((function(e){return{platform_name:e.getPlatformName(),platform:e.getPlatformIdentifier(),version:e.getPlatformVersion(),brand:e.getBrand(),model:e.getModel(),type:e.getType()}})),muxCustomDimensions:null===(s=null==c?void 0:c.mux)||void 0===s?void 0:s.customDimensions,platform:e.getPlatformIdentifier(),clientVersion:e.getPlatformVersion()}}),h=Ei(f).then((function(e){return e.player})),v=h.then((function(e){return e.getMediaConfig()})),y=Promise.all([p,v]).then((function(e){var t=se()(e,2),n=t[0],r=t[1];return n.getCapability("audio_podcasts")&&!c.disableExternalFiles&&n.appendManifestFormat(De.FILE_URLS_EXTERNAL),r.keysystem===rt.FAIRPLAY?n.appendManifestFormat(De.FILE_IDS_CBCS):r.keysystem!==rt.WIDEVINE||c.preferMultiDRMFormat?n.appendManifestFormat(De.FILE_IDS_MP4_DUAL,De.FILE_IDS_MP4):(-1!==r.formats.audio.indexOf('audio/mp4; codecs="flac"')&&n.getCapability("lossless_playback")&&n.appendManifestFormat(De.FILE_IDS_MP4FLAC),n.appendManifestFormat(De.FILE_IDS_MP4,De.FILE_IDS_MP4_DUAL)),r.supports.protected_video&&n.getCapability("video_playback")&&n.prependManifestFormat(De.MANIFEST_IDS_VIDEO),n})),g=gi.create({trackPlayer:h}),m=xi.create({descriptor:p,listPlayer:g}),E=t({initialVolume:_,listPlayer:g,logger:d,transport:u,clientVersion:l,descriptor:y,endpoint:c.endpoint,manifestTrackResolver:m}),b=E.playbackServiceClient,S=E.playbackStateObserver,R="stopOnBackground"in c?c.stopOnBackground:"undefined"==typeof MediaSource;return new Si({client:e,playbackServiceClient:b,playbackStateObserver:S,initialVolume:_,playerPromise:h,listPlayer:g,stopOnBackground:R})}var $i,Xi=n(4109);n(5069);function Zi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}!function(e){e.LOCAL_PLAYER_DISABLED="local_player_disabled",e.STOPPED="stopped",e.REMOTE_ACTIVATED="remote_activated",e.UNKNOWN="unknown"}($i||($i={}));var Ji=function(e){m()(n,e);var t=Zi(n);function n(e,r){var i;return _()(this,n),(i=t.call(this,r)).status=-1,i.maxedSubscriptions=!1,i.unrecoverable=!1,i.debug={},i.code=e,i.name="PlayerAPIClientError",i}return h()(n,null,[{key:"fatal",value:function(e,t){var r=new n(e,t);return r.unrecoverable=!0,r}}]),n}(ve()(Error));function ea(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ta(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ta(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var na=function(){function e(t){_()(this,e),this._transport=t.transport,this._metadataCache=new ct.z6(t.cacheSize||20)}return h()(e,[{key:"_decorateTrackWindow",value:function(e){var t,n,r,i=this._metadataCache,a={current_track:null,next_tracks:[],previous_tracks:[]};e.current_track&&(n=i&&e.current_track&&"uri"in e.current_track&&i.get(e.current_track.uri),a.current_track=Object.assign({uid:e.current_track.uid},n||e.current_track)),t=e.next_tracks.length;for(;t--;)r=e.next_tracks[t],n=i&&r&&"uri"in r&&i.get(r.uri),a.next_tracks[t]=Object.assign({uid:r.uid},n||r);for(t=e.previous_tracks.length;t--;)r=e.previous_tracks[t],n=i&&r&&"uri"in r&&i.get(r.uri),a.previous_tracks[t]=Object.assign({uid:r.uid},n||r);return a}},{key:"_buildTrackList",value:function(e){var t,n=[],r={},i=ea([e.current_track].concat(be()(e.next_tracks),be()(e.previous_tracks)));try{for(i.s();!(t=i.n()).done;){var a=t.value;a&&!r[a.uri]&&n.push(a.uri)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_cacheMetadata",value:function(e){var t,n=[],r=[],i=this._metadataCache,a=ea(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(!i.get(o)){var s=D.from(o);if(s){var c=D.hexToId(s.id);s.type===D.Type.TRACK?r.push(c):s.type===D.Type.EPISODE&&n.push(c)}}}}catch(l){a.e(l)}finally{a.f()}return n.length||r.length?Promise.all([this._requestMultiData("episodes",n),this._requestMultiData("tracks",r)]).then((function(e){var t=se()(e,2),n=t[0],r=t[1];return!!n||!!r})):Promise.resolve(!0)}},{key:"_requestMultiData",value:function(e,t){var n=this;if(!t.length)return Promise.resolve(!1);var r=this._metadataCache,i=["https://@webapi/v1/",e,"?ids=",t.join(","),"&market=from_token"].join("");return this._transport.request(i,{responseType:"json"}).then((function(t){var i;if(200!==t.status)return!1;var a=null===(i=t.body)||void 0===i?void 0:i[e];if(!a)return!1;for(var o=a.length;o--;){var s=a[o];s&&("episodes"===e?s=n._formatEpisodeData(s):(s.track_type="audio",s.media_type="audio"),r&&r.set(s.uri,s),r&&s.linked_from&&s.linked_from.uri&&r.set(s.linked_from.uri,s))}return!0}))}},{key:"_formatEpisodeData",value:function(e){var t="audio"===e.show.media_type?"audio":"video";return{id:e.id,uri:e.uri,type:"episode",media_type:t,track_type:e.show.media_type,name:e.name,artists:[{uri:e.show.uri,name:e.show.publisher}],album:{uri:e.show.uri,name:e.show.name,images:e.images},duration_ms:e.duration_ms||0,is_playable:!0}}},{key:"formatLocalTrack",value:function(e,t){return e&&e.type===D.Type.LOCAL?{uri:e.toURI(),type:"local",uid:t,media_type:"audio",track_type:"audio",name:e.track,artists:[{uri:D.localArtistURI(e.artist).toURI(),name:e.artist}],album:{uri:D.localAlbumURI(e.artist,e.album).toURI(),name:e.album,images:[{url:""}]},duration_ms:e.duration?1e3*e.duration:0,is_playable:!1}:null}},{key:"formatAd",value:function(e,t){if(!e||e.type!==D.Type.AD&&e.type!==D.Type.INTERRUPTION)return null;if(!t||!t.metadata)return null;var n=t.metadata;return{id:e.id,uri:e.toURI(),type:e.type,uid:t.uid,media_type:"audio",track_type:"audio",name:n.advertiser,artists:[{uri:n.click_url,name:n.buttonMessage||n.advertiser}],album:{uri:n.click_url,name:n.advertiser,images:[{url:n.image_url}]},duration_ms:parseInt(n.duration,10),is_playable:!1}}},{key:"decorateTrackWindow",value:function(e,t){var n=this,r=null!=t?t:this._buildTrackList(e);return this._cacheMetadata(r).then((function(t){return t?n._decorateTrackWindow(e):e}))}}],[{key:"create",value:function(t){return new e(t)}}]),e}();function ra(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function ia(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aa(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oa=xe.P.forTag("harmony.controller"),sa=/^disallow_([^]+)_reasons$/,ca={disallow_pausing_reasons:!0,disallow_peeking_next_reasons:!0,disallow_peeking_prev_reasons:!0,disallow_resuming_reasons:!0,disallow_seeking_reasons:!0,disallow_skipping_next_reasons:!0,disallow_skipping_prev_reasons:!0,disallow_toggling_repeat_context_reasons:!0,disallow_toggling_repeat_track_reasons:!0,disallow_toggling_shuffle_reasons:!0,disallow_transferring_playback_reasons:!0},la="premium",ua="on-demand",da={unknown:li.UNKNOWN,default:li.DEFAULT,low:li.LOW,normal:li.NORMAL,normalized:li.NORMAL,high:li.HIGH,veryhigh:li.VERY_HIGH,hifi:li.HIFI},pa={on:ki.ON,off:ki.OFF,none:ki.NONE};function _a(e,t){if(!e)return[];for(var n=[],r=[D.Type.TRACK,D.Type.EPISODE],i=0,a=e.length;i<a;i++){var o=e[i];if(!o)throw new TypeError("Null value inside track array.");var s=void 0;if("string"==typeof o?(s=D.from(o),o={uri:o}):s=D.from(o.uri),!/^spotify:(meta:|delimiter)/.test(o.uri)){if(!s)throw new TypeError("Invalid uri string: ".concat(s));if(-1===r.indexOf(s.type))throw new TypeError("Invalid track uri: ".concat(o.uri))}o.metadata||(o.metadata={}),t&&t.queued&&(o.metadata.is_queued="true"),n.push(o)}return n}function fa(e){if(e){if(/^.+:\/\//.test(e))return e;throw new TypeError("Invalid page url: ".concat(e))}}var ha=function(e){m()(n,e);var t=ra(n);function n(e){var r;return _()(this,n),(r=t.call(this))._suppressed=!1,r._lastDeviceInfoData=null,r._state=null,r._lastPlayerState=null,r._isOrphanedState=!1,r._progressPosition=0,r._lastProgressTs=0,r._trackingIntervalId=0,r._queue=null,r._client=e.client,r._serverTime=e.serverTime,r._version=e.version,r._playerClient=e.playerClient,r._disableProgress=!!e.disableProgress,r._transport=r._client.getPublicTransport(),r._decorate=!!e.decorateTrackWindow,r._metadataDecorator=new na({transport:r._transport}),r._onClientBeforeDisconnect=r._onClientBeforeDisconnect.bind(y()(r)),r._onDeviceStateChanged=r._onDeviceStateChanged.bind(y()(r)),r._onPlayerStateChanged=r._onPlayerStateChanged.bind(y()(r)),r._onProgressTracking=r._onProgressTracking.bind(y()(r)),r._client.on("before_disconnect",r._onClientBeforeDisconnect),r.proxyEmit(r._playerClient,"max_subscriptions_reached","max_subscriptions_reached"),r.proxyEmit(r._playerClient,"devices_changed","devices_changed"),r.proxyEmit(r._playerClient,"registered","registered"),r.proxyEmit(r._playerClient,"deregistered","deregistered"),r._playerClient.on("device_state_changed",r._onDeviceStateChanged),r._playerClient.on("player_state_changed",r._onPlayerStateChanged),r}return h()(n,[{key:"_onClientBeforeDisconnect",value:function(e){e&&e.data.awaitPromise(this._playerClient.deregister().catch((function(){})))}},{key:"_onDeviceStateChanged",value:function(e){var t,n,r=this,i=e.data,a=i.deviceState,o=i.hasOrphanedState,s=!!(null===(n=null===(t=this._lastDeviceInfoData)||void 0===t?void 0:t.deviceInfo)||void 0===n?void 0:n.local);this._lastDeviceInfoData={deviceInfo:a,hasOrphanedState:o},s&&!(null==a?void 0:a.local)&&this._playerClient.getDevices().then((function(e){var t=e.localDevice,n=$i.STOPPED;o?t||(n=$i.LOCAL_PLAYER_DISABLED):n=$i.REMOTE_ACTIVATED,r.emit("device_deactivated",{reason:n})})).catch((function(e){oa.warn("Device deactivation checking failed.",e)})),this._suppressed||this.emit("device_info_changed",this._lastDeviceInfoData)}},{key:"_startProgressTracking",value:function(){this._stopProgressTracking(),this._lastProgressTs=Date.now(),this._onProgressTracking(),this._trackingIntervalId=setInterval(this._onProgressTracking,500)}},{key:"_stopProgressTracking",value:function(){this._trackingIntervalId&&(clearInterval(this._trackingIntervalId),this._trackingIntervalId=0)}},{key:"_onProgressTracking",value:function(){var e,t=Date.now(),n=(null===(e=this._lastPlayerState)||void 0===e?void 0:e.playback_speed)||1;this._progressPosition+=n*(t-this._lastProgressTs),this.emit("progress",{position:this._progressPosition,timestamp:Date.now()}),this._lastProgressTs=t}},{key:"_getLicense",value:function(){return this._client.getProductState().then((function(e){return"premium"===e.product?la:ua})).catch((function(){return ua}))}},{key:"_generatePlayOptions",value:function(e,t){return this._getLicense().then((function(n){var r={license:n};if(!e)return r;if(("index"in e||"trackUID"in e||"trackURI"in e||"pageIndex"in e)&&(r.skip_to={track_uid:e.trackUID,track_index:e.index,track_uri:e.trackURI,page_index:e.pageIndex}),"initialOffset"in e&&(r.seek_to=e.initialOffset),"paused"in e&&(r.initially_paused=e.paused),"alwaysPlaySomething"in e&&(r.always_play_something=e.alwaysPlaySomething),t)return r;r.player_options_override={};var i=r.player_options_override;if("shuffle"in e&&(i.shuffling_context=e.shuffle),"repeatMode"in e)switch(e.repeatMode){case de.CONTEXT:i.repeating_context=!0,i.repeating_track=!1;break;case de.TRACK:i.repeating_track=!0,i.repeating_context=!1;break;case de.OFF:i.repeating_track=!1,i.repeating_context=!1}return r}))}},{key:"_setFilterAndSort",value:function(e,t){t&&t.filter&&e.metadata&&(e.metadata["filtering.predicate"]=t.filter),t&&t.sort&&e.metadata&&(e.metadata["sorting.criteria"]=t.sort)}},{key:"_setMetadataOptions",value:function(e,t){if(t){var n=e.metadata||{};"autoplayCandidate"in t&&(n.autoplay_candidate=t.autoplayCandidate?"true":"false"),e.metadata=n}}},{key:"_generatePlayOrigin",value:function(e){if(e&&e.featureClasses&&!Array.isArray(e.featureClasses))throw new TypeError("PlayOptions playOrigin.featureClasses must be an array of strings.");return{feature_identifier:e&&e.featureIdentifier||"harmony",feature_version:e&&e.featureVersion||this._version,feature_classes:e&&e.featureClasses,view_uri:e&&e.viewURI,external_referrer:e&&e.externalReferrer,referrer_identifier:e&&e.referrerIdentifier}}},{key:"_generateLoggingParams",value:function(e){var t=e.pageInstanceId,n=e.interactionId;return{page_instance_ids:t?[t]:[],interaction_ids:n?[n]:[]}}},{key:"_parseRestrictions",value:function(e){var t={};for(var n in e.restrictions)e.restrictions.hasOwnProperty(n)&&ca[n]?t[n]=e.restrictions[n]:ca[n]&&(t[n]=[]);return t}},{key:"_parseDisallows",value:function(e){var t={},n=e.restrictions;for(var r in n)if(n.hasOwnProperty(r)&&ca[r]){var i=n[r],a=!(!i||!i.length);t[r.replace(sa,"$1")]=a}return t}},{key:"_onPlayerStateChanged",value:function(e){var t=this;this._isOrphanedState=e.data.orphaned,this._parsePlayerState(e.data.playerState).then((function(n){t._state=n,t._suppressed||t.emit("state_changed",{state:n?Object.assign({},n):null,orphaned:e.data.orphaned}),!t._disableProgress&&n&&(t._progressPosition=n.position,n.paused?t._stopProgressTracking():t._startProgressTracking())}))}},{key:"_parsePlayerState",value:function(e){var t=this;return this._lastPlayerState=e,e?this._getTrackWindow(e).then((function(n){var r,i,a,o,s,c,l,u;return{context:{uri:e.context_uri||null,metadata:e.context_metadata||{}},timestamp:e.timestamp,duration:e.duration||n.current_track&&"uri"in n.current_track&&n.current_track.duration_ms||0,position:e.is_paused?e.position_as_of_timestamp:t._offsetPosition(e.timestamp,e.position_as_of_timestamp,null===(r=t._lastPlayerState)||void 0===r?void 0:r.playback_speed),playback_id:null,playback_quality:null!==(o=da[null!==(a=null===(i=e.playback_quality)||void 0===i?void 0:i.bitrate_level)&&void 0!==a?a:"unknown"])&&void 0!==o?o:li.UNKNOWN,playback_features:{hifi_status:pa[null!==(c=null===(s=e.playback_quality)||void 0===s?void 0:s.hifi_status)&&void 0!==c?c:"none"]},paused:!!e.is_paused,shuffle:!(!e.options||!e.options.shuffling_context),repeat_mode:t._getStateRepeatMode(e),restrictions:t._parseRestrictions(e),disallows:t._parseDisallows(e),track_window:n,bitrate:null,loading:null!==(u=null===(l=t._state)||void 0===l?void 0:l.loading)&&void 0!==u&&u}})):Promise.resolve(null)}},{key:"_offsetPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=r||this._serverTime.getApproximate(),a=(i-e)*n,o=t+a;return o<0?0:o}},{key:"_isRestricted",value:function(e,t){if(!e||!e.restrictions)return!1;var n="disallow_".concat(t,"_reasons");return!!(e.restrictions[n]||[]).length}},{key:"_getTrackWindow",value:function(e){var t={current_track:null,next_tracks:[],previous_tracks:[]},n={},r=[];if(!e.track)return Promise.resolve(t);var i=e.track.uri;if(!i)return Promise.resolve(t);var a=this._metadataDecorator,o=D.from(i),s=a.formatLocalTrack(o,e.track.uid),c=a.formatAd(o,e.track);return t.current_track=s||c||{uri:i,uid:e.track.uid,type:o&&o.type?o.type:"unknown"},s||c||(n[i]=1,r.push(i)),this._isRestricted(e,"peeking_next")||this._fillWindow(r,t.next_tracks,n,e.next_tracks?e.next_tracks.slice(0,5):[]),this._isRestricted(e,"peeking_prev")||this._fillWindow(r,t.previous_tracks,n,e.prev_tracks?e.prev_tracks.slice(-5):[],!0),this._decorate?this._metadataDecorator.decorateTrackWindow(t,r):Promise.resolve(t)}},{key:"_fillWindow",value:function(e,t,n,r,i){i&&r.reverse();var a,o=ia(r);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=s.uri,l=D.from(c);if(c&&"spotify:delimiter"!==c&&(!l||l.type!==D.Type.AD&&l.type!==D.Type.INTERRUPTION)){var u=this._metadataDecorator.formatLocalTrack(l,s.uid),d=u||{uri:c,uid:s.uid,type:"unknown"};if(u||c in n||(n[c]=1,e.push(c)),i?t.unshift(d):t.push(d),2===t.length)break}}}catch(p){o.e(p)}finally{o.f()}}},{key:"_getStateRepeatMode",value:function(e){var t=e.options;return t&&t.repeating_track?de.TRACK:t&&t.repeating_context?de.CONTEXT:de.OFF}},{key:"_play",value:function(e,t,n){var r=this;return this._setFilterAndSort(e,n),this._setMetadataOptions(e,n),this._generatePlayOptions(n).then((function(i){var a={context:e,play_origin:r._generatePlayOrigin(n&&n.playOrigin),options:i};return(null==n?void 0:n.loggingParams)&&(a.logging_params=r._generateLoggingParams(n.loggingParams)),r._playerClient.play(a,t)}))}},{key:"getActiveDevice",value:function(){return this._playerClient.getActiveDevice()}},{key:"getCurrentState",value:function(e){var t;if(e&&this._isOrphanedState)return Promise.resolve(null);var n=this._state;if(n&&!n.paused){var r=this._serverTime.getApproximate();n.position=this._offsetPosition(n.timestamp,n.position,null===(t=this._lastPlayerState)||void 0===t?void 0:t.playback_speed,r),n.timestamp=r}return Promise.resolve(n?Object.assign({},n):null)}},{key:"getContextPlayerState",value:function(){return oa.warn("The `getContextPlayerState()` method is not well supported. Please avoid using it directly."),this._playerClient.getContextPlayerState()}},{key:"getDevices",value:function(){return this._playerClient.getDevices()}},{key:"playURI",value:function(e,t,n){if(!D.from(e))return Promise.reject(new TypeError("Invalid Spotify URI"));var r={uri:e,url:"context://".concat(e),metadata:n&&n.contextMetadata||{}};return this._play(r,t,n)}},{key:"playPages",value:function(e,t,n){var r,i;if(!Array.isArray(e))return Promise.reject(new TypeError("Invalid pages array."));try{i=function(e){var t,n,r,i,a=[],o=ia(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;a.push({tracks:Array.isArray(s.tracks)?_a(s.tracks):void 0,page_url:null!==(t=fa(s.pageURL))&&void 0!==t?t:void 0,next_page_url:null!==(n=fa(s.nextPageURL))&&void 0!==n?n:void 0,metadata:null!==(r=s.metadata)&&void 0!==r?r:void 0})}}catch(c){o.e(c)}finally{o.f()}return a}(e)}catch(o){return Promise.reject(o)}var a={uri:null!==(r=null==n?void 0:n.contextURI)&&void 0!==r?r:"spotify:internal:harmony-play-pages",metadata:(null==n?void 0:n.contextMetadata)||{},pages:i};return this._play(a,t,n)}},{key:"playTracks",value:function(e,t,n){var r,i;if(!Array.isArray(e))return Promise.reject(new TypeError("Invalid tracks array."));try{i=_a(e)}catch(o){return Promise.reject(o)}var a={uri:null!==(r=null==n?void 0:n.contextURI)&&void 0!==r?r:"spotify:internal:harmony-play-tracks",metadata:(null==n?void 0:n.contextMetadata)||{},pages:[{tracks:i}]};return this._play(a,t,n)}},{key:"updateCurrentContext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._playerClient.updateCurrentContext(e,t)}},{key:"setQueue",value:function(e,t,n){if(!Array.isArray(e))return Promise.reject(new TypeError("Invalid nextTracks array."));if(!Array.isArray(t))return Promise.reject(new TypeError("Invalid previousTracks array."));var r,i;try{r=_a(e),i=_a(t)}catch(o){return Promise.reject(o)}var a={next_tracks:r.length?r:void 0,prev_tracks:i.length?i:void 0};return this._playerClient.setQueue(a,n)}},{key:"togglePlay",value:function(e){return this._playerClient.togglePlay(e)}},{key:"transfer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._playerClient.transfer(e,t)}},{key:"pause",value:function(e){return this._playerClient.pause(e)}},{key:"resume",value:function(e){return this._playerClient.resume(e)}},{key:"nextTrack",value:function(e,t){var n={};return(null==t?void 0:t.track)&&(n.track=we([t.track])[0]),this._playerClient.nextTrack(e,n)}},{key:"previousTrack",value:function(e,t){var n={};return(null==t?void 0:t.track)&&(n.track=we([t.track])[0]),this._playerClient.previousTrack(e,n)}},{key:"seek",value:function(e,t){return this._playerClient.seek(e,t)}},{key:"setShuffle",value:function(e,t){return this._playerClient.setShuffle(e,t)}},{key:"toggleShuffle",value:function(e){return this._playerClient.toggleShuffle(e)}},{key:"setVolume",value:function(e,t){return this._playerClient.setVolume(e,t)}},{key:"logout",value:function(e){return this._playerClient.logout(e)}},{key:"setRepeatMode",value:function(e,t){var n=this;return this.getCurrentState().then((function(r){if(!r)return Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"));var i=n._playerClient,a=r.disallows;switch(e){case de.OFF:return(!a.toggling_repeat_context||!a.toggling_repeat_track)&&i.setOptions({repeating_context:!!a.toggling_repeat_context&&void 0,repeating_track:!!a.toggling_repeat_track&&void 0},t);case de.CONTEXT:return!a.toggling_repeat_context&&i.setOptions({repeating_context:!0,repeating_track:!!a.toggling_repeat_track&&void 0},t);case de.TRACK:return!a.toggling_repeat_track&&i.setOptions({repeating_context:!a.toggling_repeat_context||void 0,repeating_track:!0},t);default:return Promise.reject(new TypeError("Unknown repeat mode."))}}))}},{key:"register",value:function(){return this._playerClient.register()}},{key:"suppressEvents",value:function(){this._suppressed=!0}},{key:"unsuppressEvents",value:function(){this._suppressed=!1,this._lastDeviceInfoData&&this.emit("device_info_changed",this._lastDeviceInfoData),this._state&&this.emit("state_changed",{state:this._state})}},{key:"getQueueManager",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._queue){var n=t.reportInitial?this._lastPlayerState:null;this._queue=new Le(Object.assign({connectClient:this._playerClient,initialContextPlayerState:n,runner:e},t))}return this._queue}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp),va=n(5298);function ya(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ga(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ga(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ga(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ma(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Ea=/connect-state\/v1\/cluster$/,ba=/^([a-zA-Z0-9_%:-]{1,40}).*$/;function Sa(e){var t,n,r;return!!e.track&&0===(null!==(r=null===(n=null===(t=e.restrictions)||void 0===t?void 0:t.disallow_transferring_playback_reasons)||void 0===n?void 0:n.length)&&void 0!==r?r:0)}var Ra="::a_";function ka(e){if(!e)return{deviceId:null};var t=e.split(Ra),n=se()(t,2),r=n[0],i=n[1];return{deviceId:r,aliasId:i?parseInt(i,10):void 0}}var Pa=function(e){m()(n,e);var t=ma(n);function n(e){var r;return _()(this,n),(r=t.call(this))._autoregister=!0,r._connectionId="",r._localDeviceId="",r._localObserverDeviceId=null,r._lastActiveDevice=null,r._lastKnownPlayerState=null,r._lastKnownDevices=[],r._localDevice=null,r._fetchedInitialState=!1,r._awaitingAcknowledgment={},r._acknowledgementMaps=[],r._lastProcessedTimestamp=0,r._descriptor=e.descriptor,r._transport=e.transport,r._endpoint=e.endpoint||"@webgate/connect-state",r._autoregister=!("autoregister"in e)||!!e.autoregister,r._onConnectionId=r._onConnectionId.bind(y()(r)),r._onClusterMessage=r._onClusterMessage.bind(y()(r)),r._awaitResponseWithAck=r._awaitResponseWithAck.bind(y()(r)),r._transport.on(r._transport.EVENT_CONNECTION_ID,(function(e){r._onConnectionId(e.data.id)})),r._transport.matchMessages(Ea,r._onClusterMessage),r._descriptorPromise=Promise.resolve(r._descriptor).then((function(e){return r._localDeviceId=e.id||"",r._localObserverDeviceId=("hobs_"+r._localDeviceId).replace(ba,"$1"),!0})),r}return h()(n,[{key:"_onConnectionId",value:function(e){this._connectionId=e,this._autoregister&&this.register()}},{key:"_onClusterMessage",value:function(e){var t=e.payloads&&e.payloads[0];if(t){if(t.ack_id){var n=t.ack_id,r=this._awaitingAcknowledgment[n];if(r)r.resolve(!0);else{var i,a=ya(this._acknowledgementMaps);try{for(a.s();!(i=a.n()).done;){i.value[n]=(0,pe.$)()}}catch(o){a.e(o)}finally{a.f()}}}this._parseCluster(t.cluster)}}},{key:"_resolveTargetDevice",value:function(e){var t=this;return this._descriptorPromise.then((function(){var n=t._localDeviceId;return ka(e?e===_e?n:e:t._lastActiveDevice?t._lastActiveDevice.id:n)}))}},{key:"_makeEndpoint",value:function(e,t,n){var r=this;return this._descriptorPromise.then((function(){var i=r._localDeviceId;return"".concat(r._endpoint,"/").concat(e,"/").concat(t,"/from/").concat(i,"/to/").concat(n)}))}},{key:"_sendPlayerCommand",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.endpoint=e;var i={command:r};return this._resolveTargetDevice(n).then((function(e){if(!e.deviceId)throw new Ji(ne.CONNECTAPI_CLIENT_MISSING_DEVICE_ID,"Operation resulted in a null device id");return!i.target_alias_id&&e.aliasId&&(i.target_alias_id=e.aliasId),t._makeEndpoint("v1","player/command",e.deviceId)})).then((function(e){return t._sendRequest(va.n.POST,e,i)})).then(this._awaitResponseWithAck)}},{key:"_sendConnectCommand",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="volume"===e?va.n.PUT:va.n.POST,a="volume"===e||"logout"===e;return this._resolveTargetDevice(n).then((function(n){if(!n.deviceId)throw new Ji(ne.CONNECTAPI_CLIENT_MISSING_DEVICE_ID,"Operation resulted in a null device id");return n.aliasId&&(a?r.command_options={target_alias_id:n.aliasId}:r.target_alias_id||(r.target_alias_id=n.aliasId)),t._makeEndpoint("v1","connect/".concat(e),n.deviceId)})).then((function(e){return t._sendRequest(i,e,r)})).then(this._awaitResponseWithAck)}},{key:"_sendRequest",value:function(e,t,n){var r=this._acknowledgementMaps,i={};r.push(i);var a=function(){var e=r.indexOf(i);-1!==e&&r.splice(e,1)};return this._transport.request(t,{method:e,payload:n?JSON.stringify(n):void 0,responseType:"json",retry:{condition:function(e,t){var n=e.getStatusFamily();return n===t.SERVER_ERROR||n===t.CONNECTION_ERROR}}}).then((function(e){return a(),{response:e,map:i}}),(function(e){return a(),Promise.reject(e)}))}},{key:"_awaitResponseWithAck",value:function(e){var t,n;if(404===e.response.status)return Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_DEVICE,"No such device."));var r=null===(t=e.response.body)||void 0===t?void 0:t.ack_id;if(200===e.response.status&&r){if(null===(n=e.map)||void 0===n?void 0:n[r])return Promise.resolve(!0);var i=(0,pe.$)();return this._awaitingAcknowledgment[r]=i,i.promise}return Promise.resolve(202===e.response.status&&!r)}},{key:"_parseCluster",value:function(e){if(e){var t=parseInt(e.timestamp,10);this._lastProcessedTimestamp>t||(this._lastProcessedTimestamp=t,this._parseClusterDevices(e),this._parseClusterPlayerState(e))}}},{key:"_parseClusterDevices",value:function(e){var t=this._lastActiveDevice;this._lastActiveDevice=null,this._lastKnownDevices=[],this._localDevice=null;var n=[];for(var r in e.devices)e.devices.hasOwnProperty(r)&&n.push(r);if(n.sort(),n.length){var i,a=e.active_device_id,o=ya(n);try{for(o.s();!(i=o.n()).done;){var s,c=i.value,l=e.devices[c],u=this._formatClusterDevice(l,a);(s=this._lastKnownDevices).push.apply(s,be()(u));var d,p=ya(u);try{for(p.s();!(d=p.n()).done;){var _=d.value;_.is_active&&(this._lastActiveDevice=_),_.local&&(this._localDevice=_)}}catch(v){p.e(v)}finally{p.f()}}}catch(v){o.e(v)}finally{o.f()}}if(!this._fetchedInitialState||!me(this._lastActiveDevice,t)){var f=e.player_state,h=f&&Sa(f);this.emit("device_state_changed",{deviceState:this._lastActiveDevice,hasOrphanedState:!this._lastActiveDevice&&!!h,disappeared:!!t&&!this._lastActiveDevice})}this.emit("devices_changed",{devices:this._lastKnownDevices,localDevice:this._localDevice})}},{key:"_formatClusterDevice",value:function(e,t){var n={};if(e&&Array.isArray(e.metadata))for(var r=0,i=e.metadata.length;r<i;r++){var a=e.metadata[r];n[a.type]=a.metadata}var o=e.capabilities||{},s={};"supports_hifi"in o&&(s.hifi_status=o.supports_hifi);var c={hidden:!1,id:e.device_id,is_active:e.device_id===t,is_controllable:!!o.is_controllable,is_observable:!!o.is_observable,local:e.device_id===this._localDeviceId,metadata:n,name:e.name,type:(e.device_type||Ne.UNKNOWN).toLowerCase(),version:e.device_software_version,volume:o.disable_volume?-1:e.volume/fe,capabilities:{supports_lossless_audio:!!o.supports_lossless_audio},is_alias:!1,is_alias_group:!1,playback_features:s,is_group:!!e.is_group,is_being_activated:!1};if(!e.device_aliases)return[c];var l=[];for(var u in e.device_aliases)if(e.device_aliases.hasOwnProperty(u)){var d=e.device_aliases[u];if(d){var p=Object.assign(Object.assign({},c),{id:"".concat(c.id).concat(Ra).concat(d.id),name:d.display_name,is_alias:!0,is_alias_group:e.is_group||d.is_group,is_active:c.is_active&&e.selected_alias_id===d.id,is_group:!!d.is_group});l.push(p)}}return l}},{key:"_parseClusterPlayerState",value:function(e){this._lastKnownPlayerState=null;var t=e.active_device_id,n=t&&e.devices[t],r=e.player_state;r&&r.track&&(n&&n.capabilities&&!n.capabilities.is_observable?r=null:(n||(r.is_paused=!0,r.restrictions&&(delete r.restrictions.disallow_resuming_reasons,r.restrictions.disallow_pausing_reasons=["already_paused"])),r.duration=parseInt(r.duration,10),r.position=parseInt(r.position,10),r.position_as_of_timestamp=parseInt(r.position_as_of_timestamp,10),r.timestamp=parseInt(r.timestamp,10),r.next_tracks=r.next_tracks||[],r.prev_tracks=r.prev_tracks||[]),this._lastKnownPlayerState=r);var i=!n&&!!this._lastKnownPlayerState;i&&r&&!Sa(r)&&(this._lastKnownPlayerState=null,i=!1),this.emit("player_state_changed",{playerState:this._lastKnownPlayerState,orphaned:i,isLocal:!!t&&t===this._localDeviceId})}},{key:"_register",value:function(){var e=this;this._fetchedInitialState=!1;var t="".concat(this._endpoint,"/v1/devices/").concat(this._localObserverDeviceId);return this._connectionId||Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_CONNECTION_ID,"Cannot register: no connection id.")),this._transport.request(t,{method:"PUT",headers:{"X-Spotify-Connection-Id":this._connectionId,Accept:"application/json"},payload:JSON.stringify({member_type:"CONNECT_STATE",device:{device_info:{capabilities:{can_be_player:!1,hidden:!0,needs_full_player_state:!0}}}}),responseType:"json"}).then((function(t){429===t.status?e.emit("max_subscriptions_reached",{error:new Ji(ne.CONNECTAPI_MAX_SUBSCRIPTIONS_REACHED,"Max connections reached")}):200===t.status&&(e.emit("registered",null),t.body&&(e._parseCluster(t.body),e._fetchedInitialState=!0)),429!==t.status&&408!==t.status||(e._lastKnownDevices=e._lastKnownDevices.map((function(e){return e.is_being_activated=!1,e})),e._localDevice&&(e._localDevice.is_being_activated=!1),e.emit("devices_changed",{devices:e._lastKnownDevices,localDevice:e._localDevice}))}))}},{key:"register",value:function(){return this._connectionId?this._descriptorPromise.then(this._register.bind(this)):Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_CONNECTION_ID,"Cannot register: no connection id."))}},{key:"deregister",value:function(){var e=this,t="".concat(this._endpoint,"/v1/devices/").concat(this._localObserverDeviceId);return this._transport.request(t,{method:"DELETE",responseType:"json"}).then((function(t){200===t.status&&e.emit("deregistered",null)}))}},{key:"getDevices",value:function(){var e=this;return this._fetchedInitialState?Promise.resolve({devices:this._lastKnownDevices,localDevice:this._localDevice}):new Promise((function(t){e.once("device_state_changed",(function(){t({devices:e._lastKnownDevices,localDevice:e._localDevice})}))}))}},{key:"getActiveDevice",value:function(){var e=this;return this._fetchedInitialState?Promise.resolve(this._lastActiveDevice):new Promise((function(t){e.once("device_state_changed",(function(e){t(e.data.deviceState)}))}))}},{key:"getContextPlayerState",value:function(){var e=this;return this._fetchedInitialState?Promise.resolve(this._lastKnownPlayerState):new Promise((function(t){e.once("player_state_changed",(function(e){t(e.data.playerState)}))}))}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?this._sendPlayerCommand("play",t,e):Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_INVALID_ARGUMENTS,"Descriptor is required for play commands"))}},{key:"updateCurrentContext",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getContextPlayerState().then((function(r){return r?r.session_id?r.context_url||n.forceNonUpdateable?e._sendPlayerCommand("update_context",t,{context:{url:r.context_url||"context://".concat(r.context_uri)},session_id:r.session_id}):Promise.resolve(!1):Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_SESSION_ID,"The current state does not have a session id")):Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"))}))}},{key:"setQueue",value:function(e,t){return this._sendPlayerCommand("set_queue",t,e)}},{key:"addToQueue",value:function(e,t){return this._sendPlayerCommand("add_to_queue",t,{track:e})}},{key:"togglePlay",value:function(e){var t=this;return this.getContextPlayerState().then((function(n){return n?n.is_paused?t.resume(e):t.pause(e):Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"))}))}},{key:"transfer",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._lastKnownDevices=this._lastKnownDevices.map((function(t){return t.is_being_activated=t.id===e,t})),this._localDevice&&(this._localDevice.is_being_activated=e===_e),this.emit("devices_changed",{devices:this._lastKnownDevices,localDevice:this._localDevice});var i={restore_paused:"restore"};return"paused"in r&&(i.restore_paused=r.paused?"pause":"resume"),this._sendConnectCommand("transfer",e||_e,{transfer_options:i,page_instance_id:null===(t=r.loggingParams)||void 0===t?void 0:t.pageInstanceId,interaction_id:null===(n=r.loggingParams)||void 0===n?void 0:n.interactionId})}},{key:"pause",value:function(e){return this._sendPlayerCommand("pause",e)}},{key:"resume",value:function(e){return this._sendPlayerCommand("resume",e)}},{key:"nextTrack",value:function(e,t){return this._sendPlayerCommand("skip_next",e,t)}},{key:"previousTrack",value:function(e,t){return this._sendPlayerCommand("skip_prev",e,t)}},{key:"seek",value:function(e,t){return isNaN(e)||e<0?Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_INVALID_POSITION,"Invalid position.")):this._sendPlayerCommand("seek_to",t,{value:e})}},{key:"setShuffle",value:function(e,t){return this._sendPlayerCommand("set_shuffling_context",t,{value:!!e})}},{key:"toggleShuffle",value:function(e){var t=this;return this.getContextPlayerState().then((function(n){if(!n)return Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_NO_STATE,"Nothing playing"));var r=n.options&&n.options.shuffling_context;return t.setShuffle(!r,e)}))}},{key:"setRepeatingContext",value:function(e,t){return this._sendPlayerCommand("set_repeating_context",t,{value:e})}},{key:"setRepeatingTrack",value:function(e,t){return this._sendPlayerCommand("set_repeating_track",t,{value:!!e})}},{key:"setOptions",value:function(e,t){return this._sendPlayerCommand("set_options",t,Object.assign({},e))}},{key:"setVolume",value:function(e,t){if(isNaN(e)||e<0)return Promise.reject(new Ji(ne.CONNECTAPI_CLIENT_INVALID_VOLUME,"Invalid volume."));var n=Math.round(e*fe);return this._sendConnectCommand("volume",t,{volume:n})}},{key:"logout",value:function(e){return this._sendConnectCommand("logout",e)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(ce.vp);var Ta=Object.assign(Object.assign(Object.assign({},ne),re.J),Q);function Aa(e){var t,n=e.transport;if(!n)throw new TypeError("No Transport instance provided");var r=function(e){return tt.create(e)}(Object.assign(Object.assign({},e.client),{transport:n,hidden:!!e.hidden,playTokenLostBehavior:e.hidden&&!e.onlyLocalState?"stop":"pause"})),i=e.streamer||{},a=e.controller||{},o=void 0,s=!1;e.streamer&&e.streamer.disabled?(e.hidden=!0,e.onlyLocalState=!1,e.claimInactivePlayerStates=!1,s=!0):(o=function(e){return Qi(e,(function(e){var t=zi.create(Object.assign(Object.assign({},e),{ListClass:Ti}));return{playbackServiceClient:t,playbackStateObserver:Li.create(t)}}),arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(r,i),a.autoregister=!1,e.onlyLocalState&&(a.decorateTrackWindow=!1,a.disableProgress=!0));var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getPublicTransport(),r=e.getVersionDescriptor().tagged,i=Pa.create({autoregister:!("autoregister"in t)||t.autoregister,descriptor:e.getClientDescriptor(),transport:n});return ha.create({client:e,playerClient:i,version:r,serverTime:Xi.X.create(n),decorateTrackWindow:"boolean"!=typeof t.decorateTrackWindow||t.decorateTrackWindow,disableProgress:t.disableProgress})}(r,a);return Ue.create({transport:n,client:r,streamer:o,controller:c,enableControllerWithoutStreamer:s,hidden:e.hidden,onlyLocalState:e.onlyLocalState,claimInactivePlayerStates:e.claimInactivePlayerStates,autoActivateElement:null!==(t=e.autoActivateElement)&&void 0!==t?t:"undefined"!=typeof WebKitMediaKeys,experimentalDeactivateOnStop:e.experimentalDeactivateOnStop})}var Ca=null;function wa(){if(null===Ca)throw new Error("Missing `instance`. Have you called `setTransportInstance` yet?");return Ca}n(6699),n(2023);var Ia=n(1206),La=n.n(Ia);function Oa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Da(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Na="@local",Ma=function(){function e(t,n){_()(this,e),i()(this,"player",null),i()(this,"transport",null),i()(this,"playbackState",null),i()(this,"onConnectCallbacks",[]),i()(this,"onTrackChangeCallbacks",[]),i()(this,"onProgressCallbacks",[]),i()(this,"onVolumeChangeCallbacks",[]),i()(this,"onActiveStateChangeCallbacks",[]),i()(this,"onInitializationFailureCallbacks",[]),i()(this,"onResetCallbacks",[]),i()(this,"onPauseCallbacks",[]),i()(this,"onPlayCallbacks",[]),this.resource=n,this.session=t}return h()(e,[{key:"initialize",value:function(){var e=this,t=function(e){var t=La().getParser(window.navigator.userAgent),n=function(e){switch(e){case"macOS":return"osx";case"Chrome OS":return"chrome";default:return e}}(t.getOSName()||"not_applicable"),r=function(e,t){if("Windows"===e)switch(t){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return""}return t}(n,t.getOSVersion()),i=t.getBrowserName(),a=t.getBrowserVersion();return"web_player ".concat(n," ").concat(r,";").concat(i," ").concat(a,";").concat(e).toLowerCase()}("embed");this.transport=wa(),this.player=Aa({transport:this.transport,client:{descriptor:{id:null,randomizeId:!0,name:"SPB",brand:"spotify",model:O,platform_identifier:t}},streamer:{disallowRobustnessValues:[di.EMPTY]},hidden:!0,onlyLocalState:!0}),this.player.on(le.STATE_CHANGED,(function(t){var n=t.data.state;e.playbackState&&!n?e.onResetCallbacks.forEach((function(e){return e()})):n&&(e.playbackState&&n.track_window.current_track.uri===e.playbackState.track_window.current_track.uri||e.onTrackChangeCallbacks.forEach((function(e){return e(n.track_window.current_track)})),e.playbackState&&n.paused===e.playbackState.paused||(n.paused?e.onPauseCallbacks.forEach((function(e){return e()})):e.onPlayCallbacks.forEach((function(e){return e()})))),e.playbackState=n})),this.player.on(le.LAST_ACTIVE_DEVICE_INFO_CHANGED,(function(t){var n=t.data.deviceInfo;n&&(e.onVolumeChangeCallbacks.forEach((function(e){return e(n.volume)})),e.onActiveStateChangeCallbacks.forEach((function(e){return e(n.is_active)})))})),this.player.on(le.PROGRESS,(function(t){var n=t.data;e.onProgressCallbacks.forEach((function(e){return e(n)}))})),this.player.on(le.PLAYER_INITIALIZATION_FAILED,(function(t){var n=t.data;e.onInitializationFailureCallbacks.forEach((function(e){return e(n)})),e.onInitializationFailureCallbacks=[]})),this.player.on(le.LOCAL_PLAYER_ENABLED,(function(){e.onConnectCallbacks.forEach((function(e){return e()})),e.onConnectCallbacks=[]}))}},{key:"executeOrQueue",value:function(e){null===this.player?(this.onConnectCallbacks.push(e),this.initialize()):e()}},{key:"play",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.executeOrQueue((function(){e?t.player.playURI(e.uri,Na,Da(Da({},n),{},{autoplayCandidate:!1})):t.resume()}))}},{key:"pause",value:function(){var e=this;this.executeOrQueue((function(){e.player.pause(Na)}))}},{key:"resume",value:function(){var e=this;this.executeOrQueue((function(){e.player.resume(Na)}))}},{key:"next",value:function(){var e=this;this.executeOrQueue((function(){e.player.nextTrack(Na)}))}},{key:"prev",value:function(){var e=this;this.executeOrQueue((function(){e.player.previousTrack(Na)}))}},{key:"seek",value:function(e){var t=this;this.executeOrQueue((function(){t.player.seek(e,Na)}))}},{key:"seekForward",value:function(e){var t=this;this.executeOrQueue((function(){t.player.seekForward(e,Na)}))}},{key:"seekBackward",value:function(e){var t=this;this.executeOrQueue((function(){t.player.seekBackward(e,Na)}))}},{key:"setVolume",value:function(e){var t=this;this.executeOrQueue((function(){t.player.setVolume(e,Na)}))}},{key:"onProgress",value:function(e){var t=this;return this.onProgressCallbacks.push(e),{unsubscribe:function(){var n=t.onProgressCallbacks.indexOf(e);t.onProgressCallbacks.splice(n,1)}}}},{key:"onReset",value:function(e){var t=this;return this.onResetCallbacks.push(e),{unsubscribe:function(){var n=t.onResetCallbacks.indexOf(e);t.onResetCallbacks.splice(n,1)}}}},{key:"onPause",value:function(e){var t=this;return this.onPauseCallbacks.push(e),{unsubscribe:function(){var n=t.onPauseCallbacks.indexOf(e);t.onPauseCallbacks.splice(n,1)}}}},{key:"onPlay",value:function(e){var t=this;return this.onPlayCallbacks.push(e),{unsubscribe:function(){var n=t.onPlayCallbacks.indexOf(e);t.onPlayCallbacks.splice(n,1)}}}},{key:"onTrackChange",value:function(e){var t=this;return this.onTrackChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onTrackChangeCallbacks.indexOf(e);t.onTrackChangeCallbacks.splice(n,1)}}}},{key:"onVolumeChange",value:function(e){var t=this;return this.onVolumeChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onVolumeChangeCallbacks.indexOf(e);t.onVolumeChangeCallbacks.splice(n,1)}}}},{key:"onActiveStateChange",value:function(e){var t=this;return this.onActiveStateChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onActiveStateChangeCallbacks.indexOf(e);t.onActiveStateChangeCallbacks.splice(n,1)}}}},{key:"onInitializationFailure",value:function(e){var t=this;return this.onInitializationFailureCallbacks.push(e),{unsubscribe:function(){var n=t.onInitializationFailureCallbacks.indexOf(e);t.onInitializationFailureCallbacks.splice(n,1)}}}},{key:"onUnavailableTrack",value:function(){}}]),e}(),Ua={};n(4553);var xa,Fa=function(){function e(){var t=this;_()(this,e),i()(this,"onTrackChangeCallbacks",[]),i()(this,"onVolumeChangeCallbacks",[]),i()(this,"onUnavailableTrackCallbacks",[]),i()(this,"onPauseCallbacks",[]),i()(this,"onPlayCallbacks",[]),this.player=new Audio,this.player.addEventListener("ended",(function(){t.next()})),this.player.addEventListener("playing",(function(){t.onPlayCallbacks.forEach((function(e){return e()}))})),this.player.addEventListener("pause",(function(){t.onPauseCallbacks.forEach((function(e){return e()}))}))}return h()(e,[{key:"initialize",value:function(){}},{key:"_playIndex",value:function(e){var t=this;this.currentTrack=this.trackList[e],this.onTrackChangeCallbacks.forEach((function(e){return e(t.currentTrack)})),this.currentTrack&&this.currentTrack.is_playable&&this.currentTrack.preview_url?(this.player.src=this.currentTrack.preview_url,this.resume()):this.onUnavailableTrackCallbacks.forEach((function(e){return e(t.currentTrack)}))}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=Math.max(e._trackList.findIndex((function(e){return e.is_playable})),0),r=t.index||n;this.context=e,this.trackList=e._trackList,this._playIndex(r)}else this.player.src&&this.resume()}},{key:"pause",value:function(){this.player.pause()}},{key:"resume",value:function(){var e=this.player.play();void 0!==e&&e.catch((function(){}))}},{key:"next",value:function(){if(this.trackList){var e=this.trackList.indexOf(this.currentTrack),t=e<this.trackList.length-1?e+1:0;this._playIndex(t)}}},{key:"prev",value:function(){if(this.trackList){var e=this.trackList.indexOf(this.currentTrack);this._playIndex(e-1)}}},{key:"seek",value:function(e){this.player.currentTime=e/1e3}},{key:"seekForward",value:function(e){this.seek(1e3*this.player.currentTime+e)}},{key:"seekBackward",value:function(e){this.seek(1e3*this.player.currentTime-e)}},{key:"setVolume",value:function(e){this.player.volume=e,this.onVolumeChangeCallbacks.forEach((function(t){return t(e)}))}},{key:"onProgress",value:function(e){var t=this,n=function(){return e({position:1e3*t.player.currentTime})};return this.player.addEventListener("timeupdate",n),{unsubscribe:function(){t.player.removeEventListener("timeupdate",n)}}}},{key:"onTrackChange",value:function(e){var t=this;return this.onTrackChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onTrackChangeCallbacks.indexOf(e);t.onTrackChangeCallbacks.splice(n,1)}}}},{key:"onVolumeChange",value:function(e){var t=this;return this.onVolumeChangeCallbacks.push(e),{unsubscribe:function(){var n=t.onVolumeChangeCallbacks.indexOf(e);t.onVolumeChangeCallbacks.splice(n,1)}}}},{key:"onUnavailableTrack",value:function(e){var t=this;return this.onUnavailableTrackCallbacks.push(e),{unsubscribe:function(){var n=t.onUnavailableTrackCallbacks.indexOf(e);t.onUnavailableTrackCallbacks.splice(n,1)}}}},{key:"onReset",value:function(){}},{key:"onPause",value:function(e){var t=this;return this.onPauseCallbacks.push(e),{unsubscribe:function(){var n=t.onPauseCallbacks.indexOf(e);t.onPauseCallbacks.splice(n,1)}}}},{key:"onPlay",value:function(e){var t=this;return this.onPlayCallbacks.push(e),{unsubscribe:function(){var n=t.onPlayCallbacks.indexOf(e);t.onPlayCallbacks.splice(n,1)}}}},{key:"onInitializationFailure",value:function(){}},{key:"onActiveStateChange",value:function(e){e(!0)}}]),e}();const ja=function(e){return M("config",{})[e]};var Ba=function(e){return e.playback.isPlaying},Ya=function(e){return e.playback.isPaused},Va=function(e){return F(e,e.playback.trackUri)},Ka=function(e){var t=e.platform,n=void 0===t?{}:t,r=e.session,i=void 0===r?{}:r;return n.forcePreview||n.isMobile||n.isSafari||i.premiumOnlyMarket||!i.loggedIn||!i.accessToken},Ha=function(e){var t=Va(e);if(t)return Ka(e)?Math.min(t.duration_ms,3e4):t.duration_ms},Ga=function(e){return Ka(e)?xa||(xa=new Fa):(t=e.session,n=e.resource,Ua[n]&&t.accessToken===Ua[n].session.accessToken||(Ua[n]=new Ma(t,n)),Ua[n]);var t,n},qa=function(e){var t=Va(e);return!(!t||"episode"!==t.type)&&-1!==(t.available_markets||G(e).available_markets||t.show.available_markets||[]).indexOf(ja("countryCode"))};function Wa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wa(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qa="PROMPT",$a="UNAVAILABLE_TRACK",Xa={visible:!1,type:null};const Za=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case eo.SHOW_PROMPT:return za(za({},e),{},{visible:!0,type:Qa});case ao.UNAVAILABLE_TRACK:return za(za({},e),{},{visible:!0,type:$a});case eo.HIDE_MODAL:return za(za({},e),{},{visible:!1,type:null});default:return e}};var Ja={SHOW_PROMPT:"SHOW_PROMPT",HIDE_MODAL:"HIDE_MODAL",CLICK_LOGIN:"CLICK_LOGIN",CLICK_SIGNUP:"CLICK_SIGNUP",GET_SPOTIFY_APP:"GET_SPOTIFY_APP"};const eo=Ja;var to=function(e){return function(t,n){var r=n(),i=r.modal,a=i.type,o=i.visible;a===$a&&o||Ka(r)&&setTimeout((function(){return t({type:Ja.SHOW_PROMPT})}),e||0)}};function no(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ro(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?no(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):no(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var io={RESET:"RESET",PLAY:"PLAY",PAUSE:"PAUSE",SKIP_NEXT:"SKIP_NEXT",SKIP_PREV:"SKIP_PREV",TRACK_CHANGE:"TRACK_CHANGE",PROGRESS_UPDATE:"PROGRESS_UPDATE",PLAY_IN_APP:"PLAY_IN_APP",GET_IN_APP:"GET_IN_APP",UNAVAILABLE_TRACK:"UNAVAILABLE_TRACK"};const ao=io;var oo,so,co,lo=function(){return{type:io.PLAY}},uo=function(){return{type:io.PAUSE}},po=function(){return function(e,t){var n=t(),r=Ga(n);e({type:io.SKIP_NEXT}),e(lo()),r.next(),e(to())}},_o=function(){return function(e,t){var n=t(),r=Ga(n);e({type:io.SKIP_PREV}),e(lo()),r.prev(),e(to())}},fo=function(e){return{type:io.TRACK_CHANGE,uri:e}},ho=function(){return function(e,t){e(uo()),Ga(t()).pause()}},vo=function(e){return function(t,n){var r=n(),i=void 0!==e;if(i||!Ba(r)){var a=Ga(r);if(!i&&Ya(r))a.resume();else{var o=i?{index:e}:{};a.play(ro(ro({},G(r)),{},{_trackList:W(r)}),o),t(to(3e3))}}}},yo=n(8),go=n.n(yo);function mo(e){return"string"!=typeof e}!function(e){e.af="af",e.am="am",e.ar="ar",e.az="az",e.bg="bz",e.bn="bn",e.bho="bho",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es419="es-419",e.es="es",e.et="et",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="bn",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pa-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th_TH",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhTW="zh-TW",e.zu="zu"}(oo||(oo={})),function(e){e.AR="، ",e.FA="، ",e.EN=", "}(so||(so={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(co||(co={}));var Eo={},bo=function(e,t){try{return(Eo[e]||(Eo[e]=new Intl.PluralRules(e))).select(t)}catch(n){return co.OTHER}};function So(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}var Ro=function(e){return"ar"===e?"ar-u-nu-latn":e},ko=function(){function e(){_()(this,e),this._dictionary={},this._locale=oo.en}return h()(e,[{key:"setDictionary",value:function(e){this._dictionary=e}},{key:"setLocale",value:function(e){this._locale=e}},{key:"getLocale",value:function(){return this._locale}},{key:"toLocaleLowerCase",value:function(e){return null==e?void 0:e.toLocaleLowerCase(this._locale)}},{key:"toLocaleUpperCase",value:function(e){return null==e?void 0:e.toLocaleUpperCase(this._locale)}},{key:"get",value:function(e){for(var t=(e in this._dictionary?this._dictionary[e]:e),n="",r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];if(mo(t)){var o=i[0],s=bo(this._locale,parseInt(o,10)),c=t[s];void 0!==c?n=c:t.other&&(n=t.other)}else n=t;if(/%\d%/.test(n)){var l=["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop.login.errorCode","desktop-auth.error"];if(!l.includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if((null==i?void 0:i.length)>0)for(var u=0;u<i.length;u++){var d=i[u];if(null!=d)if("string"==typeof d)n=n.replace("{".concat(u,"}"),So(d)).replace("%".concat(u,"%"),So(d));else if("number"==typeof d){var p=this.formatNumber(d);n=n.replace("{".concat(u,"}"),p).replace("%".concat(u,"%"),p)}else if("object"===go()(d))for(var _=0,f=Object.keys(d);_<f.length;_++){var h=f[_],v=d[h];n=n.replace("%".concat(h,"%"),So(v))}}return n}},{key:"getSeparator",value:function(){switch(this._locale){case oo.ar:return so.AR;case oo.fa:return so.FA;default:return so.EN}}},{key:"formatNumber",value:function(e,t){return e.toLocaleString(Ro(this._locale),t)}},{key:"formatNumberCompact",value:function(t,n){var r={notation:"compact",maximumFractionDigits:1};if(n){var i=new e;return i.setLocale(n),i.formatNumber(t,r)}return this.formatNumber(t,r)}},{key:"formatDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={year:"numeric",month:"long",day:"numeric"},r=t||n;return new Intl.DateTimeFormat(Ro(this._locale),r).format(e)}},{key:"formatRelativeDate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new Date(Date.now()),i=(e=new Date(e)).getTime()-r.getTime(),a=Math.abs(i)<2592e6;if(a&&null!==(t=Intl)&&void 0!==t&&t.RelativeTimeFormat){var o=Po(i),s=o.days,c=o.hours,l=o.minutes,u=o.seconds,d=new Intl.RelativeTimeFormat;return s||c||l?s||c?s?d.format(s,"days"):d.format(c,"hours"):d.format(l,"minutes"):d.format(u,"seconds")}return this.formatDate(e,n)}},{key:"__resetForTests",value:function(){this._dictionary={},this._locale=oo.en,Eo={}}}]),e}();function Po(e){return{seconds:Math.round(e/1e3),minutes:Math.round(e/1e3/60),hours:Math.round(e/1e3/60/60),days:Math.round(e/1e3/60/60/24)}}var To=new ko,Ao={width:"100%",height:"100%",color:"white"};const Co=function(){return o().createElement("svg",{style:Ao,viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},o().createElement("title",null,To.get("embed_play")),o().createElement("path",{d:"M7.712 22.04a.732.732 0 0 1-.806.007.767.767 0 0 1-.406-.703V4.656c0-.31.135-.544.406-.703.271-.16.54-.157.806.006l14.458 8.332c.266.163.4.4.4.709 0 .31-.134.546-.4.71L7.712 22.04z",fill:"currentColor",fillRule:"evenodd"}))};var wo={width:"100%",height:"100%",color:"white"};const Io=(0,d.zo)((function(){return o().createElement("svg",{style:wo,viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},o().createElement("title",null,To.get("embed_pause")),o().createElement("g",{fill:"currentColor",fillRule:"evenodd"},o().createElement("rect",{x:"5",y:"3",width:"5",height:"20",rx:"1"}),o().createElement("rect",{x:"16",y:"3",width:"5",height:"20",rx:"1"})))}),{width:"100%",height:"100%"});function Lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Do(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var No=(0,d.zo)("div",{position:"relative",width:"100%",height:"100%",minWidth:"80px",minHeight:"80px"}),Mo=function(e){m()(n,e);var t=Do(n);function n(e){var r;return _()(this,n),r=t.call(this,e),i()(y()(r),"state",{isLoaded:!1}),i()(y()(r),"onImageLoad",(function(){r.setState({isLoaded:!0})})),e.src&&r.loadImage(e.src),r}return h()(n,[{key:"componentDidUpdate",value:function(){this.props.src&&!this._img&&this.loadImage(this.props.src)}},{key:"componentWillUnmount",value:function(){this._img&&(this._img.onload=null)}},{key:"loadImage",value:function(e){this._img=new Image,this._img.onload=this.onImageLoad,this._img.src=e}},{key:"render",value:function(){var e={height:"100%",position:"relative"};e=this.props.src&&this.state.isLoaded?Oo(Oo({},e),{},{backgroundImage:"url(".concat(this.props.src,")"),backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center ".concat(this.props.top?"top":"center")}):Oo(Oo({},e),{},{backgroundColor:"transparent"});var t=(0,d.zo)("div",e);return o().createElement(No,null,o().createElement(t,{onClick:this.props.onClick},this.props.children))}}]),n}(o().Component);function Uo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var xo=(0,d.zo)("button",{background:"rgba(0, 0, 0, 0.5)",border:"1px solid white",borderRadius:"50%",position:"absolute",top:"25%",left:"25%",height:"50%",width:"50%",outline:"none",boxShadow:"0 0 10px rgba(0, 0, 0, 0.4)",transition:"transform 0.1s",cursor:"pointer",":hover":{transform:"scale(1.1)"}}),Fo=function(e){m()(n,e);var t=Uo(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props.isPlaying?Io:Co,t=this.props.isPlaying?To.get("embed_pause"):To.get("embed_play"),n=this.props.noCoverArt?void 0:this.props.coverArtUrl;return o().createElement(Mo,{src:n,onClick:this.props.onClick,top:this.props.top},this.props.noButton?void 0:o().createElement(xo,{title:t,onClick:this.props.onClick},o().createElement(e,null)))}}]),n}(o().PureComponent);function jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Bo=function(e){m()(n,e);var t=jo(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"handleClick",(function(t){e.togglePlayback(),t.stopPropagation()})),i()(y()(e),"handleKeydown",(function(t){" "===t.key&&e.togglePlayback()})),i()(y()(e),"togglePlayback",(function(){e.props.isPlaying?e.props.onPause():e.props.onPlay()})),e}return h()(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeydown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){return o().createElement(Fo,te()({},this.props,{onClick:this.handleClick}))}}]),n}(o().Component);const Yo=(0,l.$j)((function(e){return{isPlaying:Ba(e),isPaused:Ya(e),coverArtUrl:z(e)}}),(function(e){return{onPlay:function(){return e(vo())},onPause:function(){return e(ho())}}}))(Bo);const Vo=function(){return o().createElement("div",{style:{margin:"16px"}},o().createElement("p",null,"This size is now its own component, and not yet implemented... Stay put!"))};function Ko(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Ho=(0,d.zo)("a",{display:"block",margin:"8px 8px",textDecoration:"none",color:"inherit",fontWeight:"200",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",cursor:"pointer"}),Go=(0,d.zo)("div",(function(e){var t;return t={color:e.$color,fontWeight:L,textOverflow:"ellipsis",overflow:"hidden"},i()(t,T,{fontSize:"14px",lineHeight:"19px"}),i()(t,A,{fontSize:"16px",lineHeight:"23px"}),t})),qo=(0,d.zo)("div",{textOverflow:"ellipsis",overflow:"hidden"}),Wo=function(e){m()(n,e);var t=Ko(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.titleColor,r=e.subtitle,i=e.onClick;return o().createElement(Ho,{onClick:i},o().createElement(Go,{$color:n},o().createElement("span",{dir:"auto"},t)),o().createElement(qo,null,o().createElement("span",{dir:"auto"},r)))}}]),n}(o().PureComponent);i()(Wo,"defaultProps",{titleColor:k.ixZ});var zo=(0,V.P1)([function(e){return G(e)},function(e){return Va(e)}],(function(e,t){return"artist"!==e.type||t?(t||e).name:To.get("top_tracks_for_artist",{artist:e.name})})),Qo=(0,V.P1)([function(e){return G(e)},function(e){return Va(e)}],(function(e,t){if("playlist"===e.type&&!t)return e.primary_color})),$o=(0,V.P1)([function(e){return G(e)},function(e){return Va(e)}],(function(e,t){switch(e.type){case"album":return e.artists.map((function(e){return e.name})).join(To.getSeparator());case"playlist":return t?"episode"===t.type?t.show.name:t.artists.map((function(e){return e.name})).join(To.getSeparator()):e.owner.display_name;case"track":return e.album.artists.map((function(e){return e.name})).join(To.getSeparator());case"episode":return e.show.name;case"show":return t?e.name:e.publisher;default:return""}}));const Xo=(0,l.$j)((function(e){return{title:zo(e),titleColor:Qo(e),subtitle:$o(e)}}))(Wo);n(6541);function Zo(e,t){var n,r=0;return function(){for(var i=this,a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];var c=Date.now();r+t<c?(e.apply(this,o),r=c):(clearTimeout(n),n=setTimeout((function(){e.apply(i,o),r=c}),t))}}n(4048);var Jo=function(e){if(-1===e||Number.isNaN(e))return"";var t=function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),i=60*r,a=n-i;return{hours:r,minutes:a,seconds:t-60*i-60*a}}(e),n=t.hours,r=t.minutes,i=t.seconds,a=n>0?"".concat(n,":"):"",o=n>0&&r<10?"0".concat(r):r,s=i<10?"0".concat(i):i;return"".concat(a).concat(o,":").concat(s)};function es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ns(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rs=(0,d.zo)("div",(function(e){var t=e.$disabled,n=e.$styleProps;return ns({padding:" 16px 0",position:"relative",flexGrow:1,cursor:t?"auto":"pointer"},void 0===n?{}:n)})),is=(0,d.zo)("div",{backgroundColor:"rgba(255, 255, 255, 0.3)",height:"4px",flex:"4"}),as=(0,d.zo)("div",(function(e){var t=e.$progress,n=e.$disabled;return{backgroundColor:"".concat(k.ixZ),height:"4px",width:"".concat(t,"%"),opacity:n?"0.4":"1"}})),os={from:{opacity:"0"},to:{opacity:"1"}},ss={from:{opacity:"1"},to:{opacity:"0"}},cs=(0,d.zo)("div",(function(e){var t=e.$progress,n=e.$isDragging,r=e.$width;return{position:"absolute",left:"calc(".concat(t,"% - ").concat(r,"px / 2)"),font:"0.8em Verdana,sans-serif",boxShadow:"0.1em 0.1em 0 ".concat(k.Snx,"B3"),bottom:"30px",display:"block",backgroundColor:"".concat(k.ixZ),color:"".concat(k.Snx),padding:"2px 5px",textShadow:"none",textAlign:"center",animationName:n?os:ss,animationDuration:"0.1s",opacity:n?"1":"0",userSelect:"none",userDrag:"none"}})),ls=(0,d.zo)("div",(function(e){var t=e.$progress,n=e.$isMouseOver,r=e.$disabled;return{position:"absolute",left:"calc(".concat(t,"% - 6px)"),bottom:"12px",display:n&&!r?"block":"none",backgroundColor:"".concat(k.ixZ),padding:"0px",textShadow:"none",height:"12px",width:"12px",zIndex:"100",boxShadow:"0 2px 4px 0 ".concat(k.Snx,"80"),borderRadius:"50%",userSelect:"none",userDrag:"none"}})),us=function(e){m()(n,e);var t=es(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"state",{isDragging:!1,fakeValue:null,isMouseOver:!1}),i()(y()(e),"renderSleepCount",0),i()(y()(e),"setBar",(function(t){e.bar=t})),i()(y()(e),"setProgressTimeTooltip",(function(t){e.progressTimeTooltip=t})),i()(y()(e),"handleMouseDown",(function(t){if(!e.props.disabled&&0===t.button){t.stopPropagation();var n=e.getRelativePosition(t.clientX);e.setState({isDragging:!0,fakeValue:n}),e.props.shouldIgnoreDragStart||e.reportUpdate(n)}})),i()(y()(e),"handleMouseMove",Zo((function(t){if(!e.props.disabled&&e.state.isDragging)if(e.isOutsideBounds(t))e.handleMouseUp(t);else{var n=e.getRelativePosition(t.clientX);e.setState({fakeValue:n}),e.props.shouldUpdateWhileDragging&&e.reportUpdate(n)}}),50)),i()(y()(e),"handleMouseUp",(function(t){!e.props.disabled&&e.state.isDragging&&(t.stopPropagation(),e.setState({isDragging:!1}),e.reportUpdate(e.getRelativePosition(t.clientX)))})),i()(y()(e),"handleWrapperMouseEnter",(function(){e.setState({isMouseOver:!0})})),i()(y()(e),"handleWrapperMouseLeave",(function(){e.setState({isMouseOver:!1})})),e}return h()(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)}},{key:"shouldComponentUpdate",value:function(e,t){var n=this,r=Object.keys(ns(ns({},e),this.props)).every((function(t){return e[t]===n.props[t]})),i=Object.keys(ns(ns({},t),this.state)).every((function(e){return t[e]===n.state[e]}));return(!r||!i)&&(Math.abs(e.currentValue-this.props.currentValue>1e3)?(this.renderSleepCount=0,!0):(this.state.isDragging&&!t.isDragging&&(this.renderSleepCount=3),!(this.renderSleepCount>0)||(this.renderSleepCount--,!1)))}},{key:"getRelativePosition",value:function(e){var t=this.bar.getBoundingClientRect(),n=t.right-t.left;return Math.max(0,Math.min((e-t.left)/n,1))*this.props.max}},{key:"reportUpdate",value:function(e){this.props.onUpdate(Math.max(0,Math.min(e,this.props.max)))}},{key:"isOutsideBounds",value:function(e){return e.pageX<0||e.pageY<0||e.pageX>window.innerWidth||e.pageY>window.innerHeight+window.scrollY}},{key:"progressTimeTooltipWidth",value:function(){if(this.progressTimeTooltip){var e=this.progressTimeTooltip.getBoundingClientRect();return e.right-e.left}return 0}},{key:"render",value:function(){var e=this.props,t=e.currentValue,n=e.max,r=e.disabled,i=e.$styleProps,a=this.state,s=a.isDragging,c=a.fakeValue,l=a.isMouseOver,u=s?c:t,d=Math.min(u/n*100,100),p=Jo(Math.max(0,u));return o().createElement(rs,{onMouseDown:this.handleMouseDown,$styleProps:i,$disabled:r,onMouseEnter:this.handleWrapperMouseEnter,onMouseLeave:this.handleWrapperMouseLeave},o().createElement(cs,{ref:this.setProgressTimeTooltip,$progress:d,$width:this.progressTimeTooltipWidth(),$isDragging:s},p),o().createElement(ls,{$progress:d,$isMouseOver:l,$disabled:r}),o().createElement(is,{ref:this.setBar},o().createElement(as,{$progress:d,$disabled:r})))}}]),n}(o().Component);function ds(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}i()(us,"defaultProps",{currentValue:0,max:1,shouldUpdateWhileDragging:!1,shouldIgnoreDragStart:!1,disabled:!1,onUpdate:function(){}});var _s=(0,d.zo)("div",(function(e){var t=e.$max,n=e.$styleProps;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ps(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ps(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({display:t?"inline-block":"none",verticalAlign:"top",fontSize:"10px",whiteSpace:"nowrap",margin:"0 8px",fontFeatureSettings:'"tnum"'},void 0===n?{}:n)})),fs=function(e){m()(n,e);var t=ds(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.currentValue,n=e.max,r=e.$styleProps;return o().createElement(_s,{$max:n,$styleProps:r},"-",n&&t?"".concat(Jo(Math.max(0,n-t))):Jo(0))}}]),n}(o().Component);function hs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}i()(fs,"defaultProps",{currentValue:0});const vs=(0,d.zo)("button",(function(e){var t=e.$size,n=void 0===t?40:t,r=e.$styleProps,a=void 0===r?{}:r;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hs(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({padding:0,border:"none",cursor:"pointer",background:"transparent",width:"".concat(n,"px"),height:"".concat(n,"px"),outline:"none"},a)}));function ys(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var gs=(0,d.zo)("svg",{width:"100%",height:"100%",filter:w}),ms=function(e){m()(n,e);var t=ys(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.$styleProps;return o().createElement(vs,{onClick:t,title:To.get("playback-control.skip-forward"),$styleProps:n},o().createElement(gs,{viewBox:"16 16 32 32"},o().createElement("path",{d:"M38,22 C38,21.7248663 38.0978826,21.489419 38.2936508,21.2936508 C38.489419,21.0978826 38.7248663,21 39,21 L41,21 C41.2751337,21 41.510581,21.0978826 41.7063492,21.2936508 C41.9021174,21.489419 42,21.7248663 42,22 L42,42 C42,42.2751337 41.9021174,42.510581 41.7063492,42.7063492 C41.510581,42.9021174 41.2751337,43 41,43 L39,43 C38.7248663,43 38.489419,42.9021174 38.2936508,42.7063492 C38.0978826,42.510581 38,42.2751337 38,42 L38,33.7619048 L23.4920635,42.1269841 C23.1640195,42.3280433 22.833335,42.3306888 22.5,42.1349206 C22.166665,41.9391525 22,41.6507956 22,41.2698413 L22,22.7301587 C22,22.3492044 22.166665,22.0608475 22.5,21.8650794 C22.833335,21.6693112 23.1640195,21.6719567 23.4920635,21.8730159 L38,30.2380952 L38,22 Z",fill:"white"})))}}]),n}(o().PureComponent);function Es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var bs=(0,d.zo)("svg",{width:"100%",height:"100%",filter:w}),Ss=function(e){m()(n,e);var t=Es(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.size,r=e.$styleProps;return o().createElement(vs,{onClick:t,title:To.get("playback-control.skip-back"),$size:n,$styleProps:r},o().createElement(bs,{viewBox:"16 16 32 32"},o().createElement("path",{d:"M40.5079365,21.8730159 C40.8359805,21.6719567 41.166665,21.6693112 41.5,21.8650794 C41.833335,22.0608475 42,22.3492044 42,22.7301587 L42,41.2698413 C42,41.6507956 41.833335,41.9391525 41.5,42.1349206 C41.166665,42.3306888 40.8359805,42.3280433 40.5079365,42.1269841 L26,33.7619048 L26,42 C26,42.2751337 25.9021174,42.510581 25.7063492,42.7063492 C25.510581,42.9021174 25.2751337,43 25,43 L23,43 C22.7248663,43 22.489419,42.9021174 22.2936508,42.7063492 C22.0978826,42.510581 22,42.2751337 22,42 L22,22 C22,21.7248663 22.0978826,21.489419 22.2936508,21.2936508 C22.489419,21.0978826 22.7248663,21 23,21 L25,21 C25.2751337,21 25.510581,21.0978826 25.7063492,21.2936508 C25.9021174,21.489419 26,21.7248663 26,22 L26,30.2380952 L40.5079365,21.8730159 Z",fill:"white"})))}}]),n}(o().PureComponent);function Rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var ks=(0,d.zo)("svg",{width:"100%",height:"100%",filter:w}),Ps=function(e){m()(n,e);var t=Rs(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.$styleProps;return o().createElement(vs,{onClick:t,title:To.get("spe.playback-control.skip-backward-15"),$styleProps:n},o().createElement(ks,{viewBox:"0 0 32 32"},o().createElement("path",{d:"M2.0952381,14.8730159 C2.60317714,14.4920616 2.92063429,13.9947121 3.04761905,13.3809524 L4.53968254,13.3809524 L4.53968254,25.6666667 L2.87301587,25.6666667 L2.87301587,16.6984127 L0.158730159,16.6984127 L0.158730159,15.4920635 C0.941802857,15.4708994 1.58729905,15.2645522 2.0952381,14.8730159 Z M14.952381,18.7777778 C15.301589,19.1269859 15.5740731,19.555553 15.7698413,20.0634921 C15.9656094,20.5714311 16.0634921,21.1322721 16.0634921,21.7460317 C16.0634921,22.3174632 15.962964,22.8571403 15.7619048,23.3650794 C15.5608456,23.8624363 15.2698432,24.3015854 14.8888889,24.6825397 C14.5079346,25.0529119 14.0476217,25.3492052 13.5079365,25.5714286 C12.9576692,25.7830698 12.3439187,25.8888889 11.6666667,25.8888889 C11.052907,25.8888889 10.4894206,25.7910063 9.97619048,25.5952381 C9.4629604,25.3994699 9.0185204,25.1375678 8.64285714,24.8095238 C8.26719389,24.4814798 7.9656096,24.0978858 7.73809524,23.6587302 C7.51058087,23.2195745 7.37566159,22.7513252 7.33333333,22.2539683 L8.87301587,21.8730159 C8.90476206,22.222224 8.99470825,22.5529085 9.14285714,22.8650794 C9.29100603,23.1772502 9.48677127,23.4444433 9.73015873,23.6666667 C9.97354619,23.8994721 10.2539667,24.0793644 10.5714286,24.2063492 C10.8994725,24.333334 11.2645483,24.3968254 11.6666667,24.3968254 C12.0687851,24.3968254 12.4365063,24.333334 12.7698413,24.2063492 C13.1031763,24.0793644 13.3888877,23.8994721 13.6269841,23.6666667 C13.8650806,23.4338613 14.0502639,23.1534408 14.1825397,22.8253968 C14.3148155,22.4973529 14.3809524,22.14815 14.3809524,21.7777778 C14.3809524,21.3439132 14.31217,20.9629646 14.1746032,20.6349206 C14.0370363,20.3068767 13.8465621,20.0264562 13.6031746,19.7936508 C13.3597871,19.5608454 13.0740757,19.3835985 12.7460317,19.2619048 C12.4179878,19.140211 12.058203,19.0793651 11.6666667,19.0793651 C11.1481456,19.0793651 10.6772508,19.1878296 10.2539683,19.4047619 C9.83068571,19.6216942 9.48677381,19.8994692 9.22222222,20.2380952 L7.68253968,19.6666667 L9.01587302,13.3809524 L15.4920635,13.3809524 L15.4920635,14.9365079 L10.1746032,14.9365079 L9.38095238,18.6984127 C9.52910127,18.5290997 9.70899365,18.380953 9.92063492,18.2539683 C10.1322762,18.1269835 10.3492052,18.0211644 10.5714286,17.9365079 C10.804234,17.8412694 11.0423268,17.7777779 11.2857143,17.7460317 C11.5291017,17.7037035 11.7671946,17.6825397 12,17.6825397 C12.6031776,17.6825397 13.1587276,17.7777768 13.6666667,17.968254 C14.1640237,18.1587311 14.5925908,18.4285697 14.952381,18.7777778 Z M20,5.33333333 C21.4391606,5.33333333 22.8174537,5.60581738 24.1349206,6.15079365 C25.4523875,6.69576992 26.5872968,7.4312123 27.5396825,8.35714286 C28.4920683,9.28307341 29.2513199,10.3835915 29.8174603,11.6587302 C30.3836007,12.9338688 30.6666667,14.2698343 30.6666667,15.6666667 C30.6666667,17.063499 30.3836007,18.3994645 29.8174603,19.6746032 C29.2513199,20.9497418 28.4920683,22.0502599 27.5396825,22.9761905 C26.5872968,23.902121 25.4523875,24.6375634 24.1349206,25.1825397 C22.8174537,25.727516 21.4391606,26 20,26 L20,24.6666667 C21.6825481,24.6666667 23.2407336,24.2645543 24.6746032,23.4603175 C26.1084728,22.6560806 27.2433821,21.563499 28.0793651,20.1825397 C28.9153481,18.8015804 29.3333333,17.2963044 29.3333333,15.6666667 C29.3333333,14.0370289 28.9153481,12.5317529 28.0793651,11.1507937 C27.2433821,9.76983437 26.1084728,8.6772527 24.6746032,7.87301587 C23.2407336,7.06877905 21.6825481,6.66666667 20,6.66666667 L10.6666667,6.66666667 L10.6666667,9.66666667 L4.31746032,6 L10.6666667,2.33333333 L10.6666667,5.33333333 L20,5.33333333 Z",fill:"white"})))}}]),n}(o().PureComponent);function Ts(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var As=(0,d.zo)("svg",{width:"100%",height:"100%",filter:w}),Cs=function(e){m()(n,e);var t=Ts(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.$styleProps;return o().createElement(vs,{onClick:t,title:To.get("playback-control.skip-forward-15"),$styleProps:n},o().createElement(As,{viewBox:"0 0 32 32"},o().createElement("path",{d:"M12,6.66666667 C10.3174519,6.66666667 8.75926643,7.06877905 7.32539683,7.87301587 C5.89152722,8.6772527 4.75661794,9.76983437 3.92063492,11.1507937 C3.0846519,12.5317529 2.66666667,14.0370289 2.66666667,15.6666667 C2.66666667,17.2963044 3.0846519,18.8015804 3.92063492,20.1825397 C4.75661794,21.563499 5.89152722,22.6560806 7.32539683,23.4603175 C8.75926643,24.2645543 10.3174519,24.6666667 12,24.6666667 L12,26 C10.5608394,26 9.18254627,25.727516 7.86507937,25.1825397 C6.54761246,24.6375634 5.41270317,23.902121 4.46031746,22.9761905 C3.50793175,22.0502599 2.74868008,20.9497418 2.18253968,19.6746032 C1.61639929,18.3994645 1.33333333,17.063499 1.33333333,15.6666667 C1.33333333,14.2698343 1.61639929,12.9338688 2.18253968,11.6587302 C2.74868008,10.3835915 3.50793175,9.28307341 4.46031746,8.35714286 C5.41270317,7.4312123 6.54761246,6.69576992 7.86507937,6.15079365 C9.18254627,5.60581738 10.5608394,5.33333333 12,5.33333333 L21.3333333,5.33333333 L21.3333333,2.33333333 L27.6825397,6 L21.3333333,9.66666667 L21.3333333,6.66666667 L12,6.66666667 Z M13.7777778,15.8253968 C14.5714325,15.8042327 15.2222197,15.600531 15.7301587,15.2142857 C16.2380978,14.8280404 16.5555549,14.3280454 16.6825397,13.7142857 L18.1746032,13.7142857 L18.1746032,26 L16.5079365,26 L16.5079365,17.031746 L13.7777778,17.031746 L13.7777778,15.8253968 Z M29.3968254,20.3968254 C29.5978846,20.8941824 29.6984127,21.4550233 29.6984127,22.0793651 C29.6984127,22.6507965 29.5978846,23.1904737 29.3968254,23.6984127 C29.1957662,24.1957697 28.9047638,24.6322733 28.5238095,25.0079365 C28.1428552,25.3835998 27.6798969,25.6825386 27.1349206,25.9047619 C26.5899444,26.1269852 25.9788394,26.2380952 25.3015873,26.2380952 C24.6878276,26.2380952 24.1216957,26.1375671 23.6031746,25.9365079 C23.0952356,25.7460308 22.653441,25.4841287 22.2777778,25.1507937 C21.9021145,24.8174587 21.6005302,24.4312191 21.3730159,23.9920635 C21.1455015,23.5529079 21.0105822,23.0846586 20.968254,22.5873016 L22.5079365,22.2063492 C22.5396827,22.5555573 22.6269834,22.8862418 22.7698413,23.1984127 C22.9126991,23.5105836 23.1058189,23.7777767 23.3492063,24 C23.5925938,24.2222233 23.8756598,24.4021157 24.1984127,24.5396825 C24.5211656,24.6772494 24.8862413,24.7460317 25.2936508,24.7460317 C25.7010602,24.7460317 26.0714269,24.6798948 26.4047619,24.547619 C26.7380969,24.4153433 27.0211629,24.2328054 27.2539683,24 C27.4973557,23.7566125 27.682539,23.4761921 27.8095238,23.1587302 C27.9470906,22.8306862 28.015873,22.4814833 28.015873,22.1111111 C28.015873,21.6772465 27.9470906,21.2962979 27.8095238,20.968254 C27.671957,20.64021 27.4814827,20.3597895 27.2380952,20.1269841 C26.9947078,19.8941787 26.7089963,19.7169318 26.3809524,19.5952381 C26.0529084,19.4735444 25.6878327,19.4126984 25.2857143,19.4126984 C24.7671932,19.4126984 24.3015894,19.5185175 23.8888889,19.7301587 C23.4656063,19.9523821 23.1216944,20.2328025 22.8571429,20.5714286 L21.3015873,20 L22.6349206,13.7142857 L29.1269841,13.7142857 L29.1269841,15.2698413 L23.8095238,15.2698413 L23,19.031746 C23.1481489,18.862433 23.3280413,18.7142863 23.5396825,18.5873016 C23.7513238,18.4603168 23.9735438,18.3544978 24.2063492,18.2698413 C24.4285725,18.1851848 24.6613744,18.1216933 24.9047619,18.0793651 C25.1481494,18.0370368 25.3862422,18.015873 25.6190476,18.015873 C26.2328073,18.015873 26.7910028,18.1111102 27.2936508,18.3015873 C27.7962988,18.4920644 28.224866,18.761903 28.5793651,19.1111111 C28.9338642,19.4603192 29.2063483,19.8888863 29.3968254,20.3968254 Z",fill:"white"})))}}]),n}(o().PureComponent);function ws(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Is=(0,d.zo)("div",{position:"absolute",bottom:0,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"nowrap",margin:"0 4px"}),Ls=function(e){m()(n,e);var t=ws(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"SKIP_TIME_MS",15e3),i()(y()(e),"handleUpdate",(function(t){e.props.player.seek(t)})),i()(y()(e),"handleSeekBackward",(function(){e.props.player.seekBackward(e.SKIP_TIME_MS)})),i()(y()(e),"handleSeekForward",(function(){e.props.player.seekForward(e.SKIP_TIME_MS)})),e}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.trackLength,n=e.progress,r=e.onNext,a=e.onPrev,s=e.type,c=e.disabled,l="show"===s||"episode"===s,u=!l&&"track"!==s,d=i()({width:"16px",height:"16px",padding:"8px 4px",boxSizing:"content-box"},":last-child",{paddingRight:"8px"});return o().createElement(Is,{dir:"ltr"},u&&o().createElement(Ss,{onClick:a,$styleProps:d}),l&&o().createElement(Ps,{onClick:this.handleSeekBackward,$styleProps:d}),o().createElement(us,{currentValue:n,max:t,onUpdate:this.handleUpdate,disabled:c,shouldIgnoreDragStart:!0,$styleProps:{margin:"0 0px"}}),u&&o().createElement(ms,{onClick:r,$styleProps:d}),l&&o().createElement(Cs,{onClick:this.handleSeekForward,$styleProps:d}),o().createElement(fs,{currentValue:n,max:t,$styleProps:{margin:"0 4px"}}))}}]),n}(o().PureComponent);const Os=(0,l.$j)((function(e){return{trackLength:Ha(e),disabled:!Va(e),player:Ga(e),type:q(e),progress:e.progress}}),(function(e){return{onNext:function(){return e(po())},onPrev:function(){return e(_o())}}}))(Ls);var Ds=(0,d.zo)("div",{position:"relative",flex:100,minHeight:"80px",minWidth:"0"});const Ns=function(){return o().createElement(Ds,null,o().createElement(Xo,null),o().createElement(Os,null))};var Ms={SHOW_SHARE:"SHOW_SHARE",COPY_EMBED_CODE:"COPY_EMBED_CODE",COPY_URL:"COPY_URL",HIDE_SHARE:"HIDE_SHARE"};const Us=Ms;var xs=function(e){return e.share.visible},Fs=function(e){return e.share.view};n(7268);const js=(0,d.zo)((function(){return o().createElement("svg",{viewBox:"0 0 16 16"},o().createElement("title",null,To.get("close_button_action")),o().createElement("polygon",{fill:"white",points:"14.354,2.353 13.646,1.646 8,7.293 2.353,1.646 1.646,2.353 7.293,8 1.646,13.646 2.353,14.354 8,8.707 13.646,14.354 14.354,13.646 8.707,8 \t"}))}),{width:"100%",height:"100%"});function Bs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Ys=(0,d.zo)("div",(function(e){return{position:"absolute",top:0,left:0,width:"100%",height:"100%",boxSizing:"border-box",padding:"10px",backgroundColor:e.$small?"#000":"rgba(0, 0, 0, 0.9)",transitionProperty:"opacity",transitionDuration:"0.2s",opacity:e.$opacity,zIndex:1}})),Vs=(0,d.zo)("button",{position:"absolute",top:0,right:0,background:"transparent",width:"16px",border:"none",cursor:"pointer",outline:"none",padding:0,margin:"10px"}),Ks=function(e){m()(n,e);var t=Bs(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"state",{opacity:0}),i()(y()(e),"handleKeydown",(function(t){"Escape"===t.key&&e.props.onClose()})),e}return h()(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.handleKeydown),setTimeout((function(){return e.setState({opacity:1})}),10)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.small,r=e.onClose;return o().createElement(Ys,{$small:n,$opacity:this.state.opacity},t,o().createElement(Vs,{onClick:r},o().createElement(js,null)))}}]),n}(o().PureComponent),Hs=function(e){return window.open("https://www.facebook.com/dialog/share?href=".concat(encodeURIComponent(e),"&redirect_uri=").concat(encodeURIComponent(e),"&hashtag=").concat(encodeURIComponent("#NowPlaying"),"&app_id=174829003346&display=page"),"","width=640,height=551")},Gs=function(e){var t=window.SpotifyEnvironment&&window.SpotifyEnvironment.isMobile;window.open("".concat(t?"fb-messenger://share/":"https://www.facebook.com/dialog/send","?link=").concat(encodeURIComponent(e),"&redirect_uri=").concat(encodeURIComponent(e),"&app_id=174829003346&display=page"),"","width=996,height=550")},qs=function(e){return window.open("https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(e),"&hashtags=NowPlaying&related=spotify"),"","width=640,height=300")},Ws=function(e){return window.open("https://api.whatsapp.com/send?text=".concat(encodeURIComponent(e)),"")},zs=function(e){var t=document.createElement("input");t.value=e,t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},Qs=function(e){var t="<iframe "+'src="https://open.spotify.com/embed?uri='.concat(encodeURIComponent(e),'" ')+'width="300" height="380" frameborder="0" style="border-radius: 12px;"allowtransparency="true" allow="encrypted-media"></iframe>',n=document.createElement("input");n.value=t,n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)};function $s(e){var t,n;if("string"!=typeof(t='{"build/embed-iframe-api-v1.d9be15ce.js":"https://open.scdn.co/cdn/build/embed-iframe-api-v1.d9be15ce.js","build/embed-iframe-api-v1.js":"https://open.scdn.co/cdn/build/embed-iframe-api-v1.d9be15ce.js","build/embed-legacy/embed-legacy.bab50099.js":"https://open.scdn.co/cdn/build/embed-legacy/embed-legacy.bab50099.js","build/embed-legacy/embed-legacy.js":"https://open.scdn.co/cdn/build/embed-legacy/embed-legacy.bab50099.js","build/embed-legacy/vendor~embed-legacy.3fd2b42a.js":"https://open.scdn.co/cdn/build/embed-legacy/vendor~embed-legacy.3fd2b42a.js","build/embed-legacy/vendor~embed-legacy.js":"https://open.scdn.co/cdn/build/embed-legacy/vendor~embed-legacy.3fd2b42a.js","build/embed/embed-video.17bc1ed7.js":"https://open.scdn.co/cdn/build/embed/embed-video.17bc1ed7.js","build/embed/embed-video.5deeee5f.css":"https://open.scdn.co/cdn/build/embed/embed-video.5deeee5f.css","build/embed/embed-video.css":"https://open.scdn.co/cdn/build/embed/embed-video.5deeee5f.css","build/embed/embed-video.js":"https://open.scdn.co/cdn/build/embed/embed-video.17bc1ed7.js","build/embed/embed.20f08a51.js":"https://open.scdn.co/cdn/build/embed/embed.20f08a51.js","build/embed/embed.5deeee5f.css":"https://open.scdn.co/cdn/build/embed/embed.5deeee5f.css","build/embed/embed.css":"https://open.scdn.co/cdn/build/embed/embed.5deeee5f.css","build/embed/embed.js":"https://open.scdn.co/cdn/build/embed/embed.20f08a51.js","build/embed/vendor~embed.6d7969dd.js":"https://open.scdn.co/cdn/build/embed/vendor~embed.6d7969dd.js","build/embed/vendor~embed.js":"https://open.scdn.co/cdn/build/embed/vendor~embed.6d7969dd.js","build/mwp/activation-overlay.3286561f.js":"https://open.scdn.co/cdn/build/mwp/activation-overlay.3286561f.js","build/mwp/activation-overlay.js":"https://open.scdn.co/cdn/build/mwp/activation-overlay.3286561f.js","build/mwp/mwp-artist-page.css":"https://open.scdn.co/cdn/build/mwp/mwp-artist-page.d3fd7b76.css","build/mwp/mwp-artist-page.d3fd7b76.css":"https://open.scdn.co/cdn/build/mwp/mwp-artist-page.d3fd7b76.css","build/mwp/mwp-artist-page.d3fd7b76.js":"https://open.scdn.co/cdn/build/mwp/mwp-artist-page.d3fd7b76.js","build/mwp/mwp-artist-page.d3fd7b76.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-artist-page.d3fd7b76.js.cee38d20.br","build/mwp/mwp-artist-page.js":"https://open.scdn.co/cdn/build/mwp/mwp-artist-page.d3fd7b76.js","build/mwp/mwp-connect-view-container.ada35d55.js":"https://open.scdn.co/cdn/build/mwp/mwp-connect-view-container.ada35d55.js","build/mwp/mwp-connect-view-container.js":"https://open.scdn.co/cdn/build/mwp/mwp-connect-view-container.ada35d55.js","build/mwp/mwp-context-menu-container.ab0d40cf.js":"https://open.scdn.co/cdn/build/mwp/mwp-context-menu-container.ab0d40cf.js","build/mwp/mwp-context-menu-container.js":"https://open.scdn.co/cdn/build/mwp/mwp-context-menu-container.ab0d40cf.js","build/mwp/mwp-dialog-container.b2edeca5.css":"https://open.scdn.co/cdn/build/mwp/mwp-dialog-container.b2edeca5.css","build/mwp/mwp-dialog-container.b2edeca5.js":"https://open.scdn.co/cdn/build/mwp/mwp-dialog-container.b2edeca5.js","build/mwp/mwp-dialog-container.b2edeca5.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-dialog-container.b2edeca5.js.6964ec35.br","build/mwp/mwp-dialog-container.css":"https://open.scdn.co/cdn/build/mwp/mwp-dialog-container.b2edeca5.css","build/mwp/mwp-dialog-container.js":"https://open.scdn.co/cdn/build/mwp/mwp-dialog-container.b2edeca5.js","build/mwp/mwp-genre-view.02807385.js":"https://open.scdn.co/cdn/build/mwp/mwp-genre-view.02807385.js","build/mwp/mwp-genre-view.02807385.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-genre-view.02807385.js.7dfb8da3.br","build/mwp/mwp-genre-view.js":"https://open.scdn.co/cdn/build/mwp/mwp-genre-view.02807385.js","build/mwp/mwp-home.3aa18cd5.css":"https://open.scdn.co/cdn/build/mwp/mwp-home.3aa18cd5.css","build/mwp/mwp-home.3aa18cd5.js":"https://open.scdn.co/cdn/build/mwp/mwp-home.3aa18cd5.js","build/mwp/mwp-home.3aa18cd5.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-home.3aa18cd5.js.60b5fdce.br","build/mwp/mwp-home.css":"https://open.scdn.co/cdn/build/mwp/mwp-home.3aa18cd5.css","build/mwp/mwp-home.js":"https://open.scdn.co/cdn/build/mwp/mwp-home.3aa18cd5.js","build/mwp/mwp-now-playing-bar-container.f109d465.js":"https://open.scdn.co/cdn/build/mwp/mwp-now-playing-bar-container.f109d465.js","build/mwp/mwp-now-playing-bar-container.js":"https://open.scdn.co/cdn/build/mwp/mwp-now-playing-bar-container.f109d465.js","build/mwp/mwp-now-playing-view-container.f6f7b075.js":"https://open.scdn.co/cdn/build/mwp/mwp-now-playing-view-container.f6f7b075.js","build/mwp/mwp-now-playing-view-container.f6f7b075.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-now-playing-view-container.f6f7b075.js.22b15119.br","build/mwp/mwp-now-playing-view-container.js":"https://open.scdn.co/cdn/build/mwp/mwp-now-playing-view-container.f6f7b075.js","build/mwp/mwp-search-landing.04a5aab5.js":"https://open.scdn.co/cdn/build/mwp/mwp-search-landing.04a5aab5.js","build/mwp/mwp-search-landing.js":"https://open.scdn.co/cdn/build/mwp/mwp-search-landing.04a5aab5.js","build/mwp/mwp-search-results.2f88a672.css":"https://open.scdn.co/cdn/build/mwp/mwp-search-results.2f88a672.css","build/mwp/mwp-search-results.2f88a672.js":"https://open.scdn.co/cdn/build/mwp/mwp-search-results.2f88a672.js","build/mwp/mwp-search-results.2f88a672.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-search-results.2f88a672.js.897c214b.br","build/mwp/mwp-search-results.css":"https://open.scdn.co/cdn/build/mwp/mwp-search-results.2f88a672.css","build/mwp/mwp-search-results.js":"https://open.scdn.co/cdn/build/mwp/mwp-search-results.2f88a672.js","build/mwp/mwp-trending-view.2d818842.js":"https://open.scdn.co/cdn/build/mwp/mwp-trending-view.2d818842.js","build/mwp/mwp-trending-view.2d818842.js.br":"https://open.scdn.co/cdn/build/mwp/mwp-trending-view.2d818842.js.04dcf674.br","build/mwp/mwp-trending-view.js":"https://open.scdn.co/cdn/build/mwp/mwp-trending-view.2d818842.js","build/mwp/mwp-upsell.5d0a0fbf.js":"https://open.scdn.co/cdn/build/mwp/mwp-upsell.5d0a0fbf.js","build/mwp/mwp-upsell.js":"https://open.scdn.co/cdn/build/mwp/mwp-upsell.5d0a0fbf.js","build/mwp/mwp-user-profile.css":"https://open.scdn.co/cdn/build/mwp/mwp-user-profile.e8c8f72f.css","build/mwp/mwp-user-profile.e8c8f72f.css":"https://open.scdn.co/cdn/build/mwp/mwp-user-profile.e8c8f72f.css","build/mwp/mwp-user-profile.e8c8f72f.js":"https://open.scdn.co/cdn/build/mwp/mwp-user-profile.e8c8f72f.js","build/mwp/mwp-user-profile.js":"https://open.scdn.co/cdn/build/mwp/mwp-user-profile.e8c8f72f.js","build/mwp/mwp.3ac4d2d7.css":"https://open.scdn.co/cdn/build/mwp/mwp.3ac4d2d7.css","build/mwp/mwp.4d4dbdb8.js":"https://open.scdn.co/cdn/build/mwp/mwp.4d4dbdb8.js","build/mwp/mwp.4d4dbdb8.js.br":"https://open.scdn.co/cdn/build/mwp/mwp.4d4dbdb8.js.2f6c9f59.br","build/mwp/mwp.css":"https://open.scdn.co/cdn/build/mwp/mwp.3ac4d2d7.css","build/mwp/mwp.js":"https://open.scdn.co/cdn/build/mwp/mwp.4d4dbdb8.js","build/mwp/vendor~mwp.d58f3437.js":"https://open.scdn.co/cdn/build/mwp/vendor~mwp.d58f3437.js","build/mwp/vendor~mwp.d58f3437.js.br":"https://open.scdn.co/cdn/build/mwp/vendor~mwp.d58f3437.js.383ae840.br","build/mwp/vendor~mwp.js":"https://open.scdn.co/cdn/build/mwp/vendor~mwp.d58f3437.js","build/web-player/188.ab01efef.css":"https://open.scdn.co/cdn/build/web-player/188.ab01efef.css","build/web-player/188.ab01efef.js":"https://open.scdn.co/cdn/build/web-player/188.ab01efef.js","build/web-player/188.css":"https://open.scdn.co/cdn/build/web-player/188.ab01efef.css","build/web-player/188.js":"https://open.scdn.co/cdn/build/web-player/188.ab01efef.js","build/web-player/258.44a74711.css":"https://open.scdn.co/cdn/build/web-player/258.44a74711.css","build/web-player/258.44a74711.js":"https://open.scdn.co/cdn/build/web-player/258.44a74711.js","build/web-player/258.css":"https://open.scdn.co/cdn/build/web-player/258.44a74711.css","build/web-player/258.js":"https://open.scdn.co/cdn/build/web-player/258.44a74711.js","build/web-player/265.84ed0083.js":"https://open.scdn.co/cdn/build/web-player/265.84ed0083.js","build/web-player/265.js":"https://open.scdn.co/cdn/build/web-player/265.84ed0083.js","build/web-player/375.bde9085a.css":"https://open.scdn.co/cdn/build/web-player/375.bde9085a.css","build/web-player/375.bde9085a.js":"https://open.scdn.co/cdn/build/web-player/375.bde9085a.js","build/web-player/375.css":"https://open.scdn.co/cdn/build/web-player/375.bde9085a.css","build/web-player/375.js":"https://open.scdn.co/cdn/build/web-player/375.bde9085a.js","build/web-player/381.ea8ad6fb.js":"https://open.scdn.co/cdn/build/web-player/381.ea8ad6fb.js","build/web-player/381.js":"https://open.scdn.co/cdn/build/web-player/381.ea8ad6fb.js","build/web-player/396.fe30e3f3.js":"https://open.scdn.co/cdn/build/web-player/396.fe30e3f3.js","build/web-player/396.js":"https://open.scdn.co/cdn/build/web-player/396.fe30e3f3.js","build/web-player/479.a32cf8bd.css":"https://open.scdn.co/cdn/build/web-player/479.a32cf8bd.css","build/web-player/479.a32cf8bd.js":"https://open.scdn.co/cdn/build/web-player/479.a32cf8bd.js","build/web-player/479.css":"https://open.scdn.co/cdn/build/web-player/479.a32cf8bd.css","build/web-player/479.js":"https://open.scdn.co/cdn/build/web-player/479.a32cf8bd.js","build/web-player/696.d6ce78b2.js":"https://open.scdn.co/cdn/build/web-player/696.d6ce78b2.js","build/web-player/696.js":"https://open.scdn.co/cdn/build/web-player/696.d6ce78b2.js","build/web-player/774.4368be5b.css":"https://open.scdn.co/cdn/build/web-player/774.4368be5b.css","build/web-player/774.4368be5b.js":"https://open.scdn.co/cdn/build/web-player/774.4368be5b.js","build/web-player/774.css":"https://open.scdn.co/cdn/build/web-player/774.4368be5b.css","build/web-player/774.js":"https://open.scdn.co/cdn/build/web-player/774.4368be5b.js","build/web-player/818.4078c21a.css":"https://open.scdn.co/cdn/build/web-player/818.4078c21a.css","build/web-player/818.4078c21a.js":"https://open.scdn.co/cdn/build/web-player/818.4078c21a.js","build/web-player/818.css":"https://open.scdn.co/cdn/build/web-player/818.4078c21a.css","build/web-player/818.js":"https://open.scdn.co/cdn/build/web-player/818.4078c21a.js","build/web-player/collection-music-download.1d190c7c.js":"https://open.scdn.co/cdn/build/web-player/collection-music-download.1d190c7c.js","build/web-player/collection-music-download.js":"https://open.scdn.co/cdn/build/web-player/collection-music-download.1d190c7c.js","build/web-player/in-app-messaging-preview.5be90e67.css":"https://open.scdn.co/cdn/build/web-player/in-app-messaging-preview.5be90e67.css","build/web-player/in-app-messaging-preview.5be90e67.js":"https://open.scdn.co/cdn/build/web-player/in-app-messaging-preview.5be90e67.js","build/web-player/in-app-messaging-preview.css":"https://open.scdn.co/cdn/build/web-player/in-app-messaging-preview.5be90e67.css","build/web-player/in-app-messaging-preview.js":"https://open.scdn.co/cdn/build/web-player/in-app-messaging-preview.5be90e67.js","build/web-player/service-worker.js":"https://open.scdn.co/cdn/build/web-player/service-worker.c8ab947f.js","build/web-player/vendor~web-player.c33c2080.js":"https://open.scdn.co/cdn/build/web-player/vendor~web-player.c33c2080.js","build/web-player/vendor~web-player.js":"https://open.scdn.co/cdn/build/web-player/vendor~web-player.c33c2080.js","build/web-player/web-player.0ae0e44f.js":"https://open.scdn.co/cdn/build/web-player/web-player.0ae0e44f.js","build/web-player/web-player.9001c849.css":"https://open.scdn.co/cdn/build/web-player/web-player.9001c849.css","build/web-player/web-player.css":"https://open.scdn.co/cdn/build/web-player/web-player.9001c849.css","build/web-player/web-player.js":"https://open.scdn.co/cdn/build/web-player/web-player.0ae0e44f.js","build/web-player/xpui-desktop-modals.css":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-modals.f00fa475.css","build/web-player/xpui-desktop-modals.f00fa475.css":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-modals.f00fa475.css","build/web-player/xpui-desktop-modals.f00fa475.js":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-modals.f00fa475.js","build/web-player/xpui-desktop-modals.js":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-modals.f00fa475.js","build/web-player/xpui-desktop-routes-debug-utils.3d805afe.css":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-debug-utils.3d805afe.css","build/web-player/xpui-desktop-routes-debug-utils.3d805afe.js":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-debug-utils.3d805afe.js","build/web-player/xpui-desktop-routes-debug-utils.css":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-debug-utils.3d805afe.css","build/web-player/xpui-desktop-routes-debug-utils.js":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-debug-utils.3d805afe.js","build/web-player/xpui-desktop-routes-homepage-takeover-ad.2a406667.css":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-homepage-takeover-ad.2a406667.css","build/web-player/xpui-desktop-routes-homepage-takeover-ad.2a406667.js":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-homepage-takeover-ad.2a406667.js","build/web-player/xpui-desktop-routes-homepage-takeover-ad.css":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-homepage-takeover-ad.2a406667.css","build/web-player/xpui-desktop-routes-homepage-takeover-ad.js":"https://open.scdn.co/cdn/build/web-player/xpui-desktop-routes-homepage-takeover-ad.2a406667.js","build/web-player/xpui-routes-album.87cd1a76.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-album.87cd1a76.css","build/web-player/xpui-routes-album.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-album.87cd1a76.css","build/web-player/xpui-routes-all-episode-sponsors.61a5c3ae.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-all-episode-sponsors.61a5c3ae.css","build/web-player/xpui-routes-all-episode-sponsors.61a5c3ae.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-all-episode-sponsors.61a5c3ae.js","build/web-player/xpui-routes-all-episode-sponsors.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-all-episode-sponsors.61a5c3ae.css","build/web-player/xpui-routes-all-episode-sponsors.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-all-episode-sponsors.61a5c3ae.js","build/web-player/xpui-routes-all-show-sponsors.5abd32ed.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-all-show-sponsors.5abd32ed.js","build/web-player/xpui-routes-all-show-sponsors.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-all-show-sponsors.5abd32ed.js","build/web-player/xpui-routes-artist.1e710788.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-artist.1e710788.css","build/web-player/xpui-routes-artist.1e710788.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-artist.1e710788.js","build/web-player/xpui-routes-artist.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-artist.1e710788.css","build/web-player/xpui-routes-artist.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-artist.1e710788.js","build/web-player/xpui-routes-blend.508b27dd.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-blend.508b27dd.css","build/web-player/xpui-routes-blend.508b27dd.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-blend.508b27dd.js","build/web-player/xpui-routes-blend.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-blend.508b27dd.css","build/web-player/xpui-routes-blend.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-blend.508b27dd.js","build/web-player/xpui-routes-collection-concerts.75e8bf53.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-concerts.75e8bf53.css","build/web-player/xpui-routes-collection-concerts.75e8bf53.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-concerts.75e8bf53.js","build/web-player/xpui-routes-collection-concerts.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-concerts.75e8bf53.css","build/web-player/xpui-routes-collection-concerts.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-concerts.75e8bf53.js","build/web-player/xpui-routes-collection-local-files.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-local-files.dc6136e9.css","build/web-player/xpui-routes-collection-local-files.dc6136e9.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-local-files.dc6136e9.css","build/web-player/xpui-routes-collection-local-files.dc6136e9.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-local-files.dc6136e9.js","build/web-player/xpui-routes-collection-local-files.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-local-files.dc6136e9.js","build/web-player/xpui-routes-collection-songs.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-songs.f14bd7a4.css","build/web-player/xpui-routes-collection-songs.f14bd7a4.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-songs.f14bd7a4.css","build/web-player/xpui-routes-collection-songs.f14bd7a4.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-songs.f14bd7a4.js","build/web-player/xpui-routes-collection-songs.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection-songs.f14bd7a4.js","build/web-player/xpui-routes-collection.57275a6b.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection.57275a6b.css","build/web-player/xpui-routes-collection.57275a6b.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection.57275a6b.js","build/web-player/xpui-routes-collection.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection.57275a6b.css","build/web-player/xpui-routes-collection.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-collection.57275a6b.js","build/web-player/xpui-routes-concert.07d675bd.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-concert.07d675bd.css","build/web-player/xpui-routes-concert.07d675bd.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-concert.07d675bd.js","build/web-player/xpui-routes-concert.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-concert.07d675bd.css","build/web-player/xpui-routes-concert.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-concert.07d675bd.js","build/web-player/xpui-routes-create-playlist.5d9b9990.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-create-playlist.5d9b9990.js","build/web-player/xpui-routes-create-playlist.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-create-playlist.5d9b9990.js","build/web-player/xpui-routes-download-page.0f93b2ea.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-download-page.0f93b2ea.css","build/web-player/xpui-routes-download-page.0f93b2ea.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-download-page.0f93b2ea.js","build/web-player/xpui-routes-download-page.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-download-page.0f93b2ea.css","build/web-player/xpui-routes-download-page.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-download-page.0f93b2ea.js","build/web-player/xpui-routes-enhanced-playlist.5769472a.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-enhanced-playlist.5769472a.css","build/web-player/xpui-routes-enhanced-playlist.5769472a.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-enhanced-playlist.5769472a.js","build/web-player/xpui-routes-enhanced-playlist.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-enhanced-playlist.5769472a.css","build/web-player/xpui-routes-enhanced-playlist.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-enhanced-playlist.5769472a.js","build/web-player/xpui-routes-episode.1c0055a3.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-episode.1c0055a3.css","build/web-player/xpui-routes-episode.1c0055a3.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-episode.1c0055a3.js","build/web-player/xpui-routes-episode.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-episode.1c0055a3.css","build/web-player/xpui-routes-episode.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-episode.1c0055a3.js","build/web-player/xpui-routes-folder.9dbea3fe.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-folder.9dbea3fe.css","build/web-player/xpui-routes-folder.9dbea3fe.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-folder.9dbea3fe.js","build/web-player/xpui-routes-folder.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-folder.9dbea3fe.css","build/web-player/xpui-routes-folder.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-folder.9dbea3fe.js","build/web-player/xpui-routes-home-v2.b361539e.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home-v2.b361539e.css","build/web-player/xpui-routes-home-v2.b361539e.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home-v2.b361539e.js","build/web-player/xpui-routes-home-v2.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home-v2.b361539e.css","build/web-player/xpui-routes-home-v2.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home-v2.b361539e.js","build/web-player/xpui-routes-home.8e02d07a.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home.8e02d07a.css","build/web-player/xpui-routes-home.8e02d07a.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home.8e02d07a.js","build/web-player/xpui-routes-home.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home.8e02d07a.css","build/web-player/xpui-routes-home.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-home.8e02d07a.js","build/web-player/xpui-routes-offline-browse.0a28b795.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-offline-browse.0a28b795.css","build/web-player/xpui-routes-offline-browse.0a28b795.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-offline-browse.0a28b795.js","build/web-player/xpui-routes-offline-browse.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-offline-browse.0a28b795.css","build/web-player/xpui-routes-offline-browse.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-offline-browse.0a28b795.js","build/web-player/xpui-routes-playlist.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-playlist.f166f737.css","build/web-player/xpui-routes-playlist.f166f737.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-playlist.f166f737.css","build/web-player/xpui-routes-playlist.f166f737.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-playlist.f166f737.js","build/web-player/xpui-routes-playlist.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-playlist.f166f737.js","build/web-player/xpui-routes-profile.b66fc984.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-profile.b66fc984.css","build/web-player/xpui-routes-profile.b66fc984.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-profile.b66fc984.js","build/web-player/xpui-routes-profile.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-profile.b66fc984.css","build/web-player/xpui-routes-profile.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-profile.b66fc984.js","build/web-player/xpui-routes-queue.86c9c5cf.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-queue.86c9c5cf.css","build/web-player/xpui-routes-queue.86c9c5cf.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-queue.86c9c5cf.js","build/web-player/xpui-routes-queue.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-queue.86c9c5cf.css","build/web-player/xpui-routes-queue.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-queue.86c9c5cf.js","build/web-player/xpui-routes-track-v2.c9837b83.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-track-v2.c9837b83.css","build/web-player/xpui-routes-track-v2.c9837b83.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-track-v2.c9837b83.js","build/web-player/xpui-routes-track-v2.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-track-v2.c9837b83.css","build/web-player/xpui-routes-track-v2.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-track-v2.c9837b83.js","build/web-player/xpui-routes-track.44f8c062.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-track.44f8c062.js","build/web-player/xpui-routes-track.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-track.44f8c062.js","build/web-player/xpui-routes-view.500b3f86.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-view.500b3f86.css","build/web-player/xpui-routes-view.500b3f86.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-view.500b3f86.js","build/web-player/xpui-routes-view.css":"https://open.scdn.co/cdn/build/web-player/xpui-routes-view.500b3f86.css","build/web-player/xpui-routes-view.js":"https://open.scdn.co/cdn/build/web-player/xpui-routes-view.500b3f86.js","fonts/CircularSpUIAraOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.6d6a4c25.otf","fonts/CircularSpUIAraOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.05b31ded.woff","fonts/CircularSpUIAraOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Black.c32951f4.woff2","fonts/CircularSpUIAraOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.f97cb921.otf","fonts/CircularSpUIAraOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.9ddc7126.woff","fonts/CircularSpUIAraOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Bold.317e96e5.woff2","fonts/CircularSpUIAraOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.f0effcd1.otf","fonts/CircularSpUIAraOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.3ad862e2.woff","fonts/CircularSpUIAraOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Book.aaab109b.woff2","fonts/CircularSpUIAraOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.f0833f3b.otf","fonts/CircularSpUIAraOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.5c7ed8d8.woff","fonts/CircularSpUIAraOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIAraOnly-Light.dde45e52.woff2","fonts/CircularSpUICyrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.50cd1ca9.otf","fonts/CircularSpUICyrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.7536a73f.woff","fonts/CircularSpUICyrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Black.f5526fc4.woff2","fonts/CircularSpUICyrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.67641b90.otf","fonts/CircularSpUICyrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.909126fc.woff","fonts/CircularSpUICyrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Bold.30dc9fb2.woff2","fonts/CircularSpUICyrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.15af6ebe.otf","fonts/CircularSpUICyrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.918c53b8.woff","fonts/CircularSpUICyrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Book.6a858994.woff2","fonts/CircularSpUICyrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.b10eb959.otf","fonts/CircularSpUICyrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.034997d0.woff","fonts/CircularSpUICyrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUICyrOnly-Light.55fa9f4a.woff2","fonts/CircularSpUIHbrOnly-Black.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.11abebe4.otf","fonts/CircularSpUIHbrOnly-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.0a11e734.woff","fonts/CircularSpUIHbrOnly-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Black.217fb21f.woff2","fonts/CircularSpUIHbrOnly-Bold.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.57b36278.otf","fonts/CircularSpUIHbrOnly-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.9f406804.woff","fonts/CircularSpUIHbrOnly-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Bold.ef043f44.woff2","fonts/CircularSpUIHbrOnly-Book.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.fae4aece.otf","fonts/CircularSpUIHbrOnly-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.ad2b13cd.woff","fonts/CircularSpUIHbrOnly-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Book.cb36b6ec.woff2","fonts/CircularSpUIHbrOnly-Light.otf":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2e1df62a.otf","fonts/CircularSpUIHbrOnly-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.2128eeac.woff","fonts/CircularSpUIHbrOnly-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIHbrOnly-Light.4884da16.woff2","fonts/CircularSpUIv3T-Black.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.ce8ef887.ttf","fonts/CircularSpUIv3T-Black.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.effa986f.woff","fonts/CircularSpUIv3T-Black.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Black.c21e63c5.woff2","fonts/CircularSpUIv3T-Bold.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.7eb7d0f7.ttf","fonts/CircularSpUIv3T-Bold.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.10e93738.woff","fonts/CircularSpUIv3T-Bold.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Bold.8d0a45cc.woff2","fonts/CircularSpUIv3T-Book.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.a357677a.ttf","fonts/CircularSpUIv3T-Book.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.ea8d19db.woff","fonts/CircularSpUIv3T-Book.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Book.3466e0ec.woff2","fonts/CircularSpUIv3T-Light.ttf":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.89e4be2e.ttf","fonts/CircularSpUIv3T-Light.woff":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.2a78c017.woff","fonts/CircularSpUIv3T-Light.woff2":"https://open.scdn.co/cdn/fonts/CircularSpUIv3T-Light.afd9ab26.woff2","fonts/spoticon_regular_2.ttf":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.127670b5.ttf","fonts/spoticon_regular_2.woff":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.ff4c6091.woff","fonts/spoticon_regular_2.woff2":"https://open.scdn.co/cdn/fonts/spoticon_regular_2.d319d911.woff2","generated/manifest-mobile-web-player.json":"https://open.scdn.co/cdn/generated/manifest-mobile-web-player.7e7a2009.json","generated/manifest-web-player.json":"https://open.scdn.co/cdn/generated/manifest-web-player.1d90e604.json","generated/opensearch.xml":"https://open.scdn.co/cdn/generated/opensearch.7f46e5b2.xml","images/checkmark.png":"https://open.scdn.co/cdn/images/checkmark.9e1a7608.png","images/concert-hub-fb-card.png":"https://open.scdn.co/cdn/images/concert-hub-fb-card.edb38821.png","images/concert-hub-header.png":"https://open.scdn.co/cdn/images/concert-hub-header.56bcad9b.png","images/concert-hub-iphone-de.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-de.2f132ca3.png","images/concert-hub-iphone-el.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-el.8b3b94a4.png","images/concert-hub-iphone-en.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-en.88b1bea2.png","images/concert-hub-iphone-es_419.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es_419.f61fbda5.png","images/concert-hub-iphone-es.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-es.f61fbda5.png","images/concert-hub-iphone-fi.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fi.25a8376a.png","images/concert-hub-iphone-fr_CA.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr_CA.bc238a54.png","images/concert-hub-iphone-fr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-fr.60ec537b.png","images/concert-hub-iphone-hu.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-hu.f1725c37.png","images/concert-hub-iphone-id.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-id.f70b2301.png","images/concert-hub-iphone-it.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-it.b18651c6.png","images/concert-hub-iphone-ja.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ja.88b1bea2.png","images/concert-hub-iphone-ms.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-ms.c695e9de.png","images/concert-hub-iphone-nl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-nl.70e57293.png","images/concert-hub-iphone-pl.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pl.6ca1b2dc.png","images/concert-hub-iphone-pt_BR.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-pt_BR.7e417576.png","images/concert-hub-iphone-sv.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-sv.67301592.png","images/concert-hub-iphone-tr.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-tr.f081d198.png","images/concert-hub-iphone-zh_TW.png":"https://open.scdn.co/cdn/images/concert-hub-iphone-zh_TW.88b1bea2.png","images/concert-hub-twitter-card.png":"https://open.scdn.co/cdn/images/concert-hub-twitter-card.f9d9a6d4.png","images/connect_header@1x.png":"https://open.scdn.co/cdn/images/connect_header@1x.8f827808.png","images/connect-to-devices-white.svg":"https://open.scdn.co/cdn/images/connect-to-devices-white.69d4229a.svg","images/desktop-auth-check.svg":"https://open.scdn.co/cdn/images/desktop-auth-check.65be3bbc.svg","images/desktop-auth-error.svg":"https://open.scdn.co/cdn/images/desktop-auth-error.b82f823b.svg","images/devices/android.png":"https://open.scdn.co/cdn/images/devices/android.58bbae05.png","images/devices/ios.png":"https://open.scdn.co/cdn/images/devices/ios.077f15ff.png","images/devices/mac-web.png":"https://open.scdn.co/cdn/images/devices/mac-web.cc876776.png","images/devices/mac.png":"https://open.scdn.co/cdn/images/devices/mac.5f2975e9.png","images/devices/windowsphone.png":"https://open.scdn.co/cdn/images/devices/windowsphone.35cd2cdd.png","images/download-badges/apple/ar.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ar.d7906eb1.svg","images/download-badges/apple/az.svg":"https://open.scdn.co/cdn/images/download-badges/apple/az.00a386af.svg","images/download-badges/apple/bg.svg":"https://open.scdn.co/cdn/images/download-badges/apple/bg.e26976f9.svg","images/download-badges/apple/cs_CZ.svg":"https://open.scdn.co/cdn/images/download-badges/apple/cs_CZ.6f146d8e.svg","images/download-badges/apple/da.svg":"https://open.scdn.co/cdn/images/download-badges/apple/da.9fa48366.svg","images/download-badges/apple/de.svg":"https://open.scdn.co/cdn/images/download-badges/apple/de.d5d0e551.svg","images/download-badges/apple/ee.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ee.0189025b.svg","images/download-badges/apple/el.svg":"https://open.scdn.co/cdn/images/download-badges/apple/el.ea7795e2.svg","images/download-badges/apple/en.svg":"https://open.scdn.co/cdn/images/download-badges/apple/en.8c4986ee.svg","images/download-badges/apple/es_mx.svg":"https://open.scdn.co/cdn/images/download-badges/apple/es_mx.838d2617.svg","images/download-badges/apple/es.svg":"https://open.scdn.co/cdn/images/download-badges/apple/es.bc588dbd.svg","images/download-badges/apple/fi.svg":"https://open.scdn.co/cdn/images/download-badges/apple/fi.833a71e4.svg","images/download-badges/apple/fp.svg":"https://open.scdn.co/cdn/images/download-badges/apple/fp.ed4afb36.svg","images/download-badges/apple/fr_ca.svg":"https://open.scdn.co/cdn/images/download-badges/apple/fr_ca.fa603df2.svg","images/download-badges/apple/fr.svg":"https://open.scdn.co/cdn/images/download-badges/apple/fr.fa603df2.svg","images/download-badges/apple/he.svg":"https://open.scdn.co/cdn/images/download-badges/apple/he.f2cc09e3.svg","images/download-badges/apple/hu.svg":"https://open.scdn.co/cdn/images/download-badges/apple/hu.e04e4dd3.svg","images/download-badges/apple/id.svg":"https://open.scdn.co/cdn/images/download-badges/apple/id.879a2fc6.svg","images/download-badges/apple/int.svg":"https://open.scdn.co/cdn/images/download-badges/apple/int.8c4986ee.svg","images/download-badges/apple/it.svg":"https://open.scdn.co/cdn/images/download-badges/apple/it.d71a027e.svg","images/download-badges/apple/ja.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ja.621b45d8.svg","images/download-badges/apple/ko.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ko.97efaa84.svg","images/download-badges/apple/lt.svg":"https://open.scdn.co/cdn/images/download-badges/apple/lt.62927c82.svg","images/download-badges/apple/lv.svg":"https://open.scdn.co/cdn/images/download-badges/apple/lv.ef1ba614.svg","images/download-badges/apple/ms.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ms.06625cd6.svg","images/download-badges/apple/mt.svg":"https://open.scdn.co/cdn/images/download-badges/apple/mt.2e719e0e.svg","images/download-badges/apple/nb.svg":"https://open.scdn.co/cdn/images/download-badges/apple/nb.71cf46e4.svg","images/download-badges/apple/nl.svg":"https://open.scdn.co/cdn/images/download-badges/apple/nl.e16ed416.svg","images/download-badges/apple/pl.svg":"https://open.scdn.co/cdn/images/download-badges/apple/pl.c537e41d.svg","images/download-badges/apple/pt_br.svg":"https://open.scdn.co/cdn/images/download-badges/apple/pt_br.7b81b64f.svg","images/download-badges/apple/pt.svg":"https://open.scdn.co/cdn/images/download-badges/apple/pt.a0224035.svg","images/download-badges/apple/ro.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ro.ad28d7d9.svg","images/download-badges/apple/ru.svg":"https://open.scdn.co/cdn/images/download-badges/apple/ru.2ac2876e.svg","images/download-badges/apple/sk.svg":"https://open.scdn.co/cdn/images/download-badges/apple/sk.f5084542.svg","images/download-badges/apple/sl.svg":"https://open.scdn.co/cdn/images/download-badges/apple/sl.324f34cd.svg","images/download-badges/apple/sv.svg":"https://open.scdn.co/cdn/images/download-badges/apple/sv.19773ac2.svg","images/download-badges/apple/th_TH.svg":"https://open.scdn.co/cdn/images/download-badges/apple/th_TH.0a069d53.svg","images/download-badges/apple/tr.svg":"https://open.scdn.co/cdn/images/download-badges/apple/tr.8be97741.svg","images/download-badges/apple/vi_VN.svg":"https://open.scdn.co/cdn/images/download-badges/apple/vi_VN.e2570fa1.svg","images/download-badges/apple/zh_HANS.svg":"https://open.scdn.co/cdn/images/download-badges/apple/zh_HANS.8b95a458.svg","images/download-badges/apple/zh_HANT.svg":"https://open.scdn.co/cdn/images/download-badges/apple/zh_HANT.a1838441.svg","images/download-badges/google/af.svg":"https://open.scdn.co/cdn/images/download-badges/google/af.55f5a525.svg","images/download-badges/google/am.svg":"https://open.scdn.co/cdn/images/download-badges/google/am.170d06df.svg","images/download-badges/google/ar.svg":"https://open.scdn.co/cdn/images/download-badges/google/ar.75be3942.svg","images/download-badges/google/az.svg":"https://open.scdn.co/cdn/images/download-badges/google/az.f3cd9a4a.svg","images/download-badges/google/be.svg":"https://open.scdn.co/cdn/images/download-badges/google/be.e1cd0535.svg","images/download-badges/google/bg.svg":"https://open.scdn.co/cdn/images/download-badges/google/bg.5f0e550d.svg","images/download-badges/google/bn.svg":"https://open.scdn.co/cdn/images/download-badges/google/bn.4ce7bc27.svg","images/download-badges/google/bs.svg":"https://open.scdn.co/cdn/images/download-badges/google/bs.7fd7ae7a.svg","images/download-badges/google/ca.svg":"https://open.scdn.co/cdn/images/download-badges/google/ca.2cdc6348.svg","images/download-badges/google/cr.svg":"https://open.scdn.co/cdn/images/download-badges/google/cr.44f3f6dd.svg","images/download-badges/google/cs_CZ.svg":"https://open.scdn.co/cdn/images/download-badges/google/cs_CZ.1a2cf31d.svg","images/download-badges/google/da.svg":"https://open.scdn.co/cdn/images/download-badges/google/da.615e44e2.svg","images/download-badges/google/de.svg":"https://open.scdn.co/cdn/images/download-badges/google/de.222352a7.svg","images/download-badges/google/el.svg":"https://open.scdn.co/cdn/images/download-badges/google/el.8959a65f.svg","images/download-badges/google/en.svg":"https://open.scdn.co/cdn/images/download-badges/google/en.060d4113.svg","images/download-badges/google/es_419.svg":"https://open.scdn.co/cdn/images/download-badges/google/es_419.1c88179e.svg","images/download-badges/google/es.svg":"https://open.scdn.co/cdn/images/download-badges/google/es.ac9ce85f.svg","images/download-badges/google/et.svg":"https://open.scdn.co/cdn/images/download-badges/google/et.a4590629.svg","images/download-badges/google/eu.svg":"https://open.scdn.co/cdn/images/download-badges/google/eu.a31efb99.svg","images/download-badges/google/fa.svg":"https://open.scdn.co/cdn/images/download-badges/google/fa.a84f7cdd.svg","images/download-badges/google/fi.svg":"https://open.scdn.co/cdn/images/download-badges/google/fi.d365099d.svg","images/download-badges/google/fp.svg":"https://open.scdn.co/cdn/images/download-badges/google/fp.2db54495.svg","images/download-badges/google/fr_ca.svg":"https://open.scdn.co/cdn/images/download-badges/google/fr_ca.8dbe7040.svg","images/download-badges/google/fr.svg":"https://open.scdn.co/cdn/images/download-badges/google/fr.f23f5a3c.svg","images/download-badges/google/gl.svg":"https://open.scdn.co/cdn/images/download-badges/google/gl.277c3e98.svg","images/download-badges/google/gu.svg":"https://open.scdn.co/cdn/images/download-badges/google/gu.2f944c71.svg","images/download-badges/google/he.svg":"https://open.scdn.co/cdn/images/download-badges/google/he.1bd37417.svg","images/download-badges/google/hi.svg":"https://open.scdn.co/cdn/images/download-badges/google/hi.52cce4e9.svg","images/download-badges/google/hr.svg":"https://open.scdn.co/cdn/images/download-badges/google/hr.68335d4a.svg","images/download-badges/google/hu.svg":"https://open.scdn.co/cdn/images/download-badges/google/hu.cec01153.svg","images/download-badges/google/hy.svg":"https://open.scdn.co/cdn/images/download-badges/google/hy.19690d74.svg","images/download-badges/google/id.svg":"https://open.scdn.co/cdn/images/download-badges/google/id.761c3288.svg","images/download-badges/google/int.svg":"https://open.scdn.co/cdn/images/download-badges/google/int.060d4113.svg","images/download-badges/google/is.svg":"https://open.scdn.co/cdn/images/download-badges/google/is.8bb173f7.svg","images/download-badges/google/it.svg":"https://open.scdn.co/cdn/images/download-badges/google/it.0a89994f.svg","images/download-badges/google/ja.svg":"https://open.scdn.co/cdn/images/download-badges/google/ja.6f09cc26.svg","images/download-badges/google/ka.svg":"https://open.scdn.co/cdn/images/download-badges/google/ka.d2d3b2c0.svg","images/download-badges/google/kk.svg":"https://open.scdn.co/cdn/images/download-badges/google/kk.60fd0853.svg","images/download-badges/google/km.svg":"https://open.scdn.co/cdn/images/download-badges/google/km.0ba3f716.svg","images/download-badges/google/kn.svg":"https://open.scdn.co/cdn/images/download-badges/google/kn.f3871482.svg","images/download-badges/google/ko.svg":"https://open.scdn.co/cdn/images/download-badges/google/ko.96e60d91.svg","images/download-badges/google/ky.svg":"https://open.scdn.co/cdn/images/download-badges/google/ky.46131ad1.svg","images/download-badges/google/lo.svg":"https://open.scdn.co/cdn/images/download-badges/google/lo.3df40758.svg","images/download-badges/google/lt.svg":"https://open.scdn.co/cdn/images/download-badges/google/lt.6ac78e60.svg","images/download-badges/google/lv.svg":"https://open.scdn.co/cdn/images/download-badges/google/lv.356a4fa8.svg","images/download-badges/google/mk.svg":"https://open.scdn.co/cdn/images/download-badges/google/mk.549f0f7f.svg","images/download-badges/google/ml.svg":"https://open.scdn.co/cdn/images/download-badges/google/ml.cbd27c60.svg","images/download-badges/google/mn.svg":"https://open.scdn.co/cdn/images/download-badges/google/mn.9ff6eb1e.svg","images/download-badges/google/mr.svg":"https://open.scdn.co/cdn/images/download-badges/google/mr.a0ac9011.svg","images/download-badges/google/ms.svg":"https://open.scdn.co/cdn/images/download-badges/google/ms.a920a039.svg","images/download-badges/google/my.svg":"https://open.scdn.co/cdn/images/download-badges/google/my.8c1d448d.svg","images/download-badges/google/nb.svg":"https://open.scdn.co/cdn/images/download-badges/google/nb.7227b6a2.svg","images/download-badges/google/ne.svg":"https://open.scdn.co/cdn/images/download-badges/google/ne.1b1c6cb0.svg","images/download-badges/google/nl.svg":"https://open.scdn.co/cdn/images/download-badges/google/nl.60840ed7.svg","images/download-badges/google/pa.svg":"https://open.scdn.co/cdn/images/download-badges/google/pa.2fbda0cf.svg","images/download-badges/google/pl.svg":"https://open.scdn.co/cdn/images/download-badges/google/pl.05984a1a.svg","images/download-badges/google/pt_br.svg":"https://open.scdn.co/cdn/images/download-badges/google/pt_br.03fd0a20.svg","images/download-badges/google/pt.svg":"https://open.scdn.co/cdn/images/download-badges/google/pt.01fa7760.svg","images/download-badges/google/ro.svg":"https://open.scdn.co/cdn/images/download-badges/google/ro.52394f01.svg","images/download-badges/google/ru.svg":"https://open.scdn.co/cdn/images/download-badges/google/ru.4a75c567.svg","images/download-badges/google/si.svg":"https://open.scdn.co/cdn/images/download-badges/google/si.11e33f4f.svg","images/download-badges/google/sk.svg":"https://open.scdn.co/cdn/images/download-badges/google/sk.8b6098b4.svg","images/download-badges/google/sl.svg":"https://open.scdn.co/cdn/images/download-badges/google/sl.1fb7392b.svg","images/download-badges/google/sq.svg":"https://open.scdn.co/cdn/images/download-badges/google/sq.007a9b11.svg","images/download-badges/google/sr.svg":"https://open.scdn.co/cdn/images/download-badges/google/sr.7deee3c8.svg","images/download-badges/google/sv.svg":"https://open.scdn.co/cdn/images/download-badges/google/sv.694267c1.svg","images/download-badges/google/sw.svg":"https://open.scdn.co/cdn/images/download-badges/google/sw.ca00627d.svg","images/download-badges/google/ta.svg":"https://open.scdn.co/cdn/images/download-badges/google/ta.f72b8274.svg","images/download-badges/google/te.svg":"https://open.scdn.co/cdn/images/download-badges/google/te.710170eb.svg","images/download-badges/google/th_TH.svg":"https://open.scdn.co/cdn/images/download-badges/google/th_TH.c396a2b3.svg","images/download-badges/google/tr.svg":"https://open.scdn.co/cdn/images/download-badges/google/tr.8eba8880.svg","images/download-badges/google/ua.svg":"https://open.scdn.co/cdn/images/download-badges/google/ua.dae54416.svg","images/download-badges/google/ur.svg":"https://open.scdn.co/cdn/images/download-badges/google/ur.f63f68c9.svg","images/download-badges/google/uz.svg":"https://open.scdn.co/cdn/images/download-badges/google/uz.35dd654d.svg","images/download-badges/google/vi_VN.svg":"https://open.scdn.co/cdn/images/download-badges/google/vi_VN.1f252c03.svg","images/download-badges/google/zh_HANS.svg":"https://open.scdn.co/cdn/images/download-badges/google/zh_HANS.83747f32.svg","images/download-badges/google/zh_HANT.svg":"https://open.scdn.co/cdn/images/download-badges/google/zh_HANT.1f5c8004.svg","images/download-badges/google/zh_hk.svg":"https://open.scdn.co/cdn/images/download-badges/google/zh_hk.c5eb127a.svg","images/download-badges/google/zu.svg":"https://open.scdn.co/cdn/images/download-badges/google/zu.49f66ae6.svg","images/embed-legacy/copy-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed-legacy/copy-32_circle_grey_outline_bg.0c6130eb.svg","images/embed-legacy/embed-code-32_circle_grey_outline_bg.svg":"https://open.scdn.co/cdn/images/embed-legacy/embed-code-32_circle_grey_outline_bg.b40a255f.svg","images/embed-legacy/fb_colour.svg":"https://open.scdn.co/cdn/images/embed-legacy/fb_colour.13fa515f.svg","images/embed-legacy/messenger_colour.svg":"https://open.scdn.co/cdn/images/embed-legacy/messenger_colour.8f4836ec.svg","images/embed-legacy/twitter_colour.svg":"https://open.scdn.co/cdn/images/embed-legacy/twitter_colour.456d46db.svg","images/embed-legacy/whatsapp.svg":"https://open.scdn.co/cdn/images/embed-legacy/whatsapp.e33bfab4.svg","images/employee-podcasts-modal-art.png":"https://open.scdn.co/cdn/images/employee-podcasts-modal-art.32ebcdf8.png","images/equaliser-animated-green.gif":"https://open.scdn.co/cdn/images/equaliser-animated-green.f93a2ef4.gif","images/equaliser-green.svg":"https://open.scdn.co/cdn/images/equaliser-green.1184ed87.svg","images/favicon.ico":"https://open.scdn.co/cdn/images/favicon.5cb2bd30.ico","images/favicon.png":"https://open.scdn.co/cdn/images/favicon.0c211e2e.png","images/favicon16.png":"https://open.scdn.co/cdn/images/favicon16.c498a969.png","images/favicon32.png":"https://open.scdn.co/cdn/images/favicon32.8e66b099.png","images/focused_stroy_play.png":"https://open.scdn.co/cdn/images/focused_stroy_play.57a12bc7.png","images/hifi-button-off.svg":"https://open.scdn.co/cdn/images/hifi-button-off.87461500.svg","images/hifi-button-on.svg":"https://open.scdn.co/cdn/images/hifi-button-on.48a2de90.svg","images/hifi.svg":"https://open.scdn.co/cdn/images/hifi.0526a5b1.svg","images/home-icon.svg":"https://open.scdn.co/cdn/images/home-icon.ba66757a.svg","images/icons/Spotify_1024.png":"https://open.scdn.co/cdn/images/icons/Spotify_1024.4027f848.png","images/icons/Spotify_128.png":"https://open.scdn.co/cdn/images/icons/Spotify_128.c9ce2f2e.png","images/icons/Spotify_16.png":"https://open.scdn.co/cdn/images/icons/Spotify_16.aa3775a0.png","images/icons/Spotify_256.png":"https://open.scdn.co/cdn/images/icons/Spotify_256.c8416b60.png","images/icons/Spotify_32.png":"https://open.scdn.co/cdn/images/icons/Spotify_32.01f2b5c3.png","images/icons/Spotify_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_512.49a0bf03.png","images/icons/Spotify_64.png":"https://open.scdn.co/cdn/images/icons/Spotify_64.375a69e1.png","images/icons/Spotify_MWP_192.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_192.34e85b0e.png","images/icons/Spotify_MWP_512.png":"https://open.scdn.co/cdn/images/icons/Spotify_MWP_512.23e0876e.png","images/improved-modal-bg.jpg":"https://open.scdn.co/cdn/images/improved-modal-bg.ac225d3f.jpg","images/login-background.jpg":"https://open.scdn.co/cdn/images/login-background.078204fe.jpg","images/login-signup-burst.svg":"https://open.scdn.co/cdn/images/login-signup-burst.5f6a6521.svg","images/logo-complete-black.svg":"https://open.scdn.co/cdn/images/logo-complete-black.573d8227.svg","images/logo-white-2x.png":"https://open.scdn.co/cdn/images/logo-white-2x.4a6a33bc.png","images/mid-year.png":"https://open.scdn.co/cdn/images/mid-year.9e2ead8f.png","images/mwp-episodelist-placeholder.png":"https://open.scdn.co/cdn/images/mwp-episodelist-placeholder.8ca89306.png","images/mwp-tracklist-placeholder.png":"https://open.scdn.co/cdn/images/mwp-tracklist-placeholder.f287f2ba.png","images/og-image.png":"https://open.scdn.co/cdn/images/og-image.860da0d8.png","images/playlist-folder-filled.svg":"https://open.scdn.co/cdn/images/playlist-folder-filled.f7932744.svg","images/ribbon-graphic-mobile.svg":"https://open.scdn.co/cdn/images/ribbon-graphic-mobile.74c64eee.svg","images/ribbon-graphic-small-side.svg":"https://open.scdn.co/cdn/images/ribbon-graphic-small-side.3d3845b8.svg","images/ribbon-graphic-small-top.svg":"https://open.scdn.co/cdn/images/ribbon-graphic-small-top.a2dcfbcf.svg","images/ribbon-graphic.svg":"https://open.scdn.co/cdn/images/ribbon-graphic.028f27ab.svg","images/s2l-desktopui-ltr.png":"https://open.scdn.co/cdn/images/s2l-desktopui-ltr.a0bb24a2.png","images/s2l-desktopui-rtl.png":"https://open.scdn.co/cdn/images/s2l-desktopui-rtl.862015c3.png","images/s2l-mobileui.png":"https://open.scdn.co/cdn/images/s2l-mobileui.3ad8f52b.png","images/spotifylogo.svg":"https://open.scdn.co/cdn/images/spotifylogo.a884cca3.svg","images/station-header-wave.svg":"https://open.scdn.co/cdn/images/station-header-wave.0f3784ea.svg","images/station-wave.svg":"https://open.scdn.co/cdn/images/station-wave.2b7b882c.svg","images/sw_saber_ahsoka1.png":"https://open.scdn.co/cdn/images/sw_saber_ahsoka1.9574535d.png","images/sw_saber_anakin.png":"https://open.scdn.co/cdn/images/sw_saber_anakin.6176307b.png","images/sw_saber_leia.png":"https://open.scdn.co/cdn/images/sw_saber_leia.7195cf21.png","images/sw_saber_luke.png":"https://open.scdn.co/cdn/images/sw_saber_luke.e96ed874.png","images/sw_saber_mace.png":"https://open.scdn.co/cdn/images/sw_saber_mace.43812892.png","images/sw_saber_rey.png":"https://open.scdn.co/cdn/images/sw_saber_rey.e06a68a5.png","images/sw_saber_vader.png":"https://open.scdn.co/cdn/images/sw_saber_vader.fbcf32dc.png","images/touch-icon-114.png":"https://open.scdn.co/cdn/images/touch-icon-114.2fdb1eb2.png","images/touch-icon-144.png":"https://open.scdn.co/cdn/images/touch-icon-144.dbd8dd2a.png","images/touch-icon-57.png":"https://open.scdn.co/cdn/images/touch-icon-57.2d68aabb.png","images/touch-icon-72.png":"https://open.scdn.co/cdn/images/touch-icon-72.cffecbdb.png","images/tracklist-placeholder.png":"https://open.scdn.co/cdn/images/tracklist-placeholder.b3518b89.png","images/zara-larsson-singles.png":"https://open.scdn.co/cdn/images/zara-larsson-singles.2c824329.png","js/fb.js":"https://open.scdn.co/cdn/js/fb.83cf1e53.js","js/gtm.js":"https://open.scdn.co/cdn/js/gtm.7dc32ad7.js","js/retargeting-pixels.js":"https://open.scdn.co/cdn/js/retargeting-pixels.1fa1ceda.js","js/urlRedirect.js":"https://open.scdn.co/cdn/js/urlRedirect.156df566.js","js/urlScheme.js":"https://open.scdn.co/cdn/js/urlScheme.f1e6e8b6.js"}'))throw new Error("No __CDN_FILE_URLS__ global variable available.");try{n=JSON.parse(t)}catch(r){throw new Error("Invalid __CDN_FILE_URLS__ global variable.")}if(!n[e])throw new Error("`".concat(e,"` is not available in __CDN_FILE_URLS__."));return n[e]}function Xs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Zs=function(e){switch(e){case"facebook":return"url('".concat($s("images/embed-legacy/fb_colour.svg"),"')");case"messenger":return"url('".concat($s("images/embed-legacy/messenger_colour.svg"),"')");case"twitter":return"url('".concat($s("images/embed-legacy/twitter_colour.svg"),"')");case"whatsapp":return"url('".concat($s("images/embed-legacy/whatsapp.svg"),"')");case"link":return"url('".concat($s("images/embed-legacy/copy-32_circle_grey_outline_bg.svg"),"')");case"embed":return"url('".concat($s("images/embed-legacy/embed-code-32_circle_grey_outline_bg.svg"),"')");default:return"transparent"}},Js=(0,d.zo)("div",{position:"relative",height:"100%",textAlign:"center"}),ec=(0,d.zo)("div",{fontSize:"14px",fontWeight:L,lineHeight:"16px",marginTop:"2px"}),tc=(0,d.zo)("div",{display:"inline-flex",width:"100%",maxWidth:"220px",justifyContent:"space-around",whiteSpace:"nowrap",margin:"12px auto 0 auto"}),nc=(0,d.zo)("button",(function(e){var t=e.$icon;return{backgroundImage:Zs(t),backgroundColor:"transparent",backgroundRepeat:"no-repeat",width:"25px",height:"25px",border:"0",cursor:"pointer",outline:"none",display:"inline-block"}})),rc=function(e){m()(n,e);var t=Xs(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"handleShareOnFacebook",(function(){Hs(e.props.url)})),i()(y()(e),"handleShareOnMessenger",(function(){Gs(e.props.url)})),i()(y()(e),"handleShareOnTwitter",(function(){qs(e.props.url)})),i()(y()(e),"handleShareOnWhatsApp",(function(){Ws(e.props.url)})),i()(y()(e),"handleCopyURL",(function(){zs(e.props.url),e.props.copyURL(e.props.url)})),i()(y()(e),"handleCopyEmbedCode",(function(){Qs(e.props.uri),e.props.copyEmbedCode(e.props.uri)})),e}return h()(n,[{key:"render",value:function(){var e=this.props.onClose;return o().createElement(Ks,{onClose:e},o().createElement(Js,null,o().createElement(ec,null,To.get("embed_share")),o().createElement(tc,null,o().createElement(nc,{title:To.get("embed_share_facebook"),$icon:"facebook",onClick:this.handleShareOnFacebook}),o().createElement(nc,{title:To.get("embed_share_messenger"),$icon:"messenger",onClick:this.handleShareOnMessenger}),o().createElement(nc,{title:To.get("embed_share_twitter"),$icon:"twitter",onClick:this.handleShareOnTwitter}),o().createElement(nc,{title:To.get("embed_share_whatsapp"),$icon:"whatsapp",onClick:this.handleShareOnWhatsApp}),o().createElement(nc,{title:To.get("embed_share_link"),$icon:"link",onClick:this.handleCopyURL}),o().createElement(nc,{title:To.get("embed_share_embed"),$icon:"embed",onClick:this.handleCopyEmbedCode}))))}}]),n}(o().PureComponent);function ic(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}i()(rc,"defaultProps",{isVisible:!1});var ac=(0,d.zo)("div",{position:"relative",display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}),oc=(0,d.zo)("div",{fontSize:"14px",fontWeight:L,lineHeight:"16px",margin:"auto",textAlign:"center"}),sc=function(e){m()(n,e);var t=ic(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props.onClose;return o().createElement(Ks,{onClose:e},o().createElement(ac,null,o().createElement(oc,null,To.get("embed_success_share_link"))))}}]),n}(o().PureComponent);function cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uc="SHARE",dc="COPY_CONFIRMATION",pc={visible:!1,view:void 0};const _c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Us.SHOW_SHARE:return lc(lc({},e),{},{visible:!0,view:uc});case Us.COPY_URL:case Us.COPY_EMBED_CODE:return lc(lc({},e),{},{visible:!0,view:dc});case Us.HIDE_SHARE:return lc({},pc);default:return e}};function fc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var hc=function(e){m()(n,e);var t=fc(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){return this.props.viewType===dc?o().createElement(sc,this.props):o().createElement(rc,this.props)}}]),n}(o().PureComponent);const vc=(0,l.$j)((function(e){var t=G(e).uri;return{uri:t,url:j(t),viewType:Fs(e)}}),(function(e){return{copyURL:function(t){return e({type:Ms.COPY_URL})},copyEmbedCode:function(t){return e({type:Ms.COPY_EMBED_CODE})},onClose:function(){return e({type:Ms.HIDE_SHARE})}}}))(hc);var yc=function(e){return e.modal.visible},gc=function(e){return yc(e)&&!X(e)},mc=function(e){return yc(e)&&X(e)},Ec=function(e){return e.modal.type},bc=function(e){var t=e.session;return!(!t.accessToken||t.isAnonymous)},Sc="MOBILE",Rc="DESKTOP",kc=function(e){return e.platform.isMobile?Sc:Rc};function Pc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Tc=(0,d.zo)("button",(function(e){var t=e.$small,n=e.$primary;return{display:"inline-block",boxSizing:"border-box",border:0,cursor:"pointer",outline:"none",textAlign:"center",background:t||!n?"transparent":k.ekl,padding:t||!n?0:"12px 40px",borderRadius:t||!n?"":"20px",color:t&&n?k.ekl:k.ixZ}})),Ac=(0,d.zo)("span",(function(e){var t=e.$small;return{position:"relative",lineHeight:"16px",fontWeight:L,textTransform:"uppercase",whiteSpace:"nowrap",fontSize:t?"10px":"12px",letterSpacing:t?"2px":"1.7px",marginRight:t?"-2px":"-3px",fontFamily:I}})),Cc=function(e){m()(n,e);var t=Pc(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.small,n=e.primary,r=e.onClick,i=e.children;return o().createElement(Tc,{$small:t,$primary:n,onClick:r},o().createElement(Ac,{$small:t},i))}}]),n}(o().PureComponent);function wc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Ic=(0,d.zo)("div",(function(e){var t=e.$small;return{display:"flex",height:"100%",width:t?"100%":"75%",margin:"0 auto",justifyContent:t?"space-around":"center",flexDirection:"column",boxSizing:"border-box"}})),Lc=(0,d.zo)("div",(function(e){var t=e.$small;return{fontWeight:L,textAlign:"center",fontSize:t?"14px":"20px",lineHeight:t?"16px":"24px"}})),Oc=(0,d.zo)("ul",(function(e){return{margin:e.$small?0:"10px 0 0",textAlign:"center",listStyleType:"none",padding:0}})),Dc=(0,d.zo)("li",(function(e){var t=e.$small;return{display:t?"inline-block":"",margin:t?"0 10px":"16px 0 0"}})),Nc=function(e){m()(n,e);var t=wc(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.header,n=e.buttons,r=e.onClose,i=e.small,a=void 0!==i&&i;return o().createElement(Ks,{onClose:r,small:a},o().createElement(Ic,{$small:a},o().createElement(Lc,{$small:a},t),o().createElement(Oc,{$small:a},n.map((function(e,t){var n=e.label,r=e.onClick,i=e.primary;return o().createElement(Dc,{key:"modal-button-".concat(t),$small:a},o().createElement(Cc,{onClick:r,primary:i,small:a},n))})))))}}]),n}(o().PureComponent);function Mc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Uc=(0,d.zo)("span",{whiteSpace:"nowrap"}),xc=function(e){m()(n,e);var t=Mc(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e={line_break:"<br />",begin_highlight:'<span style="color: '.concat(k.ekl,'">'),end_highlight:"</span>"},t="";switch(this.props.resourceType){case"track":t=To.get("embed_listen_to_full_track",e);break;case"album":t=To.get("embed_listen_to_full_album",e);break;case"playlist":t=To.get("embed_listen_to_full_playlist",e);break;case"artist":t=To.get("embed_listen_to_full_artist",e);break;case"show":t=To.get("embed_listen_to_full_show",e);break;case"episode":t=To.get("embed_listen_to_full_episode",e)}return o().createElement(Uc,{dangerouslySetInnerHTML:{__html:t}})}}]),n}(o().PureComponent),Fc=function(e){return e.modalType===$a?e.isEpisodeAvailableInCountry?To.get("embed_episode_preview_not_available"):To.get("embed_track_not_available"):e.preferredPlatform===Sc?To.get("upsell_track_message"):o().createElement(xc,{resourceType:e.resourceType})},jc=function(e,t,n){return{label:e,onClick:t,primary:n}},Bc=function(e){var t=e.stateProps,n=e.dispatchProps;return t.preferredPlatform===Sc?[jc(To.get("get_spotify"),n.getInSpotifyApp,!0),jc(To.get("play_on_spotify"),n.playInSpotifyApp)]:[jc(To.get("play_on_spotify"),n.playInSpotifyApp,!0),!t.isLoggedIn&&jc(To.get("embed_login"),n.clickLogin)].filter(Boolean)},Yc={hideModal:function(){return{type:Ja.HIDE_MODAL}},clickLogin:function(){return function(e,t){var n,r=(n=G(t()).uri,"https://accounts.spotify.com/login?utm_source=".concat(O,"&utm_medium=&utm_campaign=&continue=").concat(encodeURIComponent(j(n))));window.open(r,"_blank"),e({type:Ja.CLICK_LOGIN})}},clickSignup:function(){return function(e,t){var n,r=(n=G(t()).uri,"https://www.spotify.com/signup/?creation_flow=embed&utm_source=".concat(O,"&utm_medium=&utm_campaign=&forward_url=").concat(encodeURIComponent(j(n))));window.open(r,"_blank"),e({type:Ja.CLICK_SIGNUP})}},getInSpotifyApp:function(){return function(e,t){var n=t(),r=n.platform.isMobile?"_top":"_blank";window.open(Y(n).toString(),r),e({type:io.GET_IN_APP})}},playInSpotifyApp:function(){return function(e,t){var n=t();e(ho());var r=n.platform.isMobile?"_top":"_blank";window.open(B(n).toString(),r),e({type:io.PLAY_IN_APP})}}};const Vc=(0,l.$j)((function(e){return{modalType:Ec(e),preferredPlatform:kc(e),isLoggedIn:bc(e),isEpisodeAvailableInCountry:qa(e),resourceType:q(e)}}),Yc,(function(e,t,n){return{small:"top"===n.area,onClose:t.hideModal,header:Fc(e),buttons:Bc({stateProps:e,dispatchProps:t})}}))(Nc);var Kc,Hc=(0,d.zo)("div",(Kc={},i()(Kc,T,{height:"18px",width:"18px"}),i()(Kc,A,{height:"25px",width:"25px"}),Kc)),Gc={filter:"drop-shadow(0 0 2px rgba(0, 0, 0, 0.2))"};const qc=function(){return o().createElement(Hc,null,o().createElement("svg",{viewBox:"0 0 64 64",style:Gc},o().createElement("title",null,To.get("play_on_spotify")),o().createElement("path",{fill:k.ixZ,d:"M50.9288482,28.3686995 C40.6139223,22.2429099 23.5996824,21.6796628 13.7528525,24.668235 C12.1712611,25.1477974 10.4991074,24.2551616 10.020312,22.674325 C9.54075242,21.0919599 10.4326187,19.4209426 12.0153564,18.9402338 C23.3188247,15.5091649 42.1091547,16.1717636 53.9838913,23.2207587 C55.4065211,24.0648651 55.8727065,25.9021053 55.0297516,27.3220687 C54.1860323,28.7439428 52.3476568,29.213188 50.9288482,28.3686995 M50.5910548,37.4417921 C49.8677032,38.6160515 48.3323482,38.9840345 47.1592422,38.2633534 C38.5600315,32.9774668 25.4464645,31.4459238 15.2725406,34.5342297 C13.953465,34.9331646 12.5598763,34.1887919 12.1594154,32.8720012 C11.7616293,31.5529179 12.5056154,30.1616135 13.8227803,29.7607681 C25.4453181,26.2337867 39.8932454,27.9418698 49.7702628,34.0118696 C50.9429866,34.7340793 51.3121138,36.2702077 50.5910548,37.4417921 M46.6754793,46.1553085 C46.1003899,47.0983843 44.8726409,47.3937643 43.9330097,46.8190535 C36.4186355,42.2263353 26.9604208,41.1892576 15.8216459,43.7334225 C14.748273,43.9798909 13.6787213,43.3069749 13.4337829,42.2335956 C13.1876981,41.1605985 13.8579352,40.0906583 14.9336008,39.8457184 C27.1232036,37.0589064 37.5791315,38.2583858 46.0140309,43.4124404 C46.9544263,43.986769 47.2505687,45.2152896 46.6754793,46.1553085 M31.9998089,0 C14.3271776,0 0,14.3268811 0,31.9996179 C0,49.6742653 14.3271776,64 31.9998089,64 C49.6732045,64 64,49.6742653 64,31.9996179 C64,14.3268811 49.6732045,0 31.9998089,0"})))};const Wc=(0,d.zo)((function(){return o().createElement("svg",{viewBox:"0 0 16 16",style:{filter:w}},o().createElement("path",{fill:"white",d:"M11.6,9.81c-0.831,0-1.561,0.409-2.016,1.033L4.906,8.142C4.961,7.936,5,7.723,5,7.499c0-0.232-0.042-0.452-0.101-0.665 l4.67-2.696c0.454,0.635,1.192,1.052,2.031,1.052c1.381,0,2.5-1.119,2.5-2.5c0-1.38-1.119-2.5-2.5-2.5c-1.381,0-2.5,1.12-2.5,2.5 c0,0.182,0.022,0.359,0.059,0.53L4.442,5.943C3.984,5.372,3.289,4.999,2.5,4.999c-1.381,0-2.5,1.12-2.5,2.5C0,8.88,1.119,10,2.5,10 c0.798,0,1.5-0.38,1.957-0.962l4.706,2.717l0.007-0.012C9.128,11.926,9.1,12.114,9.1,12.31c0,1.381,1.119,2.5,2.5,2.5 c1.381,0,2.5-1.119,2.5-2.5C14.1,10.929,12.981,9.81,11.6,9.81z M11.6,1.189c0.827,0,1.5,0.673,1.5,1.5c0,0.827-0.673,1.5-1.5,1.5 c-0.827,0-1.5-0.673-1.5-1.5C10.1,1.862,10.773,1.189,11.6,1.189z M2.5,9C1.673,9,1,8.327,1,7.499c0-0.827,0.673-1.5,1.5-1.5 S4,6.672,4,7.499C4,8.327,3.327,9,2.5,9z M11.6,13.81c-0.827,0-1.5-0.673-1.5-1.5c0-0.827,0.673-1.5,1.5-1.5 c0.827,0,1.5,0.673,1.5,1.5C13.1,13.137,12.427,13.81,11.6,13.81z"}))}),{width:"100%",height:"100%"});function zc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Qc=function(e){m()(n,e);var t=zc(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.onShare,n=e.$styleProps;return o().createElement(vs,{onClick:t,title:To.get("embed_share"),$styleProps:n},o().createElement(Wc,null))}}]),n}(o().Component),$c={CLICK_METADATA:"CLICK_METADATA"};function Xc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Zc=(0,d.zo)("div",{display:"flex",justifyContent:"space-between",flexDirection:"column",alignItems:"center"}),Jc={width:"16px",height:"16px",padding:"10px",boxSizing:"content-box"},el=(0,d.zo)("div",{display:"flex"}),tl=function(e){m()(n,e);var t=Xc(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.showShareModal,n=e.showModal,r=e.onShare,i=e.onClickLogo,a=this.props.isLegacy?Ns:Vo;return o().createElement(el,null,t&&!n&&o().createElement(vc,null),n&&o().createElement(Vc,{area:"top"}),o().createElement(a,null),o().createElement(Zc,null,o().createElement(vs,{onClick:i,$styleProps:Jc},o().createElement(qc,null)),o().createElement(Qc,{onShare:r,size:32,$styleProps:Jc})))}}]),n}(o().Component);const nl=(0,l.$j)((function(e){return{isLegacy:$(e),showShareModal:xs(e),showModal:gc(e)}}),(function(e){return{onShare:function(){return e({type:Ms.SHOW_SHARE})},onClickLogo:function(){return e((function(e,t){var n=t(),r=n.platform.isMobile?"_top":"_blank";window.open(B(n).toString(),r),e({type:$c.CLICK_METADATA})}))}}}))(tl);var rl;function il(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var al=(0,d.zo)("div",{display:"flex",flexDirection:"row",position:"relative",textShadow:"0 0 2px rgba(0, 0, 0, 0.4)"}),ol=(0,d.zo)("div",(rl={position:"relative"},i()(rl,T,{height:"80px",width:"80px"}),i()(rl,A,{flex:1,maxHeight:"33.3333vh",maxWidth:"33.3333vh",minHeight:"161px",minWidth:"161px"}),rl)),sl=(0,d.zo)("div",{position:"relative",flex:2,minWidth:"66.6666vw"}),cl=function(e){m()(n,e);var t=il(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props.hasBigCoverArt;return o().createElement(al,null,o().createElement(ol,null,o().createElement(Yo,{noCoverArt:e})),o().createElement(sl,null,o().createElement(nl,null)))}}]),n}(o().Component);const ll=(0,l.$j)((function(e){return{hasBigCoverArt:J(e)}}))(cl);var ul=function(e){var t,n=e.volume;return t=0===n?o().createElement("path",{d:"M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072L7,3.732z M15.623,5.853l-0.707-0.707l-2.147,2.147 l-2.146-2.147L9.916,5.853L12.062,8l-2.146,2.146l0.707,0.707l2.146-2.147l2.147,2.147l0.707-0.707L13.477,8L15.623,5.853z"}):n<1/3?o().createElement("path",{d:"M10.699,5.18l-0.657,0.77C10.548,6.486,10.863,7.205,10.863,8s-0.316,1.514-0.822,2.051l0.657,0.769 c0.72-0.723,1.165-1.72,1.165-2.82S11.418,5.903,10.699,5.18z M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072 L7,3.732z"}):n<2/3?o().createElement("path",{d:"M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072L7,3.732z M11.863,8c0,1.403-0.585,2.668-1.519,3.577 l0.653,0.764C12.145,11.248,12.863,9.71,12.863,8c0-1.709-0.718-3.248-1.866-4.341l-0.653,0.764 C11.279,5.332,11.863,6.597,11.863,8z"}):o().createElement("path",{d:"M12.945,1.379l-0.652,0.763c1.577,1.462,2.57,3.544,2.57,5.858s-0.994,4.396-2.57,5.858l0.651,0.763 c1.79-1.645,2.919-3.998,2.919-6.621S14.735,3.024,12.945,1.379z M10.673,4.039l-0.651,0.763C10.849,5.617,11.363,6.749,11.363,8 s-0.515,2.382-1.342,3.199l0.651,0.763c1.04-1,1.691-2.404,1.691-3.961S11.713,5.039,10.673,4.039z M0,5v6h2.804L8,14V2L2.804,5H0z M7,3.732v8.536L3.072,10H1V6h2.072L7,3.732z"}),o().createElement("svg",{viewBox:"0 0 16 16"},o().createElement("title",null,"Volume"),t)};ul.defaultProps={volume:1};const dl=(0,d.zo)(ul,{width:"100%",height:"100%"});function pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var _l="19px",fl="".concat(38,"px"),hl="14px",vl=(0,d.zo)("tr",(function(e){var t=e.$isCurrentTrack,n=e.$isPlayable;return i()({color:t?k.By7:k.ixZ,lineHeight:_l,cursor:"pointer",verticalAlign:"top",userSelect:"none",opacity:n?1:C},":hover",{backgroundColor:n?"rgba(255, 255, 255, 0.2)":"none"})})),yl=(0,d.zo)("td",(function(e){var t=e.$isCurrentTrack;return{color:k.ixZ,padding:"6px 8px 6px 16px",fontFeatureSettings:'"tnum"',width:"1%",minWidth:hl,opacity:t?1:C}})),gl=(0,d.zo)("td",(function(e){var t=e.$isCurrentTrack;return{color:t?k.By7:k.ixZ,textAlign:"right",padding:"6px 16px 6px 8px",fontFeatureSettings:'"tnum"',fontWeight:t?L:"unset",opacity:t?1:C,width:"1%"}})),ml=(0,d.zo)("td",{position:"relative",padding:"6px 0"}),El=(0,d.zo)("div",(function(e){return{position:"relative",height:e.$hasSubtitle?fl:_l,width:"100%"}})),bl=(0,d.zo)("div",(function(e){var t=e.$isCurrentTrack;return{position:"absolute",top:0,height:_l,width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:t?L:"unset"}})),Sl=(0,d.zo)("div",{position:"absolute",top:_l,height:_l,width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:k.ixZ,opacity:C}),Rl=(0,d.zo)("div",{position:"absolute",width:hl,height:hl,paddingTop:"2px",fill:k.By7}),kl=function(e){m()(n,e);var t=pl(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"handleRowClick",(function(){var t=e.props;(0,t.onTrackClick)(t.index)})),e}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.number,n=e.title,r=e.subtitle,i=e.duration,a=e.isCurrentTrack,s=e.isPlayable;return o().createElement(vl,{$isCurrentTrack:a,$isPlayable:s,onClick:this.handleRowClick},o().createElement(yl,{$isCurrentTrack:a},a?o().createElement(Rl,null,o().createElement(dl,null)):t),o().createElement(ml,null,o().createElement(El,{$hasSubtitle:!!r},o().createElement(bl,{$isCurrentTrack:a},o().createElement("span",{dir:"auto"},n)),r&&o().createElement(Sl,null,o().createElement("span",{dir:"auto"},r)))),o().createElement(gl,{$isCurrentTrack:a},Jo(i)))}}]),n}(o().Component);function Pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}i()(kl,"defaultProps",{onTrackClick:function(){},isCurrentTrack:!1});var Tl=(0,d.zo)("table",{position:"relative",borderCollapse:"collapse",width:"100%"}),Al=function(e){m()(n,e);var t=Pl(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=e.tracks,r=e.onTrackClick,i=e.currentTrackUri,a=e.isPlaylist;if(!n||n.length<1)return null;var s=function(e){return"episode"===e.type},c=function(e){return!(!t||!s(e))||e.is_playable},l=function(e){if(a)return s(e)?e.show.name:e.artists.map((function(e){return e.name})).join(To.getSeparator())};return o().createElement(Tl,null,o().createElement("tbody",null,n.map((function(e,t){return o().createElement(kl,{index:t,number:t+1,title:e.name,subtitle:l(e),duration:e.duration_ms,onTrackClick:r,isCurrentTrack:i===e.uri,isPlayable:c(e),key:"".concat(t,"-").concat(e.uri)})}))))}}]),n}(o().PureComponent);const Cl=(0,l.$j)((function(e){return{tracks:W(e),currentTrackUri:e.playback.trackUri,isPlaylist:"playlist"===q(e),isLoggedIn:bc(e)}}),(function(e){return{onTrackClick:function(t){return e(vo(t))}}}))(Al);function wl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Il=(0,d.zo)("div",{position:"relative",backgroundColor:"rgba(0, 0, 0, 0.4)",flex:1,overflowY:"hidden"}),Ll=(0,d.zo)("div",(function(e){return{overflowY:e.$scrolling?"auto":"hidden",height:"100%"}})),Ol=(0,d.zo)("div",{position:"relative",width:"100%",height:"100%",boxSizing:"border-box",padding:"8px"}),Dl=function(){return o().createElement(Ol,null,o().createElement(Yo,{noButton:!0,top:!0}))},Nl=function(e){m()(n,e);var t=wl(n);function n(){return _()(this,n),t.apply(this,arguments)}return h()(n,[{key:"render",value:function(){var e=this.props,t=e.showModal,n=e.hasBottomSection,r=e.hasBigCoverArt;if(!n)return o().createElement(Il,null);var i=r?o().createElement(Dl,null):o().createElement(Cl,null),a=!r&&!t;return o().createElement(Il,null,o().createElement(Ll,{$scrolling:a},i),t&&o().createElement(Vc,{area:"bottom"}))}}]),n}(o().PureComponent);const Ml=(0,l.$j)((function(e){return{hasBigCoverArt:J(e),hasBottomSection:X(e),showModal:mc(e)}}))(Nl);function Ul(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var xl=(0,d.zo)("div",(function(e){var t=e.$backgroundColor;return{color:k.ixZ,backgroundColor:t,fontFamily:I,position:"relative",display:"flex",flexDirection:"column",height:"100vh",fontWeight:"200",fontSize:"14px",lineHeight:"19px"}})),Fl=(0,d.zo)("div",{position:"absolute",top:0,right:0,bottom:0,left:0,background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.8))",display:"flex",flexDirection:"column"}),jl=function(e){m()(n,e);var t=Ul(n);function n(){var e;_()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),i()(y()(e),"onMouseEnter",(function(){document.removeEventListener("mouseenter",e.onMouseEnter),e.props.player.initialize()})),e}return h()(n,[{key:"componentDidMount",value:function(){this.props.onMount(),document.addEventListener("mouseenter",this.onMouseEnter)}},{key:"render",value:function(){var e=this.props.resource;return o().createElement(xl,{$backgroundColor:e.dominantColor},o().createElement(Fl,null,o().createElement(ll,null),o().createElement(Ml,null)))}}]),n}(o().Component),Bl="MOUNTED",Yl={onMount:function(){return{type:Bl}}};const Vl=(0,l.$j)((function(e){return{resource:G(e),player:Ga(e)}}),Yl)(jl);var Kl=n(3828),Hl=n(3894),Gl={};const ql=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gl,t=arguments.length>1?arguments[1]:void 0;return t.type,e};function Wl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wl(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ql={isPlaying:!1,isPaused:!1};const $l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ql,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ao.PLAY:return zl(zl({},e),{},{isPlaying:!0,isPaused:!1});case ao.PAUSE:return zl(zl({},e),{},{isPlaying:!1,isPaused:!0});case ao.TRACK_CHANGE:return zl(zl({},e),{},{trackUri:t.uri});case ao.RESET:return Ql;default:return e}};const Xl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case ao.PROGRESS_UPDATE:return t.progress||0;case ao.TRACK_CHANGE:return 0;default:return e}};const Zl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e};var Jl=ja("enableLogin")?{accessToken:ja("accessToken"),accessTokenExpirationTimestampMs:ja("accessTokenExpirationTimestampMs"),loggedIn:!ja("isAnonymous"),premiumOnlyMarket:ja("premiumOnlyMarket")}:{};const eu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jl;return e};var tu={RESIZE_VIEWPORT:"RESIZE_VIEWPORT"};const nu=tu;function ru(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function iu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ru(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ru(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var au={width:window.innerWidth,height:window.innerHeight};const ou=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:au,t=arguments.length>1?arguments[1]:void 0;return t.type===nu.RESIZE_VIEWPORT?iu(iu({},e),{},{width:t.width,height:t.height}):e};var su={SET_PLAYBACK_TO_PREVIEW:"SET_PLAYBACK_TO_PREVIEW"};const cu=su;function lu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lu(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var du={isMobile:ja("isMobile"),isSafari:navigator.vendor.toLowerCase().indexOf("apple")>=0,hasSpotifyMobile:ja("isSpotified"),forcePreview:!1};const pu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:du,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.type===cu.SET_PLAYBACK_TO_PREVIEW?uu(uu({},e),{},{forcePreview:!0}):e};var _u=n(8591),fu=n(9828),hu=n(7088),vu=n(6362),yu=null;function gu(){if(null===yu)throw new Error("Missing `instance`. Have you called `setEventSenderInstance` yet?");return yu}var mu=n(8495),Eu=n(6182),bu=function(){return"undefined"==typeof window||void 0===window.gtag||void 0===window.google_tag_manager},Su=function(e,t,n){return function(e,t,n){bu()||window.gtag("event",t,{event_category:e,event_label:n})}(e,t,n)},Ru=[ao.PROGRESS_UPDATE];const ku=function(e){return function(t){return function(n){var r=e.getState().resource;if(!r)return t(n);var i=!e.getState().session.loggedIn,a=r.toString(),o=a.split(":"),s=se()(o,2)[1];return n.type===Bl?function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];gu().send(t?(0,hu.t)(e):(0,_u.v)(e))}({page:s,type:"enter",view_uri:a,referrer:document.referrer},i):-1===Ru.indexOf(n.type)&&(Su("action",n.type),function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];gu().send(t?(0,vu.w)(e):(0,fu.p)(e))}({page:s,action_type:String(n.type).toLowerCase(),view_uri:a},i)),t(n)}}};var Pu,Tu=n(6525),Au=n.n(Tu),Cu=(n(189),n(6848)),wu=n(8926),Iu=n.n(wu),Lu=n(7757),Ou=n.n(Lu);n(6755);function Du(e){return Nu.apply(this,arguments)}function Nu(){return(Nu=Iu()(Ou().mark((function e(t){return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Pu){e.next=2;break}throw new Error("Invalid call to sendMetric before initSemanticMetrics.");case 2:return e.abrupt("return",Pu(t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var Uu,xu=function(e){m()(n,e);var t=Mu(n);function n(e){var r;_()(this,n);var i=e.message,a=e.url,o=e.method,s=e.status,c=e.response;return(r=t.call(this,i)).name="HttpResponseError",r.requestUrl=a,r.requestMethod=o,r.status=s,r.response=c,r}return h()(n,null,[{key:"fromResponse",value:function(e,t){return new n({message:e.statusText,url:e.url,method:t,status:e.status,response:e})}}]),n}(ve()(Error)),Fu=function(e){m()(n,e);var t=Mu(n);function n(e){var r;_()(this,n);var i=e.timeout,a=e.url,o=e.method;return(r=t.call(this,{message:"".concat(o.toUpperCase()," ").concat(a," timed out (").concat(i,"ms)"),url:a,method:o,status:503})).name="HttpRequestTimeoutError",r.timeout=i,r}return h()(n)}(xu);function ju(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ju(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ju(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yu=function(){function e(){_()(this,e),this._accessToken=null,this._market="",this._headers=[],this._globalRequestHeaders=[],this._shouldSendMarket=!0,this._shouldSendGlobalHeaders=!0,this._locale=null,this._shouldSendLocale=!1,this._shouldSendAuthorization=!0,this._host="",this.path="",this.responseType="json",this.queryParameters=void 0,this._method="GET",this.jsonContentType=!1,this.body=null,this._endpointIdentifier=null,this._startTimestamp=null,this._includeCredentials=!1}var t;return h()(e,[{key:"getRequestImplementation",value:function(){return Uu}},{key:"accessToken",set:function(e){this._accessToken=e}},{key:"market",get:function(){return this._market},set:function(e){this._market=e}},{key:"locale",get:function(){return this._locale},set:function(e){this._locale=e}},{key:"globalRequestHeaders",get:function(){return this._globalRequestHeaders},set:function(e){this._globalRequestHeaders=e}},{key:"startTimestamp",get:function(){return this._startTimestamp}},{key:"host",get:function(){return this._host}},{key:"method",get:function(){return this._method}},{key:"endpointIdentifier",get:function(){return this._endpointIdentifier}},{key:"withHost",value:function(e){return this._host=e,this}},{key:"withPath",value:function(e){return this.path=e,this}},{key:"withResponseType",value:function(e){return this.responseType=e,this}},{key:"withEndpointIdentifier",value:function(e){return this._endpointIdentifier=e,this}},{key:"withQueryParameters",value:function(e){return this.queryParameters=e,this}},{key:"withBody",value:function(e){return this.body=e,this}},{key:"withMethod",value:function(e){return this._method=e,this}},{key:"withoutMarket",value:function(){return this._shouldSendMarket=!1,this}},{key:"withoutGlobalHeaders",value:function(){return this._shouldSendGlobalHeaders=!1,this}},{key:"withoutAuthorization",value:function(){return this._shouldSendAuthorization=!1,this}},{key:"withLocale",value:function(e){return this._shouldSendLocale=!0,e&&(this._locale=e),this}},{key:"withJsonContentType",value:function(){return this.jsonContentType=!0,this}},{key:"withHeaders",value:function(e){return this._headers=e,this}},{key:"withCredentials",value:function(){return this._includeCredentials=!0,this}},{key:"onBeforeSend",value:function(e){}},{key:"onAfterSend",value:function(e){}},{key:"send",value:(t=Iu()(Ou().mark((function e(){var t,n,r,i=this;return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new Uu(this.method,"".concat(this._host).concat(this.path),this._shouldSendAuthorization),this._shouldSendMarket&&this.market&&(this.queryParameters=Bu(Bu({},this.queryParameters),{},{market:this.market})),this._shouldSendLocale&&this.locale&&(this.queryParameters=Bu(Bu({},this.queryParameters),{},{locale:this.locale})),this.locale&&t.addHeader("Accept-Language",this.locale),t.withQueryParameters(this.queryParameters),t.withResponseType(this.responseType),this._shouldSendAuthorization&&this._accessToken&&t.addHeader("Authorization","Bearer ".concat(this._accessToken)),t.addHeader("Accept","application/json"),this._includeCredentials&&t.includeCredentials(),this._shouldSendGlobalHeaders&&this._globalRequestHeaders.length>0&&this._globalRequestHeaders.forEach((function(e){var n=se()(e,2),r=n[0],i=n[1];t.addHeader(r,i)})),n=0;n<this._headers.length;n++)r=this._headers[n],t.addHeader(r.key,r.value);this.jsonContentType&&t.addHeader("Content-Type","application/json;charset=UTF-8"),this.body&&t.withPostData(this.body),e.prev=13,this.onBeforeSend(t),e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(13),e.abrupt("return",Promise.reject(e.t0));case 20:return this._startTimestamp=Date.now(),e.abrupt("return",t.send().then((function(e){return i.onAfterSend(),e})).catch((function(e){throw i.onAfterSend(e),e})));case 22:case"end":return e.stop()}}),e,this,[[13,17]])}))),function(){return t.apply(this,arguments)})}],[{key:"setRequestImplementation",value:function(e){Uu=e}}]),e}(),Vu=function(){function e(t,n,r){return _()(this,e),this.method=t,this.url=n,this.postData=null,this.queryParameters=void 0,this.responseType="json",this._headers={},this._authorize=r,this._includeCredentials=!1,this}var t;return h()(e,[{key:"withQueryParameters",value:function(e){this.queryParameters=e}},{key:"withPostData",value:function(e){this.postData=e}},{key:"withResponseType",value:function(e){this.responseType=e}},{key:"addHeader",value:function(e,t){return this._headers[e]=t,this}},{key:"includeCredentials",value:function(){return this._includeCredentials=!0,this}},{key:"send",value:(t=Iu()(Ou().mark((function e(){var t,n,r,i,a;return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=wa(),n=new URLSearchParams(this.queryParameters).toString(),r="".concat(this.url).concat(n?"?".concat(n):""),i={method:this.method,responseType:this.responseType,headers:this._headers,authorize:this._authorize,rejectNotOk:!0},this._includeCredentials&&(i.credentials="include"),this.postData&&(null!==(a=this._headers["Content-Type"])&&void 0!==a&&a.startsWith("application/json;charset=UTF-8")?i.payload=JSON.stringify(this.postData):i.payload=this.postData),e.abrupt("return",t.request(r,i).then((function(e){return e})).catch((function(e){throw e})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ku=function(){function e(t){_()(this,e),this._accessToken=null,this._market="",this._locale="",this._globalRequestHeaders=[],this._RequestImplementation=t||Vu}return h()(e,[{key:"accessToken",get:function(){return this._accessToken},set:function(e){this._accessToken=e}},{key:"globalRequestHeaders",get:function(){return this._globalRequestHeaders},set:function(e){this._globalRequestHeaders=e}},{key:"market",get:function(){return this._market},set:function(e){this._market=e}},{key:"locale",get:function(){return this._locale},set:function(e){this._locale=e}},{key:"resetPendingRequests",value:function(){}},{key:"build",value:function(){Yu.setRequestImplementation(this._RequestImplementation);var e=new Yu;return e.accessToken=this._accessToken,e.market=this.market,e.locale=this.locale,e.globalRequestHeaders=this.globalRequestHeaders,e}}]),e}();function Hu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var i=R()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}function Gu(e){return"".concat(e.method,"::").concat(e.host).concat(e.path,"::").concat(JSON.stringify(e.queryParameters))}function qu(e,t,n){try{Du({metric_type:Cu.MetricTypes.COUNTER,what:"request-rate",value:1,tags:{endpoint:e,statusCode:t,isFatal:n}}).catch((function(){return{}}))}catch(r){}}var Wu=function(e){m()(n,e);var t=Hu(n);function n(e){var r;return _()(this,n),(r=t.call(this,e)).pendingRequests=new Set,r}return h()(n,[{key:"resetPendingRequests",value:function(){this.pendingRequests=new Set}},{key:"build",value:function(){var e,t=this,r=Au()(R()(n.prototype),"build",this).call(this);return r.onBeforeSend=function(){if(e=Gu(r),t.pendingRequests.has(e)){var n=new Error("DUPLICATE_REQUEST_ERROR: Already sent this request (".concat(e,")"));throw n.name="DUPLICATE_REQUEST_ERROR",n}"GET"===r.method.toUpperCase()&&t.pendingRequests.add(e)},r.onAfterSend=function(n){e=Gu(r);var i="unknown",a=!1;if(null!==r.endpointIdentifier&&(a=!0,i="".concat(r.method," ").concat(r.host||window.location.origin,"::").concat(r.endpointIdentifier)),n)throw a&&qu(i,JSON.stringify(n.status||0),JSON.stringify(0===(r.endpointIdentifier||"").indexOf("/me"))),t.pendingRequests.delete(e),xu.fromResponse(n,r.method);if(a){qu(i,"200","false");var o=Date.now()-(r.startTimestamp||0);!function(e,t,n){try{Du({metric_type:Cu.MetricTypes.TIMER,what:"request-duration",value:n,tags:{endpoint:e,statusCode:t}}).catch((function(){return{}}))}catch(r){}}(i,"200",Cu.Time.fromMillis(o).asNanos())}t.pendingRequests.delete(e)},r}}]),n}(Ku),zu=n(4098),Qu=n(4139),$u=n.n(Qu),Xu=n(8599),Zu=n.n(Xu);function Ju(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ed(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ju(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ju(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var td=$u()(zu.fetch);function nd(e){return e&&void 0!==e.retries&&e.retries>0?td:zu.fetch}function rd(e,t){return id.apply(this,arguments)}function id(){return id=Iu()(Ou().mark((function e(t,n){var r,i,a,o,s,c=arguments;return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:1e4,i=new(Zu()),a=i.signal,o=setTimeout((function(){return i.abort()}),r),s=nd(n),e.abrupt("return",s(t,ed(ed({},n),{},{signal:a})).then((function(e){return clearTimeout(o),e})).catch((function(e){var i;if("AbortError"===e.name)throw new Fu({timeout:r,url:t,method:null!==(i=null==n?void 0:n.method)&&void 0!==i?i:"get"});throw clearTimeout(o),e})));case 6:case"end":return e.stop()}}),e)}))),id.apply(this,arguments)}function ad(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function od(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ad(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ad(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sd=function(){function e(t,n){return _()(this,e),this.method=t,this.url=n,this.postData=null,this.queryParameters=void 0,this.responseType="json",this._headers={},this._includeCredentials=!1,this}var t;return h()(e,[{key:"withQueryParameters",value:function(e){this.queryParameters=e}},{key:"withResponseType",value:function(e){this.responseType=e}},{key:"withPostData",value:function(e){this.postData=e}},{key:"addHeader",value:function(e,t){return this._headers[e]=t,this}},{key:"includeCredentials",value:function(){return this._includeCredentials=!0,this}},{key:"send",value:(t=Iu()(Ou().mark((function e(){var t,n,r,i=this;return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.postData&&(t=null!==(n=this._headers["Content-Type"])&&void 0!==n&&n.startsWith("application/json;charset=UTF-8")?JSON.stringify(this.postData):this.postData),r=new URLSearchParams(this.queryParameters).toString(),e.abrupt("return",rd("".concat(this.url).concat(r?"?".concat(r):""),{method:this.method,body:t,credentials:this._includeCredentials?"include":void 0,headers:od({"User-Agent":{NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,PRODUCT_NAME:"unknown"}.SERVER_UA,"Content-Type":cd(this.responseType)},this._headers)}).then(function(){var e=Iu()(Ou().mark((function e(t){return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=2;break}throw xu.fromResponse(t,i.method||"GET");case 2:if("text"!==i.responseType){e.next=8;break}return e.next=5,t.text();case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,t.json();case 10:e.t0=e.sent;case 11:return e.t1=e.t0,e.t2=t.status,e.abrupt("return",{body:e.t1,status:e.t2});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw e})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function cd(e){return"text"===e?"text/plain":"application/json"}var ld=null,ud=function(){function e(){_()(this,e)}return h()(e,null,[{key:"setSession",value:function(e){if(e){var t=e.accessToken,n=this.getInstance();n.accessToken=t,t||n.resetPendingRequests()}}},{key:"setLocale",value:function(e){this.getInstance().locale=e}},{key:"setGlobalRequestHeaders",value:function(e){this.getInstance().globalRequestHeaders=e}},{key:"setMarket",value:function(e){this.getInstance().market=e}},{key:"resetInstance",value:function(){ld=null}},{key:"getInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ld||(ld=this.createNew(e)),ld}},{key:"createNew",value:function(e){var t=e.Constructor,n=void 0===t?Wu:t,r=e.fromServer;return new n(void 0!==r&&r?sd:Vu)}}]),e}(),dd=function(e){var t=e.getState();Ga(t).onTrackChange((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.uri,r=n;r!==e.getState().playback.trackUri&&e.dispatch(fo(r))})),Ga(t).onProgress((function(t){var n,r=t.position;e.dispatch((n=r,function(e){n>29500&&e(to()),e({type:io.PROGRESS_UPDATE,progress:n})}))})),Ga(t).onReset((function(){e.dispatch({type:io.RESET})})),Ga(t).onPause((function(){e.dispatch(uo())})),Ga(t).onPlay((function(){e.dispatch(lo())})),Ga(t).onUnavailableTrack((function(){e.dispatch(ho()),e.dispatch({type:io.UNAVAILABLE_TRACK})}))};const pd=function(e){var t=e.getState();ud.setSession(t.session),Ga(t).onInitializationFailure((function(t){t.error.code!==Ta.EME_NO_SUPPORTED_KEYSYSTEM&&t.error.code!==Ta.LIST_PLAYER_NO_TRACK_PLAYER&&t.error.code!==Ta.EME_API_NOT_SUPPORTED||(e.dispatch({type:su.SET_PLAYBACK_TO_PREVIEW}),dd(e))})),dd(e);window.addEventListener("resize",Zo((function(){var t,n;e.dispatch((t=window.innerWidth,n=window.innerHeight,{type:tu.RESIZE_VIEWPORT,width:t,height:n}))}),100))};var _d=n(6464),fd=n(1371),hd=n(7756);function vd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vd(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gd=[/open\.scdn\.co/,/xpui\.app\.spotify\.com/];const md=JSON.parse('{"Ls":"https://api.spotify.com","XA":"https://spclient.wg.spotify.com","xM":"https://accounts.spotify.com","l3":"https://api-partner.spotify.com"}');var Ed=md.Ls,bd=md.XA,Sd=md.l3;md.xM,"".concat(Ed,"/v1"),"".concat(bd,"/melody/v1"),"".concat(bd,"/radio-apollo/v3"),"".concat(bd,"/recently-played/v3"),"".concat(bd,"/collection-view/v1"),"".concat(bd,"/sponsoredplaylist/v1"),"".concat(bd,"/social-connect/v2"),"".concat(bd,"/playlist/v2"),"".concat(bd,"/inspiredby-mix/v2"),"".concat(bd,"/ads"),"".concat(Sd,"/pathfinder/v1"),"".concat(bd,"/autoplay-enabled"),"".concat(bd,"/age-verification/v1"),"".concat(bd,"/concerts"),"".concat(bd,"/presence-view"),"".concat(bd,"/presence2"),"".concat(bd,"/find-friends"),"".concat(bd,"/track-credits-view"),"".concat(bd,"/color-lyrics/v2"),"".concat(bd,"/metadata/4"),"".concat(bd,"/user-profile-view/v3"),"".concat(bd,"/consumer-wrapped/v1"),"".concat(bd,"/campaigns-service/v1"),"".concat(bd,"/consumer-only-you/v1"),"".concat(bd,"/stories-view/v1"),"".concat(bd,"/soundfinder/v1"),"".concat(bd,"/"),"".concat(bd,"/socialgraph/v2"),"".concat(bd,"/vanilla/v1/views/hub2"),"".concat(bd,"/ondemand-selector/v2"),"".concat(bd,"/playlist-permission/v1"),"".concat(bd,"/stories-view/v3"),"".concat(bd,"/blend-invitation"),"".concat(bd,"/playlistfreshener");function Rd(e,t,n){return e.build().withHost("").withPath("/get_access_token").withQueryParameters({reason:t,productType:n}).withoutMarket().withoutAuthorization().withEndpointIdentifier("/get_access_token").send()}function kd(e){return Date.now()>=e.accessTokenExpirationTimestampMs}function Pd(e,t){var n=null,r=null;return Iu()(Ou().mark((function i(){var a,o,s=arguments;return Ou().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=s.length>0&&void 0!==s[0]?s[0]:{},o=a.preferCached,!(void 0!==o&&o)||!n){i.next=3;break}return i.abrupt("return",n);case 3:if(!r){i.next=5;break}return i.abrupt("return",r);case 5:return r=e(),i.prev=6,i.next=9,r;case 9:n=i.sent,t(n);case 11:return i.prev=11,r=null,i.finish(11);case 14:return i.abrupt("return",n);case 15:case"end":return i.stop()}}),i,null,[[6,,11,14]])})))}var Td=function(){try{var e=document.getElementById("config"),t=e?JSON.parse(e.innerHTML):{};return n=t,["accessToken","accessTokenExpirationTimestampMs","isAnonymous"].every((function(e){return e in n}))?t:null}catch(r){return null}var n};var Ad,Cd=n(2378),wd=n(3107);function Id(e){var t="".concat("https://apresolve.spotify.com/","?type=").concat(Ad.DEALER,"&type=").concat(Ad.WEBGATE);return Iu()(Ou().mark((function n(){var r,i,a,o,s,c,l,u;return Ou().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=new AbortController,i=setTimeout((function(){return r.abort()}),e),n.prev=2,n.next=5,fetch(t,{signal:r.signal});case 5:return o=n.sent,clearTimeout(i),n.next=9,o.json();case 9:a=n.sent,n.next=17;break;case 12:if(n.prev=12,n.t0=n.catch(2),!r.signal.aborted){n.next=16;break}throw new Error("x-resolve request timed out after ".concat(e," ms"));case 16:throw n.t0;case 17:if(Array.isArray(a[Ad.DEALER])&&Array.isArray(a[Ad.WEBGATE])&&0!==a[Ad.DEALER].length&&0!==a[Ad.WEBGATE].length){n.next=19;break}throw new Error("x-resolve responded with incomplete results");case 19:return s=a[Ad.DEALER][0],c=a[Ad.WEBGATE][0],l="wss://".concat(s.replace(/:443$/,"")),u="https://".concat(c.replace(/:443$/,"")),n.abrupt("return",{dealer:l,webgate:u,webapi:"https://api.spotify.com/"});case 24:case"end":return n.stop()}}),n,null,[[2,12]])})))}!function(e){e.DEALER="dealer",e.WEBGATE="spclient"}(Ad||(Ad={}));function Ld(e){return Iu()(Ou().mark((function t(){var n,r,i,a;return Ou().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:if(null!==(n=t.sent)){t.next=5;break}throw new Error("Token is currently unavailable.");case 5:return r=n.accessToken,i=n.accessTokenExpirationTimestampMs,a=Math.floor(((i||0)-Date.now())/1e3),t.abrupt("return",[r,a]);case 8:case"end":return t.stop()}}),t)})))}function Od(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Od(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Od(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nd={disconnectBeforeUnload:!0,reconnectionRetries:3,requestMode:"fetch"};function Md(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ud(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Md(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Md(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xd=function(){function e(){_()(this,e),i()(this,"name","allow-offline-requests"),this.onBeforeProcessRequest=this.onBeforeProcessRequest.bind(this)}return h()(e,[{key:"onBeforeProcessRequest",value:function(e){var t,n,r=e.data;null!==(t=r.options)&&void 0!==t&&null!==(n=t.metadata)&&void 0!==n&&n.noRequestTransform||navigator.onLine||(r.options=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===e?t:Ud(Ud({},e),t)}(r.options,{allowOffline:!0,authorize:!1}))}},{key:"attach",value:function(e,t){t.on(ie.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this.onBeforeProcessRequest)}},{key:"detach",value:function(e,t){t.removeListener(ie.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this.onBeforeProcessRequest)}}]),e}();function Fd(){return new xd}var jd,Bd,Yd=n(6592),Vd=function(){function e(t){var n=this;_()(this,e),i()(this,"name","content-access"),i()(this,"cat",null),i()(this,"catPromise",null),this.transport=t,this.enabled="1"===this._getCookie("sp_has_cart"),this.api={enable:function(){return n.enable()},isEnabled:function(){return n.isEnabled()}},this.enable=this.enable.bind(this),this._handleOnAuthenticated=this._handleOnAuthenticated.bind(this),this._ensureCat=this._ensureCat.bind(this),this._processRequest=this._processRequest.bind(this),this._getCat=this._getCat.bind(this)}return h()(e,[{key:"enable",value:function(){this.enabled||(this.enabled=!0,this._ensureCat())}},{key:"isEnabled",value:function(){return this.enabled}},{key:"_handleOnAuthenticated",value:function(){this.enabled&&this._ensureCat()}},{key:"_ensureCat",value:function(){this.cat||this._getCat()}},{key:"_processRequest",value:function(t){var n=t.data,r=n.uri;this.enabled&&((!this.cat||this.cat&&this.cat.expiresAtMs-6e4<Date.now())&&this._getCat(),this.cat&&e._include(r)&&(n.options||(n.options={}),n.options.headers||(n.options.headers={}),n.options.headers["content-access-token"]=this.cat.contentAccessToken))}},{key:"_getCat",value:function(){var e=this;!this.catPromise&&this.transport.isAuthenticated()&&(this.catPromise=ud.getInstance().build().withHost("https://shelter.spotify.com").withPath("/v1/token").withoutMarket().withoutAuthorization().withEndpointIdentifier("shelter.spotify.com/v1/token").withCredentials().send().then((function(t){200===t.status&&(e.cat=t.body,e.catPromise=null)})).catch((function(){})))}},{key:"attach",value:function(e,t){t.on(ie.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this._processRequest),e.on(Yd.j.AUTHENTICATED,this._handleOnAuthenticated)}},{key:"detach",value:function(e,t){t.removeListener(ie.PluginEvent.TRANSPORT_BEFORE_PROCESS_REQUEST,this._processRequest),e.removeListener(Yd.j.AUTHENTICATED,this._handleOnAuthenticated)}},{key:"_hasCookie",value:function(e){return new RegExp("(?:^|;\\s*)".concat(decodeURIComponent(e).replace(/[-.+*]/g,"\\$&"),"\\s*\\=")).test(document.cookie)}},{key:"_getCookie",value:function(e){return e&&this._hasCookie(e)?decodeURIComponent(document.cookie.replace(new RegExp("(?:^|.*;\\s*)".concat(decodeURIComponent(e).replace(/[-.+*]/g,"\\$&"),"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*")),"$1")):null}}],[{key:"_include",value:function(e){return e.indexOf("@webgate")>-1&&!e.startsWith("@webgate/gabo")||e.indexOf("@webapi")>-1||e.startsWith("https://api.spotify.com/")||e.startsWith("https://api-partner.spotify.com/")||e.indexOf("spclient.wg.spotify.com")>-1}}]),e}();function Kd(e){return new Vd(e)}function Hd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hd(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;(0,_d.S1)(yd(yd({dsn:e,whitelistUrls:gd,sampleRate:.1},t),{},{integrations:[new hd.x],ignoreErrors:[/\/[\dA-F]{8}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{12}\/main\.js/,/^NotFoundError: Failed to execute '(removeChild|insertBefore)' on 'Node': The node.*child.*this node.$/,/ResizeObserver loop limit exceeded/,"PresentationRequest",/DA97E0680A7030159BC0C0EE3A1D098E947A08E3/]})),(0,fd.e)((function(e){var t=M("config",{}).correlationId;t&&e.setUser({id:t}),Object.keys(n).forEach((function(t){e.setExtra(t,n[t])})),""!==document.referrer&&e.setExtra("referrer",document.referrer),r&&e.setTag("container",r)}))})("https://db1eaaeafb9044828c39cd41f9805164@sentry.io/265628",{release:"embed-legacy_2022-03-25_1648228408046_c8b6c01"});var qd=function(e,t){var n=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e(Dd(Dd({providers:{endpoints:t,token:Ld(n)}},Nd),r))}(ie.createBaseTransport,function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).timeout,t=Id(void 0===e?3e3:e),n=(0,wd.Q)({});return function(){var e=Iu()(Ou().mark((function e(r){return Ou().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(r);case 3:case 11:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.next=11,n(r);case 12:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}(),e,t.transportOptions);return t.useDealer&&n.addPlugin(Cd.dv,{WebSocket}),n.addPlugin(Kd),n.addPlugin(Fd),n.on(ie.TransportEvent.CONNECTED,(function(){n.isAuthenticated()||n.authenticate()})),n.on(ie.TransportEvent.DISCONNECTED,(function(){n.connect()})),n.connect(),n}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=Td();return Pd(Iu()(Ou().mark((function t(){var r;return Ou().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n||kd(n)){t.next=2;break}return t.abrupt("return",n);case 2:return t.next=4,Rd(ud.getInstance(),"transport",e);case 4:return r=t.sent,t.abrupt("return",r.body);case 6:case"end":return t.stop()}}),t)}))),t)}("embed_legacy"),{useDealer:!ja("isAnonymous"),transportOptions:{disconnectBeforeUnload:!0}});!function(e){Ca=e}(qd),function(e){var t=function(e,t){return(0,mu.mi)({transport:e,suppressPersist:!1,context:[(0,Eu.jx)(t),(0,Eu.UR)({version:"embed-legacy_2022-03-25_1648228408046_c8b6c01"}),(0,Eu.Mb)(),(0,Eu.sr)(M("config",{}).correlationId)]})}(e,ja("clientId"));!function(e){yu=e}(t)}(qd);var Wd=document.getElementById("resource"),zd=Wd&&Wd.innerText;if(!zd)throw new Error("Element #resource was not found or has invalid content.");var Qd,$d=JSON.parse(decodeURIComponent(zd)),Xd=i()({},$d.uri,$d),Zd=(Qd={entities:Xd,resource:$d.uri},W(Qd).reduce((function(e,t){return H(H({},e),{},i()({},t.uri,t))}),{})),Jd=JSON.parse((null===(jd=document.getElementById("translations"))||void 0===jd?void 0:jd.innerHTML)||"{}"),ep=null===(Bd=document.getElementById("translations"))||void 0===Bd?void 0:Bd.getAttribute("data-locale");To.setDictionary(Jd),To.setLocale(ep||"en");var tp=function(e){var t=(0,Kl.MT)((0,Kl.UY)({entities:ql,playback:$l,progress:Xl,resource:Zl,session:eu,viewport:ou,platform:pu,share:_c,modal:Za,features:function(){return ja("features")}}),e,(0,Kl.qC)((0,Kl.md)(Hl.Z,ku),(function(e){return e})));return pd(t),t}({entities:Gd(Gd({},Xd),Zd),resource:$d.uri}),np=document.createElement("div");np.id="main",document.body.appendChild(np),document.body.style.margin="0",document.body.style.overflow="hidden",c().render(o().createElement(l.zt,{store:tp},o().createElement(d.zt,{value:new u.K},o().createElement(Vl,null))),np)}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=t,e=[],r.O=(t,n,i,a)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,i,a]=e[u],s=!0,c=0;c<n.length;c++)(!1&a||o>=a)&&Object.keys(r.O).every((e=>r.O[e](n[c])))?n.splice(c--,1):(s=!1,a<o&&(o=a));if(s){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,i,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={10:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[o,s,c]=n,l=0;if(o.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(c)var u=c(r)}for(t&&t(n);l<o.length;l++)a=o[l],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(u)},n=("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=r.O(void 0,[802],(()=>r(5569)));i=r.O(i)})();
//# sourceMappingURL=embed-legacy.716a8c53.js.map